!function(t,e){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};var i,n={},r=function(){return D.__string_rec(this,"")},s=s||{};function a(t,e){var i=Object.create(t);for(var n in e)i[n]=e[n];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var o=function(t){if(this.lastCanvasH=0,this.lastCanvasW=0,this.lastH=0,this.lastW=0,this.hwin=mi.global.nest(0,null),this.selectedElem=null,this.selectedFrame=0,this.gridSize=20,this.gridSnapPos=!0,this.gridSnapBounds=!1,this.filesDone=null,this.foldersOnly=!1,this.showFiles=!1,this.zoom=1,this.resizeCanvas=!1,this.dragAsset=null,this.assetNames=[""],this.dragBottom=!1,this.dragRight=!1,this.dragTop=!1,this.dragLeft=!1,this.drag=!1,this.dropPath="",this.canvas=t,t.assets.length>0){var e=t.assets;t.assets=[];for(var i=0;i<e.length;){var n=e[i];++i,this.importAsset(n.file)}}z.loadEverything(Ti(this,this.loaded))};n.Elements=o,o.__name__=!0,o.get_uiw=function(){return o.windowW*u.prefs.scaleFactor|0},o.toRelative=function(t,e){t=P.normalize(t),e=P.normalize(e);for(var i=[],n=t.split("/"),r=e.split("/"),s=0;n[s]==r[s];)++s;for(var a=0,o=r.length-s;a<o;){a++;i.push("..")}for(var l=s,h=n.length;l<h;){var u=l++;i.push(n[u])}return i.join("/")},o.toAbsolute=function(t,e){return P.normalize(e+"/"+t)},o.toDegrees=function(t){return 57.29578*t},o.toRadians=function(t){return.0174532924*t},o.prototype={ui:null,cui:null,canvas:null,toolbarw:null,get_toolbarw:function(){return 60*this.ui.SCALE|0},dropPath:null,drag:null,dragLeft:null,dragTop:null,dragRight:null,dragBottom:null,assetNames:null,dragAsset:null,resizeCanvas:null,zoom:null,showFiles:null,foldersOnly:null,filesDone:null,uimodal:null,gridSnapBounds:null,gridSnapPos:null,gridSize:null,selectedFrame:null,selectedElem:null,hwin:null,lastW:null,lastH:null,lastCanvasW:null,lastCanvasH:null,loaded:function(){var t=this,e=c.copy(yi.dark);e.FILL_WINDOW_BG=!0,this.ui=new xi({scaleFactor:u.prefs.scaleFactor,font:z.fonts.font_default,theme:e,color_wheel:z.images.color_wheel}),this.cui=new xi({scaleFactor:1,font:z.fonts.font_default,autoNotifyInput:!0,theme:yi.light}),this.uimodal=new xi({font:z.fonts.font_default,scaleFactor:u.prefs.scaleFactor}),ct.notifyOnDropFiles(function(e){t.dropPath=_.rtrim(e),t.dropPath=o.toRelative(t.dropPath,u.cwd)}),ct.notifyOnFrames(Ti(this,this.onFrames)),at.addTimeTask(Ti(this,this.update),0,.016666666666666666)},importAsset:function(t){var e=this,i=_.endsWith(t,".jpg")||_.endsWith(t,".png")||_.endsWith(t,".k")||_.endsWith(t,".hdr"),n=_.endsWith(t,".ttf"),r=o.toAbsolute(t,u.cwd);r="Windows"==ct.get_systemId()?_.replace(r,"/","\\"):r,i?z.loadImageFromPath(r,!1,function(i){var n=t.split("/"),r=n[n.length-1],s=wi.getAssetId(e.canvas),a={name:r,file:t,id:s};e.canvas.assets.push(a),wi.assetMap.h[a.id]=i,e.assetNames.push(r),e.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:123,className:"Elements",methodName:"importAsset"}):n&&z.loadFontFromPath(r,function(i){var n=t.split("/"),r=n[n.length-1],s=wi.getAssetId(e.canvas),a={name:r,file:t,id:s};e.canvas.assets.push(a),wi.assetMap.h[a.id]=i,e.assetNames.push(r),e.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:135,className:"Elements",methodName:"importAsset"})},unique:function(t){return t},makeElem:function(t){var e="",i=this.cui.t.ELEMENT_H;switch(t){case 0:e=this.unique("Text");break;case 1:e=this.unique("Image"),i=100;break;case 2:e=this.unique("Button");break;case 3:e=this.unique("Empty"),i=100;break;case 6:e=this.unique("Check");break;case 7:e=this.unique("Radio");break;case 8:e=this.unique("Combo");break;case 9:e=this.unique("Shape"),i=100;break;case 10:e=this.unique("Slider");break;case 11:e=this.unique("Input")}var n={id:wi.getElementId(this.canvas),type:t,name:e,event:"",x:0,y:0,width:150,height:i,rotation:0,text:"My "+e,asset:"",color:-1,anchor:0,parent:null,children:[],visible:!0};return this.canvas.elements.push(n),n},unparent:function(t){var e=this.elemById(t.parent);null!=e&&(t.x+=this.absx(e),t.y+=this.absy(e),t.parent=null,l.remove(e.children,t.id))},setParent:function(t,e){this.elemById(t.parent)!=e&&(this.unparent(t),null!=e&&(null==e.children&&(t.children=[]),e.children.push(t.id),t.parent=e.id,t.x-=this.absx(e),t.y-=this.absy(e)))},duplicateElem:function(t,e){if(null!=t){null==e&&(e=t.parent);var i={id:wi.getElementId(this.canvas),type:t.type,name:t.name,event:t.event,x:t.x+10,y:t.y+10,width:t.width,height:t.height,rotation:t.rotation,text:t.text,asset:t.asset,color:t.color,anchor:t.anchor,parent:e,children:[],visible:t.visible};if(this.canvas.elements.push(i),null!=e)this.elemById(e).children.push(i.id),t.parent!=e&&(i.x=t.x,i.y=t.y);for(var n=0,r=t.children;n<r.length;){var s=r[n];++n,this.duplicateElem(this.elemById(s),i.id)}return i}return null},getEnumTexts:function(){return this.assetNames.length>0?this.assetNames:[""]},getAssetIndex:function(t){for(var e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(t==this.canvas.assets[n].name)return n+1}return 0},resize:function(){null!=o.grid&&(o.grid.unload(),o.grid=null),null!=o.timeline&&(o.timeline.unload(),o.timeline=null)},drawGrid:function(){var t=2*this.gridSize,e=ct.windowWidth()+2*t,i=ct.windowHeight()+2*t;(o.grid=$.createRenderTarget(e,i)).get_g2().begin(!0,-14408668);for(var n=0,r=1+(i/t|0);n<r;){var s=n++;o.grid.get_g2().set_color(-14145496),o.grid.get_g2().drawLine(0,s*t,e,s*t),o.grid.get_g2().set_color(-13487566),o.grid.get_g2().drawLine(0,s*t+this.gridSize,e,s*t+this.gridSize)}for(var a=0,l=1+(e/t|0);a<l;){var h=a++;o.grid.get_g2().set_color(-14145496),o.grid.get_g2().drawLine(h*t,0,h*t,i),o.grid.get_g2().set_color(-13487566),o.grid.get_g2().drawLine(h*t+this.gridSize,0,h*t+this.gridSize,i)}o.grid.get_g2().end()},drawTimeline:function(){var t=this.ui.SCALE,e=(o.timeline=$.createRenderTarget(ct.windowWidth()-o.get_uiw()-this.get_toolbarw(),60*t|0)).get_g2();e.begin(!0,-14540254),e.set_font(z.fonts.font_default),e.set_fontSize(16*t|0);for(var i=o.timeline.get_width()/(11*t)|0,n=0,r=1+(i/5|0);n<r;){var s=n++;e.drawString(5*s+"",55*s*t,0)}for(var a=0,l=i;a<l;){var h=a++;e.set_color(h%5==0?-12303292:-13421773),e.fillRect(11*h*t,30*t,10*t,30*t)}e.end()},onFrames:function(t){var e=this,i=t[0];""!=this.dropPath&&(this.importAsset(this.dropPath),this.dropPath=""),null==o.grid&&this.drawGrid(),null==o.timeline&&this.drawTimeline();var n=i.get_g2();if(n.begin(),n.set_color(-1),n.drawImage(o.grid,o.coffX%40-40,o.coffY%40-40),this.canvas.x=o.coffX,this.canvas.y=o.coffY,n.drawRect(this.canvas.x,this.canvas.y,this.canvas.width*this.cui.SCALE|0,this.canvas.height*this.cui.SCALE|0,1),n.drawRect(this.canvas.x+(this.canvas.width*this.cui.SCALE|0)-3,this.canvas.y+(this.canvas.height*this.cui.SCALE|0)-3,6,6,1),wi.screenW=this.canvas.width,wi.screenH=this.canvas.height,wi.draw(this.cui,this.canvas,n),null!=this.selectedElem){n.set_color(-1);var r=this.absx(this.selectedElem)*this.cui.SCALE|0,s=this.absy(this.selectedElem)*this.cui.SCALE|0,a=this.selectedElem.width*this.cui.SCALE|0,h=this.selectedElem.height*this.cui.SCALE|0;n.drawRect(this.canvas.x+r,this.canvas.y+s,a,h),n.drawRect(this.canvas.x+r-3,this.canvas.y+s-3,6,6),n.drawRect(this.canvas.x+r-3+a/2,this.canvas.y+s-3,6,6),n.drawRect(this.canvas.x+r-3+a,this.canvas.y+s-3,6,6),n.drawRect(this.canvas.x+r-3,this.canvas.y+s-3+h/2,6,6),n.drawRect(this.canvas.x+r-3+a,this.canvas.y+s-3+h/2,6,6),n.drawRect(this.canvas.x+r-3,this.canvas.y+s-3+h,6,6),n.drawRect(this.canvas.x+r-3+a/2,this.canvas.y+s-3+h,6,6),n.drawRect(this.canvas.x+r-3+a,this.canvas.y+s-3+h,6,6)}n.set_color(-1);var c=ct.windowHeight()-o.timeline.get_height();n.drawImage(o.timeline,this.get_toolbarw(),c),n.set_color(-14656100);var f=this.ui.SCALE;if(n.fillRect(this.get_toolbarw()+11*this.selectedFrame*f,c+30*f,10*f,30*f),n.end(),this.ui.begin(n),this.ui.window(mi.global.nest(1,null),0,0,this.get_toolbarw(),ct.windowHeight())&&(this.ui._y=50,this.ui.button("Empty")&&(this.selectedElem=this.makeElem(3)),this.ui.button("Text")&&(this.selectedElem=this.makeElem(0)),this.ui.button("Shape")&&(this.selectedElem=this.makeElem(9)),this.ui.button("Image")&&(this.selectedElem=this.makeElem(1)),this.ui.button("Button")&&(this.selectedElem=this.makeElem(2)),this.ui.button("Check")&&(this.selectedElem=this.makeElem(6)),this.ui.button("Radio")&&(this.selectedElem=this.makeElem(7)),this.ui.button("Combo")&&(this.selectedElem=this.makeElem(8)),this.ui.button("Slider")&&(this.selectedElem=this.makeElem(10)),this.ui.button("Input")&&(this.selectedElem=this.makeElem(11))),this.ui.window(mi.global.nest(2,null),this.get_toolbarw(),0,ct.windowWidth()-o.get_uiw()-this.get_toolbarw(),(this.ui.t.ELEMENT_H+2)*this.ui.SCALE|0)&&this.ui.tab(mi.global.nest(3,null),this.canvas.name),this.ui.window(this.hwin,ct.windowWidth()-o.get_uiw(),0,o.get_uiw(),ct.windowHeight())){var p=mi.global.nest(4,null);if(this.ui.tab(p,"Project")){if(this.ui.button("Save")){this.canvas.x=0,this.canvas.y=0,Krom.fileSaveBytes(u.prefs.path,E.ofString(JSON.stringify(this.canvas)).b.bufferValue);var g=l.substr(u.prefs.path,0,u.prefs.path.length-5);g+=".files";for(var v="",m=0,w=this.canvas.assets;m<w.length;){var b=w[m];++m,v+=b.file+"\n"}Krom.fileSaveBytes(g,E.ofString(v).b.bufferValue),this.canvas.x=o.coffX,this.canvas.y=o.coffY}if(this.ui.panel(mi.global.nest(5,{selected:!1}),"Canvas")){this.ui.button("New")&&(this.canvas.elements=[],this.selectedElem=null);var S=this.ui,y=mi.global.nest(6,{text:this.canvas.name});this.canvas.name=S.textInput(y,"Name",2),this.ui.row([.5,.5]);var x=mi.global.nest(7,{text:this.canvas.width+""}),T=mi.global.nest(8,{text:this.canvas.height+""});x.text=this.canvas.width+"",T.text=this.canvas.height+"";var k=this.ui.textInput(x,"Width",2),C=this.ui.textInput(T,"Height",2);this.canvas.width=d.parseInt(k),this.canvas.height=d.parseInt(C)}if(this.ui.panel(mi.global.nest(9,{selected:!0}),"Outliner")){var I=null;I=function(t,i){var n=!1;e.selectedElem==i&&(e.ui.g.set_color(-14656100),e.ui.g.fillRect(0,e.ui._y,e.ui._windowW,e.ui.t.ELEMENT_H*e.ui.SCALE),e.ui.g.set_color(-1));var r=e.ui.getStarted();if(r&&!e.ui.inputDownR&&(e.selectedElem=i),r&&e.ui.inputDownR&&(i==e.selectedElem?e.unparent(i):e.setParent(e.selectedElem,i)),null!=i.children&&i.children.length>0?(e.ui.row([.07692307692307693,.9230769230769231]),n=e.ui.panel(t.nest(i.id,{selected:!0}),"",0,!0),e.ui.text(i.name)):(e.ui._x+=18,e.ui.text(i.name),e.ui._x-=18),n)for(var s=i.children.length;s>0;){--s;var a=i.children[i.children.length-1-s];e.ui.indent();var o=e.elemById(a);I(t,o),e.ui.unindent()}};for(var B=0,L=this.canvas.elements.length;B<L;){var A=B++,N=this.canvas.elements[this.canvas.elements.length-1-A];if(null==N.parent){var V=mi.global.nest(10,null);I(V,N)}}this.ui.row([.25,.25,.25,.25]);this.canvas.elements;this.ui.button("Up")&&null!=this.selectedElem&&this.moveElem(1),this.ui.button("Down")&&null!=this.selectedElem&&this.moveElem(-1),this.ui.button("Remove")&&null!=this.selectedElem&&this.removeSelectedElem(),this.ui.button("Duplicate")&&null!=this.selectedElem&&(this.selectedElem=this.duplicateElem(this.selectedElem))}if(null!=this.selectedElem){var R=this.selectedElem,P=R.id;if(this.ui.panel(mi.global.nest(11,{selected:!0}),"Properties")){var M=null==R.visible||R.visible;R.visible=this.ui.check(mi.global.nest(12,null).nest(P,{selected:M}),"Visible"),R.name=this.ui.textInput(mi.global.nest(13,null).nest(P,{text:R.name}),"Name",2),R.text=this.ui.textInput(mi.global.nest(14,null).nest(P,{text:R.text}),"Text",2),this.ui.row([.25,.25,.25,.25]);var D=R.x+"",F=mi.global.nest(15,null).nest(P,{text:D}),O=R.y+"",W=mi.global.nest(16,null).nest(P,{text:O});F.text=R.x+"",W.text=R.y+"";var U=this.ui.textInput(F,"X",2),H=this.ui.textInput(W,"Y",2);R.x=parseFloat(U),R.y=parseFloat(H);var G=R.width+"",z=mi.global.nest(17,null).nest(P,{text:G}),Y=R.height+"",X=mi.global.nest(18,null).nest(P,{text:Y});z.text=R.width+"",X.text=R.height+"";var K=this.ui.textInput(z,"W",2),Z=this.ui.textInput(X,"H",2);R.width=0|parseFloat(K),R.height=0|parseFloat(Z);var j=null==R.rotation?0:R.rotation,Q=mi.global.nest(19,null).nest(P,{value:57.29578*j});R.rotation=.0174532924*this.ui.slider(Q,"Rotation",0,360,!0);var J=this.ui.combo(mi.global.nest(20,null).nest(P,{position:this.getAssetIndex(R.asset)}),this.getEnumTexts(),"Asset",!0,2);R.asset=this.getEnumTexts()[J],R.color=bi.colorWheel(this.ui,mi.global.nest(21,null).nest(P,{color:R.color}),!0,null,!0)}this.ui.panel(mi.global.nest(22,{selected:!1}),"Align");if(this.ui.panel(mi.global.nest(23,{selected:!1}),"Anchor")){var q=mi.global.nest(24,null).nest(P,{position:R.anchor});this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(q,0,"Top-Left"),this.ui.radio(q,1,"Top"),this.ui.radio(q,2,"Top-Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(q,3,"Left"),this.ui.radio(q,4,"Center"),this.ui.radio(q,5,"Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(q,6,"Bot-Left"),this.ui.radio(q,7,"Bottom"),this.ui.radio(q,8,"Bot-Right"),R.anchor=q.position}this.ui.panel(mi.global.nest(25,{selected:!1}),"Script")&&(R.event=this.ui.textInput(mi.global.nest(26,null).nest(P,{text:R.event}),"Event",2));this.ui.panel(mi.global.nest(27,{selected:!1}),"Timeline")}}if(this.ui.tab(p,"Assets"))if(this.ui.button("Import Asset")&&(this.showFiles=!0,this.foldersOnly=!1,this.filesDone=function(t){t=_.rtrim(t),t=o.toRelative(t,u.cwd),e.importAsset(t)}),this.canvas.assets.length>0){this.ui.text("(Drag and drop assets to canvas)",1);for(var $=this.canvas.assets.length-1;$>=0;){var tt=this.canvas.assets[$];_.endsWith(tt.name,".ttf")||1!=this.ui.image(this.getImage(tt))||(this.dragAsset=tt),this.ui.row([.875,.125]),tt.name=this.ui.textInput(mi.global.nest(28,null).nest(tt.id,{text:tt.name}),"",2),this.assetNames[$+1]=tt.name,this.ui.button("X")&&(this.getImage(tt).unload(),this.canvas.assets.splice($,1),this.assetNames.splice($+1,1)),--$}}else this.ui.text("(Drag and drop images and fonts here)",1);if(this.ui.tab(p,"Preferences")){var et=mi.global.nest(29,{value:1});this.ui.slider(et,"UI Scale",.5,4,!0);var it=mi.global.nest(30,{value:20});this.ui.slider(it,"Grid Size",1,128,!0,1),this.gridSnapPos=this.ui.check(mi.global.nest(31,{selected:!0}),"Grid Snap Position"),this.gridSnapBounds=this.ui.check(mi.global.nest(32,{selected:!1}),"Grid Snap Bounds"),this.ui.changed&&!this.ui.inputDown&&(this.gridSize=0|it.value,this.ui.setScale(et.value),o.windowW=o.defaultWindowW*et.value|0);var nt=this.ui,rt=mi.global.nest(33,{selected:!0});u.prefs.window_vsync=nt.check(rt,"VSync");this.ui.panel(mi.global.nest(34,{selected:!0}),"Console")}}if(this.ui.end(),this.ui.changed&&!this.ui.inputDown&&this.drawGrid(),n.begin(!1),null!=this.dragAsset){var st=Math.min(128,this.getImage(this.dragAsset).get_width()),at=st/this.getImage(this.dragAsset).get_width(),ot=this.getImage(this.dragAsset).get_height()*at;n.drawScaledImage(this.getImage(this.dragAsset),this.ui.inputX,this.ui.inputY,st,ot)}n.end(),this.lastW>0&&(this.lastW!=ct.windowWidth()||this.lastH!=ct.windowHeight())?this.resize():this.lastCanvasW>0&&(this.lastCanvasW!=this.canvas.width||this.lastCanvasH!=this.canvas.height)&&this.resize(),this.lastW=ct.windowWidth(),this.lastH=ct.windowHeight(),this.lastCanvasW=this.canvas.width,this.lastCanvasH=this.canvas.height,this.showFiles&&this.renderFiles(n)},elemById:function(t){for(var e=0,i=this.canvas.elements;e<i.length;){var n=i[e];if(++e,n.id==t)return n}return null},moveElem:function(t){for(var e=this.canvas.elements,i=e.indexOf(this.selectedElem),n=this.selectedElem.parent;!((i+=t)<0||i>=e.length);)if(e[i].parent==n){l.remove(e,this.selectedElem),e.splice(i,0,this.selectedElem);break}},getImage:function(t){return wi.assetMap.h[t.id]},removeElem:function(t){if(null!=t.children)for(var e=0,i=t.children;e<i.length;){var n=i[e];++e,this.removeElem(this.elemById(n))}l.remove(this.canvas.elements,t),null!=t.parent&&(l.remove(this.elemById(t.parent).children,t.id),t.parent=null)},removeSelectedElem:function(){this.removeElem(this.selectedElem),this.selectedElem=null},acceptDrag:function(t){var e=this.makeElem(1);e.asset=this.assetNames[t+1],e.x=this.ui.inputX-this.canvas.x,e.y=this.ui.inputY-this.canvas.y,e.width=this.getImage(this.canvas.assets[t]).get_width(),e.height=this.getImage(this.canvas.assets[t]).get_height(),this.selectedElem=e},hitbox:function(t,e,i,n){return this.ui.inputX>t&&this.ui.inputX<t+i&&this.ui.inputY>e&&this.ui.inputY<e+n},update:function(){if(this.ui.inputReleased&&null!=this.dragAsset){if(this.ui.inputX<ct.windowWidth()-o.get_uiw()){for(var t=0,e=0,i=this.canvas.assets.length;e<i;){var n=e++;if(this.canvas.assets[n]==this.dragAsset){t=n;break}}this.acceptDrag(t)}this.dragAsset=null}if(null==this.dragAsset){if(this.updateCanvas(),null!=o.timeline){var r=ct.windowHeight()-o.timeline.get_height();this.ui.inputDown&&this.ui.inputY>r&&this.ui.inputX<ct.windowWidth()-o.get_uiw()&&this.ui.inputX>this.get_toolbarw()&&(this.selectedFrame=(this.ui.inputX-this.get_toolbarw())/11/this.ui.SCALE|0)}if(null!=this.selectedElem){var s=this.selectedElem,a=this.absx(s)*this.cui.SCALE|0,l=this.absy(s)*this.cui.SCALE|0,h=s.width*this.cui.SCALE|0,u=s.height*this.cui.SCALE|0;this.ui.inputStarted&&this.ui.inputDown&&this.hitbox(this.canvas.x+a-4,this.canvas.y+l-4,h+4,u+4)&&(this.drag=!0,this.dragLeft=this.dragRight=this.dragTop=this.dragBottom=!1,this.ui.inputX>this.canvas.x+a+h-4?this.dragRight=!0:this.ui.inputX<this.canvas.x+a+4&&(this.dragLeft=!0),this.ui.inputY>this.canvas.y+l+u-4?this.dragBottom=!0:this.ui.inputY<this.canvas.y+l+4&&(this.dragTop=!0)),this.ui.inputReleased&&this.drag&&(this.drag=!1,this.gridSnapBounds&&(s.width=Math.round(s.width/this.gridSize)*this.gridSize,s.height=Math.round(s.height/this.gridSize)*this.gridSize),this.gridSnapPos&&(s.x=Math.round(s.x/this.gridSize)*this.gridSize,s.y=Math.round(s.y/this.gridSize)*this.gridSize)),this.drag&&(this.hwin.redraws=2,this.dragRight?s.width+=0|this.ui.inputDX:this.dragLeft&&(s.x+=0|this.ui.inputDX,s.width-=0|this.ui.inputDX),this.dragBottom?s.height+=0|this.ui.inputDY:this.dragTop&&(s.y+=0|this.ui.inputDY,s.height-=0|this.ui.inputDY),1!=s.type&&(s.width<1&&(s.width=1),s.height<1&&(s.height=1)),this.dragLeft||this.dragRight||this.dragBottom||this.dragTop||(s.x+=this.ui.inputDX,s.y+=this.ui.inputDY)),this.ui.isKeyDown&&!this.ui.isTyping&&(37==this.ui.key&&(this.gridSnapPos?s.x-=this.gridSize:s.x--),39==this.ui.key&&(this.gridSnapPos?s.x+=this.gridSize:s.x++),38==this.ui.key&&(this.gridSnapPos?s.y-=this.gridSize:s.y--),40==this.ui.key&&(this.gridSnapPos?s.y+=this.gridSize:s.y++),8!=this.ui.key&&"x"!=this.ui.char&&46!=this.ui.key||this.removeSelectedElem(),68==this.ui.key&&(this.selectedElem=this.duplicateElem(s)),this.hwin.redraws=2)}this.updateFiles()}},updateCanvas:function(){if(!(this.showFiles||this.ui.inputX>ct.windowWidth()-o.get_uiw())){if(this.ui.inputStarted&&this.ui.inputDownR){this.canvas.elements.length;for(var t=0,e=this.canvas.elements;t<e.length;){var i=e[t];++t;var n=this.absx(i)*this.cui.SCALE|0,r=this.absy(i)*this.cui.SCALE|0,s=i.width*this.cui.SCALE|0,a=i.height*this.cui.SCALE|0;if(this.hitbox(this.canvas.x+n,this.canvas.y+r,s,a)&&this.selectedElem!=i){this.selectedElem=i;break}}}this.ui.inputDownR&&(o.coffX+=0|this.ui.inputDX,o.coffY+=0|this.ui.inputDY),0!=this.ui.inputWheelDelta&&(this.zoom+=-this.ui.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:this.zoom>1&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.cui.SCALE=this.cui.ops.scaleFactor*this.zoom),this.ui.inputStarted&&this.hitbox(this.canvas.x+(this.canvas.width*this.cui.SCALE|0)-3,this.canvas.y+(this.canvas.height*this.cui.SCALE|0)-3,6,6)&&(this.resizeCanvas=!0),this.ui.inputReleased&&this.resizeCanvas&&(this.resizeCanvas=!1),this.resizeCanvas&&(this.canvas.width+=0|this.ui.inputDX,this.canvas.height+=0|this.ui.inputDY,this.canvas.width<1&&(this.canvas.width=1),this.canvas.height<1&&(this.canvas.height=1))}},updateFiles:function(){if(this.showFiles&&this.ui.inputReleased){var t=ct.windowWidth(),e=ct.windowHeight(),i=t/2-o.modalRectW/2,n=t/2+o.modalRectW/2,r=e/2-o.modalRectH/2,s=e/2+o.modalRectH/2;(this.ui.inputX<i||this.ui.inputX>n||this.ui.inputY<r+o.modalHeaderH||this.ui.inputY>s)&&(this.showFiles=!1)}},renderFiles:function(t){var e=ct.windowWidth(),i=ct.windowHeight(),n=e/2-o.modalW/2,r=i/2-o.modalH/2;t.begin(!1),t.set_color(-14671840),t.fillRect(n,r,o.modalW,o.modalH),t.end();var s=e/2-o.modalRectW/2|0,a=e/2+o.modalRectW/2|0,l=i/2-o.modalRectH/2|0,h=i/2+o.modalRectH/2|0;if(l+=o.modalHeaderH,this.uimodal.begin(t),this.uimodal.window(mi.global.nest(35,null),s,l,o.modalRectW,o.modalRectH-100)){var u=mi.global.nest(36,null);u.text=this.uimodal.textInput(u),o.path=bi.fileBrowser(this.uimodal,u,this.foldersOnly)}this.uimodal.end(!1),t.begin(!1),this.uimodal.beginLayout(t,a-100,h-30,100),this.uimodal.button("OK")&&(this.showFiles=!1,this.filesDone(o.path)),this.uimodal.endLayout(!1),this.uimodal.beginLayout(t,a-200,h-30,100),this.uimodal.button("Cancel")&&(this.showFiles=!1),this.uimodal.endLayout(),t.end()},absx:function(t){return null==t?0:t.x+this.absx(this.elemById(t.parent))},absy:function(t){return null==t?0:t.y+this.absy(this.elemById(t.parent))},scaled:function(t){return t*this.cui.SCALE|0},__class__:o};var l=function(){};n.HxOverrides=l,l.__name__=!0,l.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var r=t.split(" "),s=r[0].split("-"),a=r[1].split(":");return new Date(s[0],s[1]-1,s[2],a[0],a[1],a[2]);default:throw new M("Invalid date format : "+t)}},l.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},l.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},l.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},l.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var h=function(){};n.Lambda=h,h.__name__=!0,h.array=function(t){for(var e,i=[],n=(e=t)instanceof Array?l.iter(e):e.iterator();n.hasNext();){var r=n.next();i.push(r)}return i};var u=function(){};n.Main=u,u.__name__=!0,u.main=function(){ct.start(new ut("Armory2D",1280,680,null,null),u.initialized)},u.initialized=function(t){u.prefs={path:"",scaleFactor:1};var e=Krom.getArgCount();if(e>4&&(u.prefs.path=Krom.getArg(3)),e>5){var i=parseFloat(Krom.getArg(4));u.prefs.scaleFactor=i}var n=u.prefs.path.split("/");n.pop(),u.cwd=n.join("/");var r="Windows"==ct.get_systemId()?_.replace(u.prefs.path,"/","\\"):u.prefs.path;z.loadBlobFromPath(r,function(t){var e=JSON.parse(t.toString());u.inst=new o(e)},null,{fileName:"Main.hx",lineNumber:37,className:"Main",methodName:"initialized"})},Math.__name__=!0;var c=function(){};n.Reflect=c,c.__name__=!0,c.field=function(t,e){try{return t[e]}catch(t){t instanceof M&&t.val;return null}},c.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var n in t)"__id__"!=n&&"hx__closures__"!=n&&i.call(t,n)&&e.push(n)}return e},c.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},c.copy=function(t){for(var e={},i=0,n=c.fields(t);i<n.length;){var r=n[i];++i,e[r]=c.field(t,r)}return e};var d=function(){};n.Std=d,d.__name__=!0,d.string=function(t){return D.__string_rec(t,"")},d.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e};var _=function(){};n.StringTools=_,_.__name__=!0,_.endsWith=function(t,e){var i=e.length,n=t.length;return n>=i&&t.indexOf(e,n-i)==n-i},_.isSpace=function(t,e){var i=l.cca(t,e);return i>8&&i<14||32==i},_.rtrim=function(t){for(var e=t.length,i=0;i<e&&_.isSpace(t,e-i-1);)++i;return i>0?l.substr(t,0,e-i):t},_.replace=function(t,e,i){return t.split(e).join(i)};var f=function(){};n.Type=f,f.__name__=!0,f.createEnum=function(t,e,i){var n=c.field(t,e);if(null==n)throw new M("No such constructor "+e);if(c.isFunction(n)){if(null==i)throw new M("Constructor "+e+" need parameters");return n.apply(t,i)}if(null!=i&&0!=i.length)throw new M("Constructor "+e+" does not need parameters");return n},f.getInstanceFields=function(t){var e=[];for(var i in t.prototype)e.push(i);return l.remove(e,"__class__"),l.remove(e,"__properties__"),e};var p={};n["_UInt.UInt_Impl_"]=p,p.__name__=!0,p.gt=function(t,e){var i=t<0;return i!=e<0?i:t>e},p.gte=function(t,e){var i=t<0;return i!=e<0?i:t>=e},p.toFloat=function(t){return t<0?4294967296+t:t+0};var g=function(){};n["haxe.IMap"]=g,g.__name__=!0;var v=function(){};n["haxe.Log"]=v,v.__name__=!0,v.formatOutput=function(t,e){var i=d.string(t);if(null==e)return i;var n=e.fileName+":"+e.lineNumber;if(null!=e.customParams)for(var r=0,s=e.customParams;r<s.length;){var a=s[r];++r,i+=", "+d.string(a)}return n+": "+i},v.trace=function(t,e){var i=v.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};var m=function(){};n["haxe._Unserializer.DefaultResolver"]=m,m.__name__=!0,m.prototype={resolveClass:function(t){return n[t]},resolveEnum:function(t){return s[t]},__class__:m};var w=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=w.DEFAULT_RESOLVER;null==e&&(e=new m,w.DEFAULT_RESOLVER=e),this.resolver=e};n["haxe.Unserializer"]=w,w.__name__=!0,w.initCodes=function(){for(var t=[],e=0,i=w.BASE64.length;e<i;){var n=e++;t[w.BASE64.charCodeAt(n)]=n}return t},w.run=function(t){return new w(t).unserialize()},w.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var n=this.buf.charCodeAt(this.pos);if(n!=n)break;if(45!=n){if(n<48||n>57)break;t=10*t+(n-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(e>=43&&e<58||101==e||69==e))break;this.pos++}return parseFloat(l.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new M("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new M("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new M("Invalid enum format");var i=this.readDigits();if(0==i)return f.createEnum(t,e);for(var n=[];i-- >0;)n.push(this.unserialize());return f.createEnum(t,e,n)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new M("Class not found "+t);return e;case 66:var i=this.unserialize(),n=this.resolver.resolveEnum(i);if(null==n)throw new M("Enum not found "+i);return n;case 67:var r=this.unserialize(),s=this.resolver.resolveClass(r);if(null==s)throw new M("Class not found "+r);var a=Object.create(s.prototype);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new M("Invalid custom data");return a;case 77:var o=new x;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var h=this.unserialize();o.set(h,this.unserialize())}return this.pos++,o;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new M("Invalid string reference");return this.scache[u];case 97:this.buf;var c=[];for(this.cache.push(c);;){var d=this.buf.charCodeAt(this.pos);if(104==d){this.pos++;break}if(117==d){this.pos++;var _=this.readDigits();c[c.length+_-1]=null}else c.push(this.unserialize())}return c;case 98:var f=new T;this.cache.push(f);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var p=this.unserialize(),g=this.unserialize();null!=Ai[p]?f.setReserved(p,g):f.h[p]=g}return this.pos++,f;case 99:var v=this.unserialize(),m=this.resolver.resolveClass(v);if(null==m)throw new M("Class not found "+v);var y=Object.create(m.prototype);return this.cache.push(y),this.unserializeObject(y),y;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var k=this.unserialize(),C=this.resolver.resolveEnum(k);if(null==C)throw new M("Enum not found "+k);this.pos++;var I=this.readDigits(),B=C.__constructs__.slice()[I];if(null==B)throw new M("Unknown enum index "+k+"@"+I);var L=this.unserializeEnum(C,B);return this.cache.push(L),L;case 107:return NaN;case 108:var A=new S;this.cache.push(A);for(this.buf;104!=this.buf.charCodeAt(this.pos);)A.add(this.unserialize());return this.pos++,A;case 109:return-1/0;case 110:return null;case 111:var N={};return this.cache.push(N),this.unserializeObject(N),N;case 112:return 1/0;case 113:var V=new b;this.cache.push(V);this.buf;for(var R=this.buf.charCodeAt(this.pos++);58==R;){var P=this.readDigits(),D=this.unserialize();V.h[P]=D,R=this.buf.charCodeAt(this.pos++)}if(104!=R)throw new M("Invalid IntMap format");return V;case 114:var F=this.readDigits();if(F<0||F>=this.cache.length)throw new M("Invalid reference");return this.cache[F];case 115:var O=this.readDigits(),W=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<O)throw new M("Invalid bytes length");var U=w.CODES;null==U&&(U=w.initCodes(),w.CODES=U);for(var H=this.pos,G=3&O,z=H+(O-G),Y=new E(new ArrayBuffer(3*(O>>2)+(G>=2?G-1:0))),X=0;H<z;){var K=U[W.charCodeAt(H++)],Z=U[W.charCodeAt(H++)];Y.b[X++]=K<<2|Z>>4;var j=U[W.charCodeAt(H++)];Y.b[X++]=Z<<4|j>>2;var Q=U[W.charCodeAt(H++)];Y.b[X++]=j<<6|Q}if(G>=2){var J=U[W.charCodeAt(H++)],q=U[W.charCodeAt(H++)];if(Y.b[X++]=J<<2|q>>4,3==G){var $=U[W.charCodeAt(H++)];Y.b[X++]=q<<4|$>>2}}return this.pos+=O,this.cache.push(Y),Y;case 116:return!0;case 118:var tt;return this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(tt=l.strDate(l.substr(this.buf,this.pos,19)),this.pos+=19):tt=new Date(this.readFloat()),this.cache.push(tt),tt;case 119:var et=this.unserialize(),it=this.resolver.resolveEnum(et);if(null==it)throw new M("Enum not found "+et);var nt=this.unserializeEnum(it,this.unserialize());return this.cache.push(nt),nt;case 120:throw M.wrap(this.unserialize());case 121:var rt=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<rt)throw new M("Invalid string length");var st=l.substr(this.buf,this.pos,rt);return this.pos+=rt,st=decodeURIComponent(st.split("+").join(" ")),this.scache.push(st),st;case 122:return 0}throw this.pos--,new M("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:w};var b=function(){this.h={}};n["haxe.ds.IntMap"]=b,b.__name__=!0,b.__interfaces__=[g],b.prototype={h:null,keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return l.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:b};var S=function(){this.length=0};n["haxe.ds.List"]=S,S.__name__=!0,S.prototype={h:null,q:null,length:null,add:function(t){var e=new y(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:S};var y=function(t,e){this.item=t,this.next=e};n["haxe.ds._List.ListNode"]=y,y.__name__=!0,y.prototype={item:null,next:null,__class__:y};var x=function(){this.h={__keys__:{}}};n["haxe.ds.ObjectMap"]=x,x.__name__=!0,x.__interfaces__=[g],x.prototype={h:null,set:function(t,i){var n=t.__id__||(t.__id__=e.$haxeUID++);this.h[n]=i,this.h.__keys__[n]=t},__class__:x};var T=function(){this.h={}};n["haxe.ds.StringMap"]=T,T.__name__=!0,T.__interfaces__=[g],T.prototype={h:null,rh:null,setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},__class__:T};var E=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};n["haxe.io.Bytes"]=E,E.__name__=!0,E.ofString=function(t,e){if(e==A.RawNative){for(var i=new Uint8Array(t.length<<1),n=0,r=t.length;n<r;){var s=n++,a=t.charCodeAt(s);i[s<<1]=255&a,i[s<<1|1]=a>>8}return new E(i.buffer)}for(var o=[],l=0;l<t.length;){var h=t.charCodeAt(l++);55296<=h&&h<=56319&&(h=h-55232<<10|1023&t.charCodeAt(l++)),h<=127?o.push(h):h<=2047?(o.push(192|h>>6),o.push(128|63&h)):h<=65535?(o.push(224|h>>12),o.push(128|h>>6&63),o.push(128|63&h)):(o.push(240|h>>18),o.push(128|h>>12&63),o.push(128|h>>6&63),o.push(128|63&h))}return new E(new Uint8Array(o).buffer)},E.ofData=function(t){var e=t.hxBytes;return null!=e?e:new E(t)},E.prototype={length:null,b:null,data:null,blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new M(V.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new M(V.OutsideBounds);return new E(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},getDouble:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat64(t,!0)},getFloat:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},setDouble:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat64(t,e,!0)},setFloat:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setFloat32(t,e,!0)},getUInt16:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getUint16(t,!0)},getInt32:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getInt32(t,!0)},setInt32:function(t,e){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.setInt32(t,e,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw new M(V.OutsideBounds);null==i&&(i=A.UTF8);var n="",r=this.b,s=t,a=t+e;switch(i._hx_index){case 0:for(;s<a;){var o=r[s++];if(o<128){if(0==o)break;n+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&r[s++];n+=String.fromCodePoint(l)}else if(o<240){var h=(31&o)<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(h)}else{var u=(15&o)<<18|(127&r[s++])<<12|(127&r[s++])<<6|127&r[s++];n+=String.fromCodePoint(u)}}break;case 1:for(;s<a;){var c=r[s++]|r[s++]<<8;n+=String.fromCodePoint(c)}}return n},toString:function(){return this.getString(0,this.length)},__class__:E};var k=function(){this.pos=0,this.size=0};n["haxe.io.BytesBuffer"]=k,k.__name__=!0,k.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},addBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new M(V.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var n=new Uint8Array(t.b.buffer,t.b.byteOffset+e,i);this.u8.set(n,this.pos),this.pos+=i}},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var n=new ArrayBuffer(i),r=new Uint8Array(n);this.size>0&&r.set(this.u8),this.size=i,this.buffer=n,this.u8=r,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new E(new ArrayBuffer(0));var t=new E(this.buffer);return t.length=this.pos,t},__class__:k};var C=function(){};n["haxe.io.Input"]=C,C.__name__=!0,C.prototype={bigEndian:null,readByte:function(){throw new M("Not implemented")},readBytes:function(t,e,i){var n=i,r=t.b;if(e<0||i<0||e+i>t.length)throw new M(V.OutsideBounds);try{for(;n>0;)r[e]=this.readByte(),++e,--n}catch(t){var s=t instanceof M?t.val:t;if(!(s instanceof N))throw t}return i-n},readFullBytes:function(t,e,i){for(;i>0;){var n=this.readBytes(t,e,i);if(0==n)throw new M(V.Blocked);e+=n,i-=n}},read:function(t){for(var e=new E(new ArrayBuffer(t)),i=0;t>0;){var n=this.readBytes(e,i,t);if(0==n)throw new M(V.Blocked);i+=n,t-=n}return e},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),n=this.readByte();return this.bigEndian?n|i<<8|e<<16|t<<24:t|e<<8|i<<16|n<<24},readString:function(t,e){var i=new E(new ArrayBuffer(t));return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:C};var I=function(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw new M(V.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i};n["haxe.io.BytesInput"]=I,I.__name__=!0,I.__super__=C,I.prototype=a(C.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(t){return t<0?t=0:t>this.totlen&&(t=this.totlen),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new M(new N);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new M(V.OutsideBounds);if(0==this.len&&i>0)throw new M(new N);this.len<i&&(i=this.len);for(var n=this.b,r=t.b,s=0,a=i;s<a;){var o=s++;r[e+o]=n[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:I});var B=function(){};n["haxe.io.Output"]=B,B.__name__=!0,B.prototype={bigEndian:null,writeByte:function(t){throw new M("Not implemented")},writeBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new M(V.OutsideBounds);for(var n=t.b,r=i;r>0;)this.writeByte(n[e]),++e,--r;return i},write:function(t){for(var e=t.length,i=0;e>0;){var n=this.writeBytes(t,i,e);if(0==n)throw new M(V.Blocked);i+=n,e-=n}},writeFloat:function(t){this.writeInt32(R.floatToI32(t))},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},__class__:B};var L=function(){this.b=new k};n["haxe.io.BytesOutput"]=L,L.__name__=!0,L.__super__=B,L.prototype=a(B.prototype,{b:null,writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,i){return this.b.addBytes(t,e,i),i},getBytes:function(){return this.b.getBytes()},__class__:L});var A=s["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:r},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:r}},N=function(){};n["haxe.io.Eof"]=N,N.__name__=!0,N.prototype={toString:function(){return"Eof"},__class__:N};var V=s["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:r},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:r},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:r},Custom:(i=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:r}},i.__params__=["e"],i)},R=function(){};n["haxe.io.FPHelper"]=R,R.__name__=!0,R.floatToI32=function(t){return R.helper.setFloat32(0,t,!0),R.helper.getInt32(0,!0)};var P=function(){};n["haxe.io.Path"]=P,P.__name__=!0,P.normalize=function(t){if("/"==(t=t.split("\\").join("/")))return"/";for(var e=[],i=0,n=t.split("/");i<n.length;){var r=n[i];++i,".."==r&&e.length>0&&".."!=e[e.length-1]?e.pop():""==r?(e.length>0||47==l.cca(t,0))&&e.push(r):"."!=r&&e.push(r)}for(var s="",a=!1,o=!1,h=0,u=e.join("/");h<u.length;){var c=u,d=h++,_=c.charCodeAt(d);_>=55296&&_<=56319&&(_=_-55232<<10|1023&c.charCodeAt(d+1));_>=65536&&++h;var f=_;switch(f){case 47:if(a){var p=f;a=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(p)}else o=!0;break;case 58:s+=":",a=!0;break;default:var g=f;a=!1,o&&(s+="/",o=!1),s+=String.fromCodePoint(g)}}return s};var M=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,M)};n["js._Boot.HaxeError"]=M,M.__name__=!0,M.wrap=function(t){return t instanceof Error?t:new M(t)},M.__super__=Error,M.prototype=a(Error.prototype,{val:null,__class__:M});var D=function(){};n["js.Boot"]=D,D.__name__=!0,D.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=D.__nativeClassName(t);return null!=i?D.__resolveNativeClass(i):null},D.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(t.__enum__){var n=s[t.__enum__],r=n.__constructs__[t._hx_index],a=n[r];if(a.__params__){e+="\t";for(var o=r+"(",l=[],h=0,u=a.__params__;h<u.length;){var c=u[h];++h,l.push(D.__string_rec(t[c],e))}return o+l.join(",")+")"}return r}if(t instanceof Array){var d="[";e+="\t";for(var _=0,f=t.length;_<f;){var p=_++;d+=(p>0?",":"")+D.__string_rec(t[p],e)}return d+="]"}var g;try{g=t.toString}catch(t){t instanceof M&&t.val;return"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g){var v=t.toString();if("[object Object]"!=v)return v}var m="{\n";e+="\t";var w=null!=t.hasOwnProperty,b=null;for(b in t)w&&!t.hasOwnProperty(b)||"prototype"!=b&&"__class__"!=b&&"__super__"!=b&&"__interfaces__"!=b&&"__properties__"!=b&&(2!=m.length&&(m+=", \n"),m+=e+b+" : "+D.__string_rec(t[b],e));return m+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},D.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;if(Object.prototype.hasOwnProperty.call(t,"__interfaces__"))for(var i=t.__interfaces__,n=0,r=i.length;n<r;){var s=i[n++];if(s==e||D.__interfLoop(s,e))return!0}return D.__interfLoop(t.__super__,e)},D.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case Ii:return"boolean"==typeof t;case ki:return null!=t;case Ci:return"number"==typeof t;case Ei:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(D.__interfLoop(D.getClass(t),e))return!0}else if("object"==typeof e&&D.__isNativeObj(e)&&t instanceof e)return!0;return e==Bi&&null!=t.__name__||(e==Li&&null!=t.__ename__||null!=t.__enum__&&s[t.__enum__]==e)}},D.__cast=function(t,e){if(null==t||D.__instanceof(t,e))return t;throw new M("Cannot cast "+d.string(t)+" to "+d.string(e))},D.__nativeClassName=function(t){var e=D.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},D.__isNativeObj=function(t){return null!=D.__nativeClassName(t)},D.__resolveNativeClass=function(t){return e[t]};var F=function(){};n["js.lib._ArrayBuffer.ArrayBufferCompat"]=F,F.__name__=!0,F.sliceImpl=function(t,e){var i=new Uint8Array(this,t,null==e?null:e-t),n=new Uint8Array(i.byteLength);return n.set(i),n.buffer};var O=function(){this.names=["color_wheel"],this.color_wheelDescription={name:"color_wheel",original_height:270,original_width:360,files:["color_wheel.png"],type:"image"},this.color_wheelName="color_wheel",this.color_wheel=null};n["kha._Assets.ImageList"]=O,O.__name__=!0,O.prototype={get:function(t){return c.field(this,t)},color_wheel:null,color_wheelName:null,color_wheelDescription:null,color_wheelLoad:function(t,e){z.loadImage("color_wheel",function(e){t()},e,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"})},color_wheelUnload:function(){this.color_wheel.unload(),this.color_wheel=null},names:null,__class__:O};var W=function(){this.names=[]};n["kha._Assets.SoundList"]=W,W.__name__=!0,W.prototype={get:function(t){return c.field(this,t)},names:null,__class__:W};var U=function(){this.names=[]};n["kha._Assets.BlobList"]=U,U.__name__=!0,U.prototype={get:function(t){return c.field(this,t)},names:null,__class__:U};var H=function(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null};n["kha._Assets.FontList"]=H,H.__name__=!0,H.prototype={get:function(t){return c.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(t,e){z.loadFont("font_default",function(e){t()},e,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:H};var G=function(){this.names=[]};n["kha._Assets.VideoList"]=G,G.__name__=!0,G.prototype={get:function(t){return c.field(this,t)},names:null,__class__:G};var z=function(){};n["kha.Assets"]=z,z.__name__=!0,z.loadEverything=function(t,e,i,n){for(var r=0,s=0,a=f.getInstanceFields(U);s<a.length;){var o=a[s];++s,_.endsWith(o,"Load")&&(r+=1)}for(var h=0,u=f.getInstanceFields(O);h<u.length;){var d=u[h];++h,_.endsWith(d,"Load")&&(r+=1)}for(var p=0,g=f.getInstanceFields(W);p<g.length;){var v=g[p];++p,_.endsWith(v,"Load")&&(r+=1)}for(var m=0,w=f.getInstanceFields(H);m<w.length;){var b=w[m];++m,_.endsWith(b,"Load")&&(r+=1)}for(var S=0,y=f.getInstanceFields(G);S<y.length;){var x=y[S];++S,_.endsWith(x,"Load")&&(r+=1)}if(0!=r){for(var T=r,E=function(){T-=1,z.progress=1-T/r,0==T&&t()},k=0,C=f.getInstanceFields(U);k<C.length;){var I=C[k];if(++k,_.endsWith(I,"Load")){var B=l.substr(I,0,I.length-4),L=c.field(z.blobs,B+"Description");null==e||e(L)?c.field(z.blobs,I)(E,function(t){z.reporter(n,{fileName:"kha/Assets.hx",lineNumber:142,className:"kha.Assets",methodName:"loadEverything"})(t),E()}):E()}}for(var A=0,N=f.getInstanceFields(O);A<N.length;){var V=N[A];if(++A,_.endsWith(V,"Load")){var R=l.substr(V,0,V.length-4),P=c.field(z.images,R+"Description");null==e||e(P)?c.field(z.images,V)(E,function(t){z.reporter(n,{fileName:"kha/Assets.hx",lineNumber:158,className:"kha.Assets",methodName:"loadEverything"})(t),E()}):E()}}for(var M=0,D=f.getInstanceFields(W);M<D.length;){var F=[D[M]];if(++M,_.endsWith(F[0],"Load")){var Y=l.substr(F[0],0,F[0].length-4),X=[c.field(z.sounds,Y+"Description")];null==e||e(X[0])?c.field(z.sounds,F[0])(function(t,e){return function(){null==i||i(t[0])?c.field(z.sounds,e[0].substring(0,e[0].length-4)).uncompress(E):E()}}(X,F),function(t){z.reporter(n,{fileName:"kha/Assets.hx",lineNumber:181,className:"kha.Assets",methodName:"loadEverything"})(t),E()}):E()}}for(var K=0,Z=f.getInstanceFields(H);K<Z.length;){var j=Z[K];if(++K,_.endsWith(j,"Load")){var Q=l.substr(j,0,j.length-4),J=c.field(z.fonts,Q+"Description");null==e||e(J)?c.field(z.fonts,j)(E,function(t){z.reporter(n,{fileName:"kha/Assets.hx",lineNumber:196,className:"kha.Assets",methodName:"loadEverything"})(t),E()}):E()}}for(var q=0,$=f.getInstanceFields(G);q<$.length;){var tt=$[q];if(++q,_.endsWith(tt,"Load")){var et=l.substr(tt,0,tt.length-4),it=c.field(z.videos,et+"Description");null==e||e(it)?c.field(z.videos,tt)(E,function(t){z.reporter(n,{fileName:"kha/Assets.hx",lineNumber:211,className:"kha.Assets",methodName:"loadEverything"})(t),E()}):E()}}}else t()},z.loadImage=function(t,e,i,n){var r=c.field(z.images,t+"Description");nt.loadImageFromDescription(r,function(i){z.images[t]=i,e(i)},z.reporter(i,n))},z.loadImageFromPath=function(t,e,i,n,r){var s={files:[t],readable:e};nt.loadImageFromDescription(s,i,z.reporter(n,r))},z.get_imageFormats=function(){return nt.getImageFormats()},z.loadBlob=function(t,e,i,n){var r=c.field(z.blobs,t+"Description");nt.loadBlobFromDescription(r,function(i){z.blobs[t]=i,e(i)},z.reporter(i,n))},z.loadBlobFromPath=function(t,e,i,n){var r={files:[t]};nt.loadBlobFromDescription(r,e,z.reporter(i,n))},z.loadSound=function(t,e,i,n){var r=c.field(z.sounds,t+"Description");nt.loadSoundFromDescription(r,function(i){z.sounds[t]=i,e(i)},z.reporter(i,n))},z.loadSoundFromPath=function(t,e,i,n){var r={files:[t]};nt.loadSoundFromDescription(r,e,z.reporter(i,n))},z.get_soundFormats=function(){return nt.getSoundFormats()},z.loadFont=function(t,e,i,n){var r=c.field(z.fonts,t+"Description");nt.loadFontFromDescription(r,function(i){z.fonts[t]=i,e(i)},z.reporter(i,n))},z.loadFontFromPath=function(t,e,i,n){var r={files:[t]};nt.loadFontFromDescription(r,e,z.reporter(i,n))},z.get_fontFormats=function(){return["ttf"]},z.loadVideo=function(t,e,i,n){var r=c.field(z.videos,t+"Description");nt.loadVideoFromDescription(r,function(i){z.videos[t]=i,e(i)},z.reporter(i,n))},z.loadVideoFromPath=function(t,e,i,n){var r={files:[t]};nt.loadVideoFromDescription(r,e,z.reporter(i,n))},z.get_videoFormats=function(){return nt.getVideoFormats()},z.reporter=function(t,e){if(null!=t)return t;var i=v.trace,n=e;return function(t){i(t,n)}};var Y=function(){};n["kha.Canvas"]=Y,Y.__name__=!0,Y.prototype={get_g4:null,get_g2:null,get_g1:null,get_height:null,get_width:null,width:null,height:null,g1:null,g2:null,g4:null,__class__:Y};var X=t.kha._Color.Color_Impl_={};n["kha._Color.Color_Impl_"]=X,X.__name__=!0,X.fromValue=function(t){return X._new(t)},X.fromBytes=function(t,e,i,n){return null==n&&(n=255),X._new(n<<24|t<<16|e<<8|i)},X.fromFloats=function(t,e,i,n){return null==n&&(n=1),X._new((255*n|0)<<24|(255*t|0)<<16|(255*e|0)<<8|255*i|0)},X.fromString=function(t){if(7!=t.length&&9!=t.length||35!=t.charCodeAt(0))throw new M("Invalid Color string: '"+t+"'");var e=d.parseInt("0x"+l.substr(t,1,null));return 7==t.length&&(e+=-16777216),X._new(e)},X._new=function(t){return t},X.get_value=function(t){return t},X.set_value=function(t,e){return e},X.get_Rb=function(t){return(16711680&t)>>>16},X.get_Gb=function(t){return(65280&t)>>>8},X.get_Bb=function(t){return 255&t},X.get_Ab=function(t){return t>>>24},X.set_Rb=function(t,e){return t=t>>>24<<24|e<<16|(65280&t)>>>8<<8|255&t,e},X.set_Gb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|e<<8|255&t,e},X.set_Bb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|e,e},X.set_Ab=function(t,e){return t=e<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|255&t,e},X.get_R=function(t){return.00392156862745098*((16711680&t)>>>16)},X.get_G=function(t){return.00392156862745098*((65280&t)>>>8)},X.get_B=function(t){return.00392156862745098*(255&t)},X.get_A=function(t){return.00392156862745098*(t>>>24)},X.set_R=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(255*e|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e},X.set_G=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(255*e|0)<<8|.00392156862745098*(255&t)*255|0,e},X.set_B=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|255*e|0,e},X.set_A=function(t,e){return t=(255*e|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e};var K=function(t,e){this.num=t,this.isPrimary=e};n["kha.Display"]=K,K.__name__=!0,K.init=function(){for(var t=0,e=Krom.displayCount();t<e;){var i=t++;K.displays.push(new K(i,Krom.displayIsPrimary(i)))}},K.get_primary=function(){K.init();for(var t=0,e=K.displays;t<e.length;){var i=e[t];if(++t,i.isPrimary)return i}return null},K.get_all=function(){return K.init(),K.displays},K.prototype={num:null,isPrimary:null,get_available:function(){return!0},get_name:function(){return"Display"},get_x:function(){return Krom.displayX(this.num)},get_y:function(){return Krom.displayY(this.num)},get_width:function(){return Krom.displayWidth(this.num)},get_height:function(){return Krom.displayHeight(this.num)},get_frequency:function(){return 60},get_pixelsPerInch:function(){return Krom.screenDpi()},get_modes:function(){return[]},__class__:K};var Z=function(t,e,i,n){this.width=t,this.height=e,this.frequency=i,this.bitsPerPixel=n};n["kha.DisplayMode"]=Z,Z.__name__=!0,Z.prototype={width:null,height:null,frequency:null,bitsPerPixel:null,__class__:Z};var j=function(t,e,i){this.bold=t,this.italic=e,this.underlined=i};n["kha.FontStyle"]=j,j.__name__=!0,j.prototype={bold:null,italic:null,underlined:null,getBold:function(){return this.bold},getItalic:function(){return this.italic},getUnderlined:function(){return this.underlined},__class__:j};var Q=function(t,e,i,n){this.window=t,this.graphics1=e,this.graphics2=i,this.graphics4=n};n["kha.Framebuffer"]=Q,Q.__name__=!0,Q.__interfaces__=[Y],Q.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,init:function(t,e,i){this.graphics1=t,this.graphics2=e,this.graphics4=i},get_g1:function(){return this.graphics1},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},width:null,get_width:function(){return ct.windowWidth(this.window)},height:null,get_height:function(){return ct.windowHeight(this.window)},__class__:Q};var J=function(t,e,i,n,r,s){null==s&&(s=1),null==r&&(r=8),null==n&&(n=16),null==i&&(i=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=i,this.depthBufferBits=n,this.stencilBufferBits=r,this.samplesPerPixel=s};n["kha.FramebufferOptions"]=J,J.__name__=!0,J.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:J};var q=function(){};n["kha.Resource"]=q,q.__name__=!0,q.prototype={unload:null,__class__:q};var $=function(t){this.pixels=null,this.texture_=t};n["kha.Image"]=$,$.__name__=!0,$.__interfaces__=[q,Y],$.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 1:return 5;case 2:return 3;case 3:return 4;case 4:return 1;case 5:return 2;case 6:return 6;default:return 0}},$.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},$.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},$.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;case 6:return 7;default:return 1}},$._fromTexture=function(t){return new $(t)},$.fromBytes=function(t,e,i,n,r){null==n&&(n=0);var s=new $(null);return s.format=n,s.texture_=Krom.createTextureFromBytes(t.b.bufferValue,e,i,$.getTextureFormat(n),!0),s},$.fromBytes3D=function(t,e,i,n,r,s){null==r&&(r=0);var a=new $(null);return a.format=r,a.texture_=Krom.createTextureFromBytes3D(t.b.bufferValue,e,i,n,$.getTextureFormat(r),!0),a},$.fromEncodedBytes=function(t,e,i,n,r){null==r&&(r=!1);var s=new $(null);s.texture_=Krom.createTextureFromEncodedBytes(t.b.bufferValue,e,r),i(s)},$.create=function(t,e,i,n){null==i&&(i=0);var r=new $(null);return r.format=i,r.texture_=Krom.createTexture(t,e,$.getTextureFormat(i)),r},$.create3D=function(t,e,i,n,r){null==n&&(n=0);var s=new $(null);return s.format=n,s.texture_=Krom.createTexture3D(t,e,i,$.getTextureFormat(n)),s},$.createRenderTarget=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=1),null==n&&(n=0),null==i&&(i=0);var a=new $(null);return a.format=i,a.renderTarget_=Krom.createRenderTarget(t,e,$.getDepthBufferBits(n),$.getRenderTargetFormat(i),$.getStencilBufferBits(n),s),a},$.get_maxSize=function(){return 4096},$.get_nonPow2Supported=function(){return!0},$.renderTargetsInvertedY=function(){return Krom.renderTargetsInvertedY()},$.formatByteSize=function(t){switch(t){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2;default:return 4}},$.prototype={texture_:null,renderTarget_:null,format:null,readable:null,graphics1:null,graphics2:null,graphics4:null,isOpaque:function(t,e){return!1},at:function(t,e){return-16777216},unload:function(){Krom.unloadImage(this),this.texture_=null,this.renderTarget_=null},lock:function(t){return null==t&&(t=0),E.ofData(Krom.lockTexture(this.texture_,t))},unlock:function(){Krom.unlockTexture(this.texture_)},pixels:null,getPixels:function(){return null!=this.renderTarget_?(null==this.pixels&&(this.pixels=new E(new ArrayBuffer($.formatByteSize(this.format)*this.get_width()*this.get_height()))),Krom.getRenderTargetPixels(this.renderTarget_,this.pixels.b.bufferValue),this.pixels):E.ofData(Krom.getTexturePixels(this.texture_))},generateMipmaps:function(t){null==this.texture_?Krom.generateRenderTargetMipmaps(this.renderTarget_,t):Krom.generateTextureMipmaps(this.texture_,t)},setMipmaps:function(t){Krom.setMipmaps(this.texture_,t)},setDepthStencilFrom:function(t){Krom.setDepthStencilFrom(this.renderTarget_,t.renderTarget_)},clear:function(t,e,i,n,r,s,a){Krom.clearTexture(this.texture_,t,e,i,n,r,s,a)},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},depth:null,get_depth:function(){return null!=this.texture_?this.texture_.depth:1},realWidth:null,get_realWidth:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.realWidth},realHeight:null,get_realHeight:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.realHeight},g1:null,get_g1:function(){return null==this.graphics1&&(this.graphics1=new ne(this)),this.graphics1},g2:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new Ae(this)),this.graphics2},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new qe(this)),this.graphics4},__class__:$};var tt=function(){};n["kha.AlignedQuad"]=tt,tt.__name__=!0,tt.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:tt};var et=function(t,e,i,n,r,s,a,o){this.mySize=t,this.width=r,this.height=s,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var h=a[l];++l,h.yoff+=this.baseline}this.texture=$.fromBytes(o.toBytes(),r,s,1)};n["kha.KravurImage"]=et,et.__name__=!0,et.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,i,n){if(e>=this.chars.length)return null;var r=1/this.width,s=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(n+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*r,t.t0=a.y0*s,t.s1=a.x1*r,t.t1=a.y1*s,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=et.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var i=1,n=et.charBlocks.length/2|0;i<n;){var r=i++,s=et.charBlocks[2*r-1],a=et.charBlocks[2*r];t>a-1&&(e+=a-1-s)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,i=0,n=t.length;i<n;){var r=i++;e+=this.getCharWidth(l.cca(t,r))}return e},charactersWidth:function(t,e,i){for(var n=0,r=e,s=e+i;r<s;){var a=r++;n+=this.getCharWidth(t[a])}return n},getBaselinePosition:function(){return this.baseline},__class__:et};var it=function(t){this.images=new b,this.blob=t};n["kha.Kravur"]=it,it.__name__=!0,it.__interfaces__=[q],it.fromBytes=function(t){return new it(Je.fromBytes(t))},it.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=ie.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var i=(et.charBlocks=[e[0]])[0]+1,n=1,r=e.length;n<r;){var s=n++;e[s]!=i?(et.charBlocks.push(e[s-1]),et.charBlocks.push(e[s]),i=e[s]+1):++i}et.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(!this.images.h.hasOwnProperty(a)){for(var o=64,l=32,h=new Array(e.length),u=0,c=h.length;u<c;){h[u++]=new ue}for(var d=null,_=-1;_<=0;)l<o?l*=2:o*=2,d=Je.alloc(o*l),_=Se.stbtt_BakeFontBitmap(this.blob,0,t,d,o,l,e,h);var f=new pe;Se.stbtt_InitFont(f,this.blob,0);var p=Se.stbtt_GetFontVMetrics(f),g=Se.stbtt_ScaleForPixelHeight(f,t),v=Math.round(p.ascent*g),m=Math.round(p.descent*g),w=Math.round(p.lineGap*g),b=new et(0|t,v,m,w,o,l,h,d);return this.images.h[a]=b,b}return this.images.h[a]},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},widthOfCharacters:function(t,e,i,n){return this._get(t).charactersWidth(e,i,n)},baseline:function(t){return this._get(t).getBaselinePosition()},unload:function(){this.blob=null,this.images=null},__class__:it};var nt=function(){};n["kha.LoaderImpl"]=nt,nt.__name__=!0,nt.getImageFormats=function(){return["png","jpg"]},nt.loadImageFromDescription=function(t,e,i){var n=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;e($._fromTexture(Krom.loadImage(t.files[0],n)))},nt.getSoundFormats=function(){return["wav","ogg"]},nt.loadSoundFromDescription=function(t,e,i){e(new $e(E.ofData(Krom.loadSound(t.files[0]))))},nt.getVideoFormats=function(){return["webm"]},nt.loadVideoFromDescription=function(t,e,i){},nt.loadBlobFromDescription=function(t,e,i){e(new Je(E.ofData(Krom.loadBlob(t.files[0]))))},nt.loadFontFromDescription=function(t,e,i){nt.loadBlobFromDescription(t,function(t){e(new it(t))},i)};var rt=function(){};n["kha.TimeTask"]=rt,rt.__name__=!0,rt.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:rt};var st=function(t,e,i){this.task=t,this.priority=e,this.id=i,this.active=!0,this.paused=!1};n["kha.FrameTask"]=st,st.__name__=!0,st.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:st};var at=function(){};n["kha.Scheduler"]=at,at.__name__=!0,at.init=function(){at.deltas=[];for(var t=0,e=at.DIF_COUNT;t<e;){var i=t++;at.deltas[i]=0}at.stopped=!0,at.frame_tasks_sorted=!0,at.current=at.lastTime=at.realTime(),at.currentFrameTaskId=0,at.currentTimeTaskId=0,at.currentGroupId=0,at.timeTasks=[],at.pausedTimeTasks=[],at.outdatedTimeTasks=[],at.timeTasksScratchpad=[],at.frameTasks=[],at.toDeleteFrame=[]},at.start=function(t){null==t&&(t=!1),at.vsync=ft.get(0).get_vSynced();var e=K.get_primary().get_frequency();e>=57&&e<=63&&(e=60),at.onedifhz=1/e,at.stopped=!1,at.resetTime(),at.lastTime=at.realTime()-at.startTime;for(var i=0,n=at.DIF_COUNT;i<n;){var r=i++;at.deltas[r]=0}if(t){for(var s=0,a=at.timeTasks;s<a.length;){var o=a[s];++s,o.paused=!1}for(var l=0,h=at.frameTasks;l<h.length;){var u=h[l];++l,u.paused=!1}}},at.stop=function(){at.stopped=!0},at.isStopped=function(){return at.stopped},at.warpTimeTasksBack=function(t,e){for(var i=0;i<e.length;){var n=e[i];if(++i,n.start>=t)n.next=n.start;else if(n.period>0){var r=t-n.start,s=Math.ceil(r/n.period);n.next=n.start+s*n.period}}},at.warp=function(t){if(t<at.lastTime){at.current=t,at.lastTime=t,at.warpTimeTasksBack(t,at.outdatedTimeTasks),at.warpTimeTasksBack(t,at.timeTasks);for(var e=0,i=at.outdatedTimeTasks;e<i.length;){var n=i[e];++e,n.next>=t&&at.timeTasksScratchpad.push(n)}for(var r=0,s=at.timeTasksScratchpad;r<s.length;){var a=s[r];++r,l.remove(at.outdatedTimeTasks,a)}for(var o=0,h=at.timeTasksScratchpad;o<h.length;){var u=h[o];++o,at.insertSorted(at.timeTasks,u)}for(;at.timeTasksScratchpad.length>0;)l.remove(at.timeTasksScratchpad,at.timeTasksScratchpad[0])}else t>at.lastTime&&(at.startTime-=t-at.lastTime,at.current=t,at.lastTime=t,at.executeTimeTasks(t))},at.executeFrame=function(){var t=at.realTime()-at.startTime-at.lastTime,e=at.current;if(t>=0){if(null==pi.the())if(t>at.maxframetime)at.startTime+=t-at.maxframetime,e+=t=at.maxframetime;else if(at.vsync){for(var i=at.onedifhz;i<t-at.onedifhz;)i+=at.onedifhz;t=i;for(var n=0,r=at.DIF_COUNT-2;n<r;){var s=n++;t+=at.deltas[s],at.deltas[s]=at.deltas[s+1]}t+=at.deltas[at.DIF_COUNT-2],t/=at.DIF_COUNT,at.deltas[at.DIF_COUNT-2]=i,e+=t}else{for(var a=0,o=at.DIF_COUNT-1;a<o;){var h=a++;at.deltas[h]=at.deltas[h+1]}at.deltas[at.DIF_COUNT-1]=t;for(var u=0,c=0,d=at.DIF_COUNT;c<d;){var _=c++;u+=at.deltas[_]}e+=u/=at.DIF_COUNT}else e+=t;at.lastTime=e,at.stopped||(at.current=e);for(var f=0,p=at.pausedTimeTasks;f<p.length;){var g=p[f];++f,g.next+=t}if(at.stopped)for(var v=0,m=at.timeTasks;v<m.length;){var w=m[v];++v,w.next+=t}at.executeTimeTasks(e);for(var b=0,S=at.outdatedTimeTasks;b<S.length;){var y=S[b];++b,y.next<e-10&&at.timeTasksScratchpad.push(y)}for(var x=0,T=at.timeTasksScratchpad;x<T.length;){var E=T[x];++x,l.remove(at.outdatedTimeTasks,E)}for(;at.timeTasksScratchpad.length>0;)l.remove(at.timeTasksScratchpad,at.timeTasksScratchpad[0])}at.sortFrameTasks();for(var k=0,C=at.frameTasks;k<C.length;){var I=C[k];++k,at.stopped||I.paused||!I.active||I.task()||(I.active=!1)}for(var B=0,L=at.frameTasks;B<L.length;){var A=L[B];++B,A.active||at.toDeleteFrame.push(A)}for(;at.toDeleteFrame.length>0;)l.remove(at.frameTasks,at.toDeleteFrame.pop())},at.executeTimeTasks=function(t){for(;at.timeTasks.length>0&&(at.activeTimeTask=at.timeTasks[0],at.activeTimeTask.next<=t);)at.activeTimeTask.next+=at.activeTimeTask.period,l.remove(at.timeTasks,at.activeTimeTask),at.activeTimeTask.active&&at.activeTimeTask.task()?at.activeTimeTask.period>0&&(0==at.activeTimeTask.duration||at.activeTimeTask.duration>=at.activeTimeTask.start+at.activeTimeTask.next)?at.insertSorted(at.timeTasks,at.activeTimeTask):at.archiveTimeTask(at.activeTimeTask,t):(at.activeTimeTask.active=!1,at.archiveTimeTask(at.activeTimeTask,t));at.activeTimeTask=null},at.archiveTimeTask=function(t,e){},at.time=function(){return at.current},at.realTime=function(){return ct.get_time()},at.resetTime=function(){var t=ct.get_time(),e=t-at.startTime;at.startTime=t;for(var i=0,n=at.timeTasks;i<n.length;){var r=n[i];++i,r.start-=e,r.next-=e}for(var s=0,a=at.DIF_COUNT;s<a;){var o=s++;at.deltas[o]=0}at.current=0,at.lastTime=0},at.addBreakableFrameTask=function(t,e){return at.frameTasks.push(new st(t,e,++at.currentFrameTaskId)),at.frame_tasks_sorted=!1,at.currentFrameTaskId},at.addFrameTask=function(t,e){return at.addBreakableFrameTask(function(){return t(),!0},e)},at.pauseFrameTask=function(t,e){for(var i=0,n=at.frameTasks;i<n.length;){var r=n[i];if(++i,r.id==t){r.paused=e;break}}},at.removeFrameTask=function(t){for(var e=0,i=at.frameTasks;e<i.length;){var n=i[e];if(++e,n.id==t){n.active=!1;break}}},at.generateGroupId=function(){return++at.currentGroupId},at.addBreakableTimeTaskToGroup=function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=new rt;return s.active=!0,s.task=e,s.id=++at.currentTimeTaskId,s.groupId=t,s.start=at.current+i,s.period=0,0!=n&&(s.period=n),s.duration=0,0!=r&&(s.duration=s.start+r),s.next=s.start,at.insertSorted(at.timeTasks,s),s.id},at.addTimeTaskToGroup=function(t,e,i,n,r){return null==r&&(r=0),null==n&&(n=0),at.addBreakableTimeTaskToGroup(t,function(){return e(),!0},i,n,r)},at.addBreakableTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),at.addBreakableTimeTaskToGroup(0,t,e,i,n)},at.addTimeTask=function(t,e,i,n){return null==n&&(n=0),null==i&&(i=0),at.addTimeTaskToGroup(0,t,e,i,n)},at.getTimeTask=function(t){if(null!=at.activeTimeTask&&at.activeTimeTask.id==t)return at.activeTimeTask;for(var e=0,i=at.timeTasks;e<i.length;){var n=i[e];if(++e,n.id==t)return n}for(var r=0,s=at.pausedTimeTasks;r<s.length;){var a=s[r];if(++r,a.id==t)return a}return null},at.pauseTimeTask=function(t,e){var i=at.getTimeTask(t);null!=i&&at.pauseRunningTimeTask(i,e),null!=at.activeTimeTask&&at.activeTimeTask.id==t&&(at.activeTimeTask.paused=e)},at.pauseRunningTimeTask=function(t,e){t.paused=e,e?(l.remove(at.timeTasks,t),at.pausedTimeTasks.push(t)):(at.insertSorted(at.timeTasks,t),l.remove(at.pausedTimeTasks,t))},at.pauseTimeTasks=function(t,e){for(var i=0,n=at.timeTasks;i<n.length;){var r=n[i];++i,r.groupId==t&&at.pauseRunningTimeTask(r,e)}null!=at.activeTimeTask&&at.activeTimeTask.groupId==t&&(at.activeTimeTask.paused=e)},at.removeTimeTask=function(t){var e=at.getTimeTask(t);null!=e&&(e.active=!1,l.remove(at.timeTasks,e))},at.removeTimeTasks=function(t){for(var e=0,i=at.timeTasks;e<i.length;){var n=i[e];++e,n.groupId==t&&(n.active=!1,at.timeTasksScratchpad.push(n))}for(var r=0,s=at.timeTasksScratchpad;r<s.length;){var a=s[r];++r,l.remove(at.timeTasks,a)}for(;at.timeTasksScratchpad.length>0;)l.remove(at.timeTasksScratchpad,at.timeTasksScratchpad[0]);null!=at.activeTimeTask&&at.activeTimeTask.groupId==t&&(at.activeTimeTask.active=!1)},at.numTasksInSchedule=function(){return at.timeTasks.length+at.frameTasks.length},at.insertSorted=function(t,e){for(var i=0,n=t.length;i<n;){var r=i++;if(t[r].next>e.next)return void t.splice(r,0,e)}t.push(e)},at.sortFrameTasks=function(){at.frame_tasks_sorted||(at.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),at.frame_tasks_sorted=!0)};var ot=s["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:r},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:r},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:r},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:r}},lt=function(){};n["kha.Shaders"]=lt,lt.__name__=!0,lt.init=function(){var t=[],e=c.field(lt,"painter_colored_fragData0"),i=w.run(e);t.push(Je.fromBytes(i)),lt.painter_colored_frag=new Te(t,["painter-colored.frag.glsl"]);var n=[],r=c.field(lt,"painter_colored_vertData0"),s=w.run(r);n.push(Je.fromBytes(s)),lt.painter_colored_vert=new Ue(n,["painter-colored.vert.glsl"]);var a=[],o=c.field(lt,"painter_image_fragData0"),l=w.run(o);a.push(Je.fromBytes(l)),lt.painter_image_frag=new Te(a,["painter-image.frag.glsl"]);var h=[],u=c.field(lt,"painter_image_vertData0"),d=w.run(u);h.push(Je.fromBytes(d)),lt.painter_image_vert=new Ue(h,["painter-image.vert.glsl"]);var _=[],f=c.field(lt,"painter_text_fragData0"),p=w.run(f);_.push(Je.fromBytes(p)),lt.painter_text_frag=new Te(_,["painter-text.frag.glsl"]);var g=[],v=c.field(lt,"painter_text_vertData0"),m=w.run(v);g.push(Je.fromBytes(m)),lt.painter_text_vert=new Ue(g,["painter-text.vert.glsl"]);var b=[],S=c.field(lt,"painter_video_fragData0"),y=w.run(S);b.push(Je.fromBytes(y)),lt.painter_video_frag=new Te(b,["painter-video.frag.glsl"]);var x=[],T=c.field(lt,"painter_video_vertData0"),E=w.run(T);x.push(Je.fromBytes(E)),lt.painter_video_vert=new Ue(x,["painter-video.vert.glsl"])};var ht=function(){this.sampleRate=0,this.channels=0,this.length=0};n["kha.Sound"]=ht,ht.__name__=!0,ht.__interfaces__=[q],ht.prototype={compressedData:null,uncompressedData:null,length:null,channels:null,sampleRate:null,uncompress:function(t){if(null==this.uncompressedData){var e=new L,i=At.readAll(this.compressedData,e,!0),n=e.getBytes(),r=n.length/4|0;if(1==i.channel){this.length=r/yt.samplesPerSecond;var s=new Float32Array(2*r);this.uncompressedData=s;for(var a=0,o=r;a<o;){var l=a++;this.uncompressedData[2*l]=n.getFloat(4*l),this.uncompressedData[2*l+1]=n.getFloat(4*l)}}else{this.length=r/2/yt.samplesPerSecond;var h=new Float32Array(r);this.uncompressedData=h;for(var u=0,c=r;u<c;){var d=u++;this.uncompressedData[d]=n.getFloat(4*d)}}this.channels=i.channel,this.sampleRate=i.sampleRate,this.compressedData=null,t()}else t()},unload:function(){this.compressedData=null,this.uncompressedData=null},__class__:ht};var ut=function(t,e,i,n,r){null==i&&(i=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==n?new gt(null,null,null,null,null,null,null,null,null):n,e>0?(this.window.width=e,this.width=e):this.width=this.window.width,i>0?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==r?new J(null,null,null,null,null,null):r};n["kha.SystemOptions"]=ut,ut.__name__=!0,ut.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:ut};var ct=function(){};n["kha.System"]=ct,ct.__name__=!0,ct.init=function(t,e){var i=0;t.resizable&&(i|=1),t.maximizable&&(i|=4),t.minimizable&&(i|=2);var n=new ut(t.title,t.width,t.height,new gt(null,null,null,null,null,null,null,i,t.windowMode),new J(null,t.vSync,null,null,null,t.samplesPerPixel));ct.start(n,function(t){e()})},ct.start=function(t,e){ct.theTitle=t.title,dt.init(t,e)},ct.get_title=function(){return ct.theTitle},ct.notifyOnRender=function(t,e){null==e&&(e=0),ct.renderListeners.push(function(i){e<i.length&&t(i[e])})},ct.notifyOnFrames=function(t){ct.renderListeners.push(t)},ct.removeFramesListener=function(t){l.remove(ct.renderListeners,t)},ct.notifyOnApplicationState=function(t,e,i,n,r){null!=t&&ct.foregroundListeners.push(t),null!=e&&ct.resumeListeners.push(e),null!=i&&ct.pauseListeners.push(i),null!=n&&ct.backgroundListeners.push(n),null!=r&&ct.shutdownListeners.push(r)},ct.notifyOnDropFiles=function(t){ct.dropFilesListeners.push(t)},ct.removeDropListerer=function(t){l.remove(ct.dropFilesListeners,t)},ct.notifyOnCutCopyPaste=function(t,e,i){ct.cutListener=t,ct.copyListener=e,ct.pasteListener=i},ct.notifyOnLoginLogout=function(t,e){ct.loginListener=t,ct.logoutListener=e},ct.login=function(){dt.login()},ct.render=function(t){for(var e=0,i=ct.renderListeners;e<i.length;){var n=i[e];++e,n(t)}},ct.foreground=function(){for(var t=0,e=ct.foregroundListeners;t<e.length;){var i=e[t];++t,i()}},ct.resume=function(){for(var t=0,e=ct.resumeListeners;t<e.length;){var i=e[t];++t,i()}},ct.pause=function(){for(var t=0,e=ct.pauseListeners;t<e.length;){var i=e[t];++t,i()}},ct.background=function(){for(var t=0,e=ct.backgroundListeners;t<e.length;){var i=e[t];++t,i()}},ct.shutdown=function(){for(var t=0,e=ct.shutdownListeners;t<e.length;){var i=e[t];++t,i()}},ct.dropFiles=function(t){for(var e=0,i=ct.dropFilesListeners;e<i.length;){var n=i[e];++e,n(t)}},ct.get_time=function(){return dt.getTime()},ct.windowWidth=function(t){return null==t&&(t=0),ft.get(t).get_width()},ct.windowHeight=function(t){return null==t&&(t=0),ft.get_all()[t].get_height()},ct.get_screenRotation=function(){return ot.RotationNone},ct.get_systemId=function(){return dt.getSystemId()},ct.vibrate=function(t){dt.vibrate(t)},ct.get_language=function(){return dt.getLanguage()},ct.stop=function(){return dt.requestShutdown()},ct.loadUrl=function(t){dt.loadUrl(t)},ct.canSwitchFullscreen=function(){return!0},ct.isFullscreen=function(){return 1==ft.get(0).get_mode()||2==ft.get(0).get_mode()},ct.requestFullscreen=function(){ft.get(0).set_mode(1)},ct.exitFullscreen=function(){ft.get(0).set_mode(0)},ct.notifyOnFullscreenChange=function(t,e){},ct.removeFullscreenListener=function(t,e){},ct.changeResolution=function(t,e){},ct.requestShutdown=function(){ct.stop()},ct.get_vsync=function(){return ft.get(0).get_vSynced()},ct.get_refreshRate=function(){return K.get_primary().get_frequency()},ct.screenDpi=function(){return K.get_primary().get_pixelsPerInch()},ct.safeZone=function(){return dt.safeZone()},ct.automaticSafeZone=function(){return dt.automaticSafeZone()},ct.setSafeZone=function(t){dt.setSafeZone(t)},ct.unlockAchievement=function(t){dt.unlockAchievement(t)};var dt=function(){};n["kha.SystemImpl"]=dt,dt.__name__=!0,dt.renderCallback=function(){at.executeFrame(),ct.render([dt.framebuffer])},dt.dropFilesCallback=function(t){ct.dropFiles(t)},dt.copyCallback=function(){return null!=ct.copyListener?ct.copyListener():null},dt.cutCallback=function(){return null!=ct.cutListener?ct.cutListener():null},dt.pasteCallback=function(t){null!=ct.pasteListener&&ct.pasteListener(t)},dt.foregroundCallback=function(){ct.foreground()},dt.resumeCallback=function(){ct.resume()},dt.pauseCallback=function(){ct.pause()},dt.backgroundCallback=function(){ct.background()},dt.shutdownCallback=function(){ct.shutdown()},dt.keyboardDownCallback=function(t){dt.keyboard.sendDownEvent(t)},dt.keyboardUpCallback=function(t){dt.keyboard.sendUpEvent(t)},dt.keyboardPressCallback=function(t){dt.keyboard.sendPressEvent(String.fromCodePoint(t))},dt.mouseDownCallback=function(t,e,i){dt.mouse.sendDownEvent(0,t,e,i)},dt.mouseUpCallback=function(t,e,i){dt.mouse.sendUpEvent(0,t,e,i)},dt.mouseMoveCallback=function(t,e,i,n){dt.mouse.sendMoveEvent(0,t,e,i,n)},dt.mouseWheelCallback=function(t){dt.mouse.sendWheelEvent(0,t)},dt.penDownCallback=function(t,e,i){dt.pen.sendDownEvent(0,t,e,i)},dt.penUpCallback=function(t,e,i){dt.pen.sendUpEvent(0,t,e,i)},dt.penMoveCallback=function(t,e,i){dt.pen.sendMoveEvent(0,t,e,i)},dt.gamepadAxisCallback=function(t,e,i){dt.gamepads[t].sendAxisEvent(e,i)},dt.gamepadButtonCallback=function(t,e,i){dt.gamepads[t].sendButtonEvent(e,i)},dt.audioCallback=function(t){yt._callCallback(t);var e=yt.buffer;Krom.writeAudioBuffer(e.data.buffer,t)},dt.init=function(t,e){Krom.init(t.title,t.width,t.height,t.framebuffer.samplesPerPixel,t.framebuffer.verticalSync,t.window.mode,t.window.windowFeatures,3),dt.start=Krom.getTime(),v.trace=function(t,e){var i=null!=e?e.className+":"+e.lineNumber+": "+d.string(t):d.string(t);Krom.log(l.substr(i,0,511))},new ft(0),at.init(),lt.init();var i=new qe;dt.framebuffer=new Q(0,null,null,i),dt.framebuffer.init(new ne(dt.framebuffer),new Ae(dt.framebuffer),i),Krom.setCallback(dt.renderCallback),Krom.setDropFilesCallback(dt.dropFilesCallback),Krom.setCutCopyPasteCallback(dt.cutCallback,dt.copyCallback,dt.pasteCallback),Krom.setApplicationStateCallback(dt.foregroundCallback,dt.resumeCallback,dt.pauseCallback,dt.backgroundCallback,dt.shutdownCallback),dt.keyboard=new Xe,dt.mouse=new Ze,dt.pen=new je,dt.gamepads=[];for(var n=0,r=dt.maxGamepads;n<r;){var s=n++;dt.gamepads[s]=new Ge(s)}Krom.setKeyboardDownCallback(dt.keyboardDownCallback),Krom.setKeyboardUpCallback(dt.keyboardUpCallback),Krom.setKeyboardPressCallback(dt.keyboardPressCallback),Krom.setMouseDownCallback(dt.mouseDownCallback),Krom.setMouseUpCallback(dt.mouseUpCallback),Krom.setMouseMoveCallback(dt.mouseMoveCallback),Krom.setMouseWheelCallback(dt.mouseWheelCallback),Krom.setPenDownCallback(dt.penDownCallback),Krom.setPenUpCallback(dt.penUpCallback),Krom.setPenMoveCallback(dt.penMoveCallback),Krom.setGamepadAxisCallback(dt.gamepadAxisCallback),Krom.setGamepadButtonCallback(dt.gamepadButtonCallback),yt._init(),xt._init(),Krom.setAudioCallback(dt.audioCallback),at.start(),e(ft.get(0))},dt.initEx=function(t,e,i,n){},dt.translateWindowMode=function(t){if(null==t)return 0;switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},dt.getScreenRotation=function(){return ot.RotationNone},dt.getTime=function(){return Krom.getTime()-dt.start},dt.getVsync=function(){return!0},dt.getRefreshRate=function(){return 60},dt.getSystemId=function(){return Krom.systemId()},dt.vibrate=function(t){},dt.getLanguage=function(){return"en"},dt.requestShutdown=function(){return Krom.requestShutdown(),!0},dt.getMouse=function(t){return dt.mouse},dt.getPen=function(t){return dt.pen},dt.getKeyboard=function(t){return dt.keyboard},dt.lockMouse=function(){if(!dt.isMouseLocked()){Krom.lockMouse();for(var t=0,e=dt.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},dt.unlockMouse=function(){if(dt.isMouseLocked()){Krom.unlockMouse();for(var t=0,e=dt.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},dt.canLockMouse=function(){return Krom.canLockMouse()},dt.isMouseLocked=function(){return Krom.isMouseLocked()},dt.notifyOfMouseLockChange=function(t,e){dt.canLockMouse()&&null!=t&&dt.mouseLockListeners.push(t)},dt.removeFromMouseLockChange=function(t,e){dt.canLockMouse()&&null!=t&&l.remove(dt.mouseLockListeners,t)},dt.hideSystemCursor=function(){Krom.showMouse(!1)},dt.showSystemCursor=function(){Krom.showMouse(!0)},dt.unload=function(){},dt.canSwitchFullscreen=function(){return!1},dt.isFullscreen=function(){return!1},dt.requestFullscreen=function(){},dt.exitFullscreen=function(){},dt.notifyOfFullscreenChange=function(t,e){},dt.removeFromFullscreenChange=function(t,e){},dt.changeResolution=function(t,e){},dt.setKeepScreenOn=function(t){},dt.loadUrl=function(t){},dt.getGamepadId=function(t){return"unkown"},dt.safeZone=function(){return 1},dt.login=function(){},dt.automaticSafeZone=function(){return!0},dt.setSafeZone=function(t){},dt.unlockAchievement=function(t){};var _t=function(){};n["kha.Video"]=_t,_t.__name__=!0,_t.__interfaces__=[q],_t.prototype={width:function(){return 100},height:function(){return 100},play:function(t){null==t&&(t=!1)},pause:function(){},stop:function(){},getLength:function(){return 0},getCurrentPos:function(){return 0},get_position:function(){return 0},set_position:function(t){return 0},getVolume:function(){return 1},setVolume:function(t){},isFinished:function(){return this.getCurrentPos()>=this.getLength()},unload:function(){},__class__:_t};var ft=function(t){this.num=t,ft.windows.push(this)};n["kha.Window"]=ft,ft.__name__=!0,ft.create=function(t,e){return null},ft.destroy=function(t){},ft.get=function(t){return ft.windows[t]},ft.get_all=function(){return ft.windows},ft.prototype={num:null,windowTitle:null,resize:function(t,e){},move:function(t,e){},changeWindowFeatures:function(t){},changeFramebuffer:function(t){},get_x:function(){return 0},set_x:function(t){return 0},get_y:function(){return 0},set_y:function(t){return 0},get_width:function(){return Krom.windowWidth(this.num)},set_width:function(t){return 800},get_height:function(){return Krom.windowHeight(this.num)},set_height:function(t){return 600},get_mode:function(){return 0},set_mode:function(t){return 0},get_visible:function(){return!0},set_visible:function(t){return!0},get_title:function(){return this.windowTitle},set_title:function(t){return Krom.setWindowTitle(this.num,t),this.windowTitle=t,this.windowTitle},notifyOnResize:function(t){},get_vSynced:function(){return!0},__class__:ft};var pt={};n["kha._WindowOptions.WindowFeatures_Impl_"]=pt,pt.__name__=!0,pt._new=function(t){return t};var gt=function(t,e,i,n,r,s,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==s&&(s=-1),null==r&&(r=600),null==n&&(n=800),null==i&&(i=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=-1,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=i,this.width=n,this.height=r,this.display=s,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};n["kha.WindowOptions"]=gt,gt.__name__=!0,gt.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:gt};var vt={};n["kha.arrays._Float32Array.Float32Array_Impl_"]=vt,vt.__name__=!0,vt._new=function(t){return new Float32Array(t)},vt.get_buffer=function(t){return t.buffer},vt.get_length=function(t){return t.length},vt.set=function(t,e,i){return t[e]=i},vt.get=function(t,e){return t[e]},vt.data=function(t){return t},vt.subarray=function(t,e,i){return t.subarray(e,i)};var mt={};n["kha.arrays._Int16Array.Int16Array_Impl_"]=mt,mt.__name__=!0,mt._new=function(t){return new Int16Array(t)},mt.get_length=function(t){return t.length},mt.set=function(t,e,i){return t[e]=i},mt.get=function(t,e){return t[e]},mt.data=function(t){return t},mt.arrayRead=function(t,e){return t[e]},mt.arrayWrite=function(t,e,i){return t[e]=i},mt.subarray=function(t,e,i){return t.subarray(e,i)};var wt={};n["kha.arrays._Uint32Array.Uint32Array_Impl_"]=wt,wt.__name__=!0,wt._new=function(t){return new Uint32Array(t)},wt.get_length=function(t){return t.length},wt.set=function(t,e,i){return t[e]=i},wt.get=function(t,e){return t[e]},wt.data=function(t){return t},wt.arrayRead=function(t,e){return t[e]},wt.arrayWrite=function(t,e,i){return t[e]=i},wt.subarray=function(t,e,i){return t.subarray(e,i)};var bt=function(){};n["kha.audio1.AudioChannel"]=bt,bt.__name__=!0,bt.prototype={play:null,pause:null,stop:null,length:null,get_length:null,get_position:null,set_position:null,get_volume:null,set_volume:null,finished:null,get_finished:null,__class__:bt};var St=function(t){this.value=t};n["kha.internal.IntBox"]=St,St.__name__=!0,St.prototype={value:null,__class__:St};var yt=function(){};n["kha.audio2.Audio"]=yt,yt.__name__=!0,yt._init=function(){yt.buffer=new Et(8192,2,44100)},yt._callCallback=function(t){if(null!=yt.buffer)if(null!=yt.audioCallback)yt.intBox.value=t,yt.audioCallback(yt.intBox,yt.buffer);else for(var e=0,i=t;e<i;){e++;yt.buffer.data[yt.buffer.writeLocation]=0,yt.buffer.writeLocation+=1,yt.buffer.writeLocation>=yt.buffer.size&&(yt.buffer.writeLocation=0)}},yt._readSample=function(){if(null==yt.buffer)return 0;var t=yt.buffer.data[yt.buffer.readLocation];return yt.buffer.readLocation+=1,yt.buffer.readLocation>=yt.buffer.size&&(yt.buffer.readLocation=0),t},yt.play=function(t,e){return null==e&&(e=!1),null},yt.stream=function(t,e){return null==e&&(e=!1),null};var xt=function(){};n["kha.audio2.Audio1"]=xt,xt.__name__=!0,xt._init=function(){var t=new Array(32);xt.soundChannels=t;var e=new Array(32);xt.streamChannels=e;var i=new Array(32);xt.internalSoundChannels=i;var n=new Array(32);xt.internalStreamChannels=n;var r=new Float32Array(512);xt.sampleCache1=r;var s=new Float32Array(512);xt.sampleCache2=s,xt.lastAllocationCount=0,yt.audioCallback=xt.mix},xt.max=function(t,e){return t>e?t:e},xt.min=function(t,e){return t<e?t:e},xt.mix=function(t,e){var i=t.value;if(xt.sampleCache1.length<i){if(yt.disableGcInteractions){v.trace("Unexpected allocation request in audio thread.",{fileName:"kha/audio2/Audio1.hx",lineNumber:45,className:"kha.audio2.Audio1",methodName:"mix"});for(var n=0,r=i;n<r;){n++;e.data[e.writeLocation]=0,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}return xt.lastAllocationCount=0,void(yt.disableGcInteractions=!1)}var s=new Float32Array(2*i);xt.sampleCache1=s;var a=new Float32Array(2*i);xt.sampleCache2=a,xt.lastAllocationCount=0}else xt.lastAllocationCount>100?yt.disableGcInteractions=!0:xt.lastAllocationCount+=1;for(var o=0,l=i;o<l;){var h=o++;xt.sampleCache2[h]=0}for(var u=0;u<32;){var c=u++;xt.internalSoundChannels[c]=xt.soundChannels[c]}for(var d=0;d<32;){var _=d++;xt.internalStreamChannels[_]=xt.streamChannels[_]}for(var f=0,p=xt.internalSoundChannels;f<p.length;){var g=p[f];if(++f,null!=g&&!g.get_finished()){g.nextSamples(xt.sampleCache1,i,e.samplesPerSecond);for(var m=0,w=i;m<w;){var b=m++;xt.sampleCache2[b]+=xt.sampleCache1[b]*g.get_volume()}}}for(var S=0,y=xt.internalStreamChannels;S<y.length;){var x=y[S];if(++S,null!=x&&!x.get_finished()){x.nextSamples(xt.sampleCache1,i,e.samplesPerSecond);for(var T=0,E=i;T<E;){var k=T++;xt.sampleCache2[k]+=xt.sampleCache1[k]*x.get_volume()}}}for(var C=0,I=i;C<I;){var B=C++,L=xt.sampleCache2[B],A=L<1?L:1;e.data[e.writeLocation]=A>-1?A:-1,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},xt.play=function(t,e){null==e&&(e=!1);var i=null;(i=yt.samplesPerSecond!=t.sampleRate?new kt(e,t.sampleRate):new Tt(e)).data=t.uncompressedData;for(var n=!1,r=0;r<32;){var s=r++;if(null==xt.soundChannels[s]||xt.soundChannels[s].get_finished()){xt.soundChannels[s]=i,n=!0;break}}return n?i:null},xt._playAgain=function(t){for(var e=0;e<32;){var i=e++;xt.soundChannels[i]==t&&(xt.soundChannels[i]=null)}for(var n=0;n<32;){var r=n++;if(null==xt.soundChannels[r]||xt.soundChannels[r].get_finished()||xt.soundChannels[r]==t){xt.soundChannels[r]=t;break}}},xt.stream=function(t,e){null==e&&(e=!1);var i=yt.stream(t,e);if(null!=i)return i;for(var n=new Ct(t.compressedData,e),r=!1,s=0;s<32;){var a=s++;if(null==xt.streamChannels[a]||xt.streamChannels[a].get_finished()){xt.streamChannels[a]=n,r=!0;break}}return r?n:null};var Tt=function(t){this.looping=!1,this.stopped=!1,this.paused=!1,this.myPosition=0,this.myVolume=1,this.data=null,this.looping=t};n["kha.audio2.AudioChannel"]=Tt,Tt.__name__=!0,Tt.__interfaces__=[bt],Tt.max=function(t,e){return t>e?t:e},Tt.min=function(t,e){return t<e?t:e},Tt.prototype={data:null,myVolume:null,myPosition:null,paused:null,stopped:null,looping:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0;s<e;){for(var a=0,o=this.data.length-this.myPosition,l=e-s,h=o<l?o:l;a<h;){a++;t[s++]=this.data[this.myPosition++]}if(this.myPosition>=this.data.length&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;s<e;)t[s++]=0}},play:function(){this.paused=!1,this.stopped=!1,xt._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},length:null,get_length:function(){return this.data.length/yt.samplesPerSecond/2},get_position:function(){return this.myPosition/yt.samplesPerSecond/2},set_position:function(t){this.myPosition=Math.round(t*yt.samplesPerSecond*2);var e=this.myPosition,i=this.data.length,n=e<i?e:i;return this.myPosition=n>0?n:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.stopped},__class__:Tt};var Et=function(t,e,i){this.size=t;var n=new Float32Array(t);this.data=n,this.channels=e,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};n["kha.audio2.Buffer"]=Et,Et.__name__=!0,Et.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:Et};var kt=function(t,e){Tt.call(this,t),this.sampleRate=e};n["kha.audio2.ResamplingAudioChannel"]=kt,kt.__name__=!0,kt.max=function(t,e){return t>e?t:e},kt.min=function(t,e){return t<e?t:e},kt.__super__=Tt,kt.prototype=a(Tt.prototype,{sampleRate:null,nextSamples:function(t,e,i){if(this.paused||this.stopped)for(var n=0,r=e;n<r;){t[n++]=0}else{for(var s=0;s<e;){for(var a=0,o=Math.ceil(this.data.length*(i/this.sampleRate)),l=(o%2==0?o:o+1)-this.myPosition,h=e-s,u=l<h?l:h;a<u;){a++;var c,d=s++,_=this.myPosition++,f=_%2==0,p=this.sampleRate/i;if(f){var g=p*(_=_/2|0),v=Math.floor(g),m=Math.floor(g+1);v*=2,m*=2;var w=this.data.length-1;w%2==0?w=w:--w;var b=v<0||v>w?0:this.data[v],S=m<0||m>w?0:this.data[m],y=g-Math.floor(g);c=(1-y)*b+y*S}else{var x=p*(_=_/2|0),T=Math.floor(x),E=Math.floor(x+1);T=2*T+1,E=2*E+1;var k=this.data.length-1;k%2!=0?k=k:--k;var C=T<1||T>k?0:this.data[T],I=E<1||E>k?0:this.data[E],B=x-Math.floor(x);c=(1-B)*C+B*I}t[d]=c}var L=Math.ceil(this.data.length*(i/this.sampleRate));if(this.myPosition>=(L%2==0?L:L+1)&&(this.myPosition=0,!this.looping)){this.stopped=!0;break}}for(;s<e;)t[s++]=0}},sample:function(t,e){var i=t%2==0,n=this.sampleRate/e;if(i){var r=n*(t=t/2|0),s=Math.floor(r),a=Math.floor(r+1);s*=2,a*=2;var o=this.data.length-1;o%2==0?o=o:--o;var l=s<0||s>o?0:this.data[s],h=a<0||a>o?0:this.data[a],u=r-Math.floor(r);return(1-u)*l+u*h}var c=n*(t=t/2|0),d=Math.floor(c),_=Math.floor(c+1);d=2*d+1,_=2*_+1;var f=this.data.length-1;f%2!=0?f=f:--f;var p=d<1||d>f?0:this.data[d],g=_<1||_>f?0:this.data[_],v=c-Math.floor(c);return(1-v)*p+v*g},lerp:function(t,e,i){return(1-i)*t+i*e},sampleLength:function(t){var e=Math.ceil(this.data.length*(t/this.sampleRate));return e%2==0?e:e+1},play:function(){this.paused=!1,this.stopped=!1,xt._playAgain(this)},pause:function(){this.paused=!0},stop:function(){this.myPosition=0,this.stopped=!0},get_length:function(){return this.data.length/this.sampleRate/2},get_position:function(){return this.myPosition/this.sampleRate/2},set_position:function(t){this.myPosition=Math.round(t*this.sampleRate*2);var e=this.myPosition,i=Math.ceil(this.data.length*(yt.samplesPerSecond/this.sampleRate)),n=i%2==0?i:i+1,r=e<n?e:n;return this.myPosition=r>0?r:0,t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.stopped},__class__:kt});var Ct=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e,this.reader=At.openFromBytes(t)};n["kha.audio2.StreamChannel"]=Ct,Ct.__name__=!0,Ct.__interfaces__=[bt],Ct.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,i){if(this.paused)for(var n=0,r=e;n<r;){t[n++]=0}else{var s=2*this.reader.read(t,e/2|0,2,i,!0);if(s<e){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=s,o=e;a<o;){t[a++]=0}}}},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},length:null,get_length:function(){return this.reader.get_totalMillisecond()/1e3},get_position:function(){return this.reader.get_currentMillisecond()/1e3},set_position:function(t){return t},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},finished:null,get_finished:function(){return this.atend},__class__:Ct};var It=function(){};n["kha.audio2.ogg.tools.Crc32"]=It,It.__name__=!0,It.init=function(){if(null==It.table){var t=new Array(256);It.table=t;for(var e=0;e<256;){var i=e++,n=i<<24;n=(n=(n=(n=(n=(n=(n=(n=n<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0))<<1^(p.gte(n,1<<31)?79764919:0),It.table[i]=n}}},It.update=function(t,e){return t<<8^It.table[e^t>>>24]};var Bt=function(){};n["kha.audio2.ogg.tools.MathTools"]=Bt,Bt.__name__=!0,Bt.ilog=function(t){var e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];return t<16384?t<16?e[t]:t<512?5+e[t>>5]:10+e[t>>10]:t<16777216?t<524288?15+e[t>>15]:20+e[t>>20]:t<536870912?25+e[t>>25]:t<-2147483648?30+e[t>>30]:0};var Lt=function(){};n["kha.audio2.ogg.tools.Mdct"]=Lt,Lt.__name__=!0,Lt.inverseTransform=function(t,e,i,n,r,s){for(var a=e>>1,o=e>>2,l=e>>3,h=new Array(a),u=a-2,c=0,d=0,_=a;d!=_;)h[u+1]=t[d]*i[c]-t[d+2]*i[c+1],h[u]=t[d]*i[c+1]+t[d+2]*i[c],u-=2,c+=2,d+=4;for(d=a-3;u>=0;)h[u+1]=-t[d+2]*i[c]- -t[d]*i[c+1],h[u]=-t[d+2]*i[c+1]+-t[d]*i[c],u-=2,c+=2,d-=4;for(var f=t,p=h,g=a-8,v=o,m=0,w=o,b=0;g>=0;){var S=p[v+1]-p[m+1],y=p[v]-p[m];f[w+1]=p[v+1]+p[m+1],f[w]=p[v]+p[m],f[b+1]=S*i[g+4]-y*i[g+5],f[b]=y*i[g+4]+S*i[g+5],S=p[v+3]-p[m+3],y=p[v+2]-p[m+2],f[w+3]=p[v+3]+p[m+3],f[w+2]=p[v+2]+p[m+2],f[b+3]=S*i[g]-y*i[g+1],f[b+2]=y*i[g]+S*i[g+1],g-=8,w+=4,b+=4,v+=4,m+=4}for(var x=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],T=(e<16384?e<16?x[e]:e<512?5+x[e>>5]:10+x[e>>10]:e<16777216?e<524288?15+x[e>>15]:20+x[e>>20]:e<536870912?25+x[e>>25]:e<-2147483648?30+x[e>>30]:0)-1,E=a-1-0*o,k=E,C=E+-(e>>3),I=0,B=1+(e>>4>>2);--B>0;){var L=f[k]-f[C],A=f[k+-1]-f[C+-1],N=k,V=f;V[N]=V[N]+f[C];var R=k+-1,P=f;P[R]=P[R]+f[C+-1],f[C]=L*i[I]-A*i[I+1],f[C+-1]=A*i[I]+L*i[I+1],I+=8,L=f[k+-2]-f[C+-2],A=f[k+-3]-f[C+-3];var M=k+-2,D=f;D[M]=D[M]+f[C+-2];var F=k+-3,O=f;O[F]=O[F]+f[C+-3],f[C+-2]=L*i[I]-A*i[I+1],f[C+-3]=A*i[I]+L*i[I+1],I+=8,L=f[k+-4]-f[C+-4],A=f[k+-5]-f[C+-5];var W=k+-4,U=f;U[W]=U[W]+f[C+-4];var H=k+-5,G=f;G[H]=G[H]+f[C+-5],f[C+-4]=L*i[I]-A*i[I+1],f[C+-5]=A*i[I]+L*i[I+1],I+=8,L=f[k+-6]-f[C+-6],A=f[k+-7]-f[C+-7];var z=k+-6,Y=f;Y[z]=Y[z]+f[C+-6];var X=k+-7,K=f;K[X]=K[X]+f[C+-7],f[C+-6]=L*i[I]-A*i[I+1],f[C+-7]=A*i[I]+L*i[I+1],I+=8,k-=8,C-=8}for(var Z=a-1-o,j=Z,Q=Z+-(e>>3),J=0,q=1+(e>>4>>2);--q>0;){var $=f[j]-f[Q],tt=f[j+-1]-f[Q+-1],et=j,it=f;it[et]=it[et]+f[Q];var nt=j+-1,rt=f;rt[nt]=rt[nt]+f[Q+-1],f[Q]=$*i[J]-tt*i[J+1],f[Q+-1]=tt*i[J]+$*i[J+1],J+=8,$=f[j+-2]-f[Q+-2],tt=f[j+-3]-f[Q+-3];var st=j+-2,at=f;at[st]=at[st]+f[Q+-2];var ot=j+-3,lt=f;lt[ot]=lt[ot]+f[Q+-3],f[Q+-2]=$*i[J]-tt*i[J+1],f[Q+-3]=tt*i[J]+$*i[J+1],J+=8,$=f[j+-4]-f[Q+-4],tt=f[j+-5]-f[Q+-5];var ht=j+-4,ut=f;ut[ht]=ut[ht]+f[Q+-4];var ct=j+-5,dt=f;dt[ct]=dt[ct]+f[Q+-5],f[Q+-4]=$*i[J]-tt*i[J+1],f[Q+-5]=tt*i[J]+$*i[J+1],J+=8,$=f[j+-6]-f[Q+-6],tt=f[j+-7]-f[Q+-7];var _t=j+-6,ft=f;ft[_t]=ft[_t]+f[Q+-6];var pt=j+-7,gt=f;gt[pt]=gt[pt]+f[Q+-7],f[Q+-6]=$*i[J]-tt*i[J+1],f[Q+-7]=tt*i[J]+$*i[J+1],J+=8,j-=8,Q-=8}for(var vt=a-1-0*l,mt=0,wt=vt,bt=vt+-(e>>4),St=1+(e>>5>>2);--St>0;){var yt=f[wt]-f[bt],xt=f[wt+-1]-f[bt+-1],Tt=wt,Et=f;Et[Tt]=Et[Tt]+f[bt];var kt=wt+-1,Ct=f;Ct[kt]=Ct[kt]+f[bt+-1],f[bt]=yt*i[mt]-xt*i[mt+1],f[bt+-1]=xt*i[mt]+yt*i[mt+1],mt+=16,yt=f[wt+-2]-f[bt+-2],xt=f[wt+-3]-f[bt+-3];var It=wt+-2,Bt=f;Bt[It]=Bt[It]+f[bt+-2];var Lt=wt+-3,At=f;At[Lt]=At[Lt]+f[bt+-3],f[bt+-2]=yt*i[mt]-xt*i[mt+1],f[bt+-3]=xt*i[mt]+yt*i[mt+1],mt+=16,yt=f[wt+-4]-f[bt+-4],xt=f[wt+-5]-f[bt+-5];var Nt=wt+-4,Vt=f;Vt[Nt]=Vt[Nt]+f[bt+-4];var Rt=wt+-5,Pt=f;Pt[Rt]=Pt[Rt]+f[bt+-5],f[bt+-4]=yt*i[mt]-xt*i[mt+1],f[bt+-5]=xt*i[mt]+yt*i[mt+1],mt+=16,yt=f[wt+-6]-f[bt+-6],xt=f[wt+-7]-f[bt+-7];var Mt=wt+-6,Dt=f;Dt[Mt]=Dt[Mt]+f[bt+-6];var Ft=wt+-7,Ot=f;Ot[Ft]=Ot[Ft]+f[bt+-7],f[bt+-6]=yt*i[mt]-xt*i[mt+1],f[bt+-7]=xt*i[mt]+yt*i[mt+1],wt-=8,bt-=8,mt+=16}for(var Wt=a-1-l,Ut=0,Ht=Wt,Gt=Wt+-(e>>4),zt=1+(e>>5>>2);--zt>0;){var Yt=f[Ht]-f[Gt],Xt=f[Ht+-1]-f[Gt+-1],Kt=Ht,Zt=f;Zt[Kt]=Zt[Kt]+f[Gt];var jt=Ht+-1,Qt=f;Qt[jt]=Qt[jt]+f[Gt+-1],f[Gt]=Yt*i[Ut]-Xt*i[Ut+1],f[Gt+-1]=Xt*i[Ut]+Yt*i[Ut+1],Ut+=16,Yt=f[Ht+-2]-f[Gt+-2],Xt=f[Ht+-3]-f[Gt+-3];var Jt=Ht+-2,qt=f;qt[Jt]=qt[Jt]+f[Gt+-2];var $t=Ht+-3,te=f;te[$t]=te[$t]+f[Gt+-3],f[Gt+-2]=Yt*i[Ut]-Xt*i[Ut+1],f[Gt+-3]=Xt*i[Ut]+Yt*i[Ut+1],Ut+=16,Yt=f[Ht+-4]-f[Gt+-4],Xt=f[Ht+-5]-f[Gt+-5];var ee=Ht+-4,ie=f;ie[ee]=ie[ee]+f[Gt+-4];var ne=Ht+-5,re=f;re[ne]=re[ne]+f[Gt+-5],f[Gt+-4]=Yt*i[Ut]-Xt*i[Ut+1],f[Gt+-5]=Xt*i[Ut]+Yt*i[Ut+1],Ut+=16,Yt=f[Ht+-6]-f[Gt+-6],Xt=f[Ht+-7]-f[Gt+-7];var se=Ht+-6,ae=f;ae[se]=ae[se]+f[Gt+-6];var oe=Ht+-7,le=f;le[oe]=le[oe]+f[Gt+-7],f[Gt+-6]=Yt*i[Ut]-Xt*i[Ut+1],f[Gt+-7]=Xt*i[Ut]+Yt*i[Ut+1],Ht-=8,Gt-=8,Ut+=16}for(var he=a-1-2*l,ue=0,ce=he,de=he+-(e>>4),_e=1+(e>>5>>2);--_e>0;){var fe=f[ce]-f[de],pe=f[ce+-1]-f[de+-1],ge=ce,ve=f;ve[ge]=ve[ge]+f[de];var me=ce+-1,we=f;we[me]=we[me]+f[de+-1],f[de]=fe*i[ue]-pe*i[ue+1],f[de+-1]=pe*i[ue]+fe*i[ue+1],ue+=16,fe=f[ce+-2]-f[de+-2],pe=f[ce+-3]-f[de+-3];var be=ce+-2,Se=f;Se[be]=Se[be]+f[de+-2];var ye=ce+-3,xe=f;xe[ye]=xe[ye]+f[de+-3],f[de+-2]=fe*i[ue]-pe*i[ue+1],f[de+-3]=pe*i[ue]+fe*i[ue+1],ue+=16,fe=f[ce+-4]-f[de+-4],pe=f[ce+-5]-f[de+-5];var Te=ce+-4,Ee=f;Ee[Te]=Ee[Te]+f[de+-4];var ke=ce+-5,Ce=f;Ce[ke]=Ce[ke]+f[de+-5],f[de+-4]=fe*i[ue]-pe*i[ue+1],f[de+-5]=pe*i[ue]+fe*i[ue+1],ue+=16,fe=f[ce+-6]-f[de+-6],pe=f[ce+-7]-f[de+-7];var Ie=ce+-6,Be=f;Be[Ie]=Be[Ie]+f[de+-6];var Le=ce+-7,Ae=f;Ae[Le]=Ae[Le]+f[de+-7],f[de+-6]=fe*i[ue]-pe*i[ue+1],f[de+-7]=pe*i[ue]+fe*i[ue+1],ce-=8,de-=8,ue+=16}for(var Ne=a-1-3*l,Ve=0,Re=Ne,Pe=Ne+-(e>>4),Me=1+(e>>5>>2);--Me>0;){var De=f[Re]-f[Pe],Fe=f[Re+-1]-f[Pe+-1],Oe=Re,We=f;We[Oe]=We[Oe]+f[Pe];var Ue=Re+-1,He=f;He[Ue]=He[Ue]+f[Pe+-1],f[Pe]=De*i[Ve]-Fe*i[Ve+1],f[Pe+-1]=Fe*i[Ve]+De*i[Ve+1],Ve+=16,De=f[Re+-2]-f[Pe+-2],Fe=f[Re+-3]-f[Pe+-3];var Ge=Re+-2,ze=f;ze[Ge]=ze[Ge]+f[Pe+-2];var Ye=Re+-3,Xe=f;Xe[Ye]=Xe[Ye]+f[Pe+-3],f[Pe+-2]=De*i[Ve]-Fe*i[Ve+1],f[Pe+-3]=Fe*i[Ve]+De*i[Ve+1],Ve+=16,De=f[Re+-4]-f[Pe+-4],Fe=f[Re+-5]-f[Pe+-5];var Ke=Re+-4,Ze=f;Ze[Ke]=Ze[Ke]+f[Pe+-4];var je=Re+-5,Qe=f;Qe[je]=Qe[je]+f[Pe+-5],f[Pe+-4]=De*i[Ve]-Fe*i[Ve+1],f[Pe+-5]=Fe*i[Ve]+De*i[Ve+1],Ve+=16,De=f[Re+-6]-f[Pe+-6],Fe=f[Re+-7]-f[Pe+-7];var Je=Re+-6,qe=f;qe[Je]=qe[Je]+f[Pe+-6];var $e=Re+-7,ti=f;ti[$e]=ti[$e]+f[Pe+-7],f[Pe+-6]=De*i[Ve]-Fe*i[Ve+1],f[Pe+-7]=Fe*i[Ve]+De*i[Ve+1],Re-=8,Pe-=8,Ve+=16}for(var ei=2,ii=T-3>>1;ei<ii;)for(var ni=ei++,ri=e>>ni+2,si=ri>>1,ai=0,oi=1<<ni+1;ai<oi;)for(var li=a-1-ri*ai++,hi=1<<ni+3,ui=0,ci=li,di=li+-si,_i=1+(e>>ni+4>>2);--_i>0;){var fi=f[ci]-f[di],pi=f[ci+-1]-f[di+-1],gi=ci,vi=f;vi[gi]=vi[gi]+f[di];var mi=ci+-1,wi=f;wi[mi]=wi[mi]+f[di+-1],f[di]=fi*i[ui]-pi*i[ui+1],f[di+-1]=pi*i[ui]+fi*i[ui+1],ui+=hi,fi=f[ci+-2]-f[di+-2],pi=f[ci+-3]-f[di+-3];var bi=ci+-2,Si=f;Si[bi]=Si[bi]+f[di+-2];var yi=ci+-3,xi=f;xi[yi]=xi[yi]+f[di+-3],f[di+-2]=fi*i[ui]-pi*i[ui+1],f[di+-3]=pi*i[ui]+fi*i[ui+1],ui+=hi,fi=f[ci+-4]-f[di+-4],pi=f[ci+-5]-f[di+-5];var Ti=ci+-4,Ei=f;Ei[Ti]=Ei[Ti]+f[di+-4];var ki=ci+-5,Ci=f;Ci[ki]=Ci[ki]+f[di+-5],f[di+-4]=fi*i[ui]-pi*i[ui+1],f[di+-5]=pi*i[ui]+fi*i[ui+1],ui+=hi,fi=f[ci+-6]-f[di+-6],pi=f[ci+-7]-f[di+-7];var Ii=ci+-6,Bi=f;Bi[Ii]=Bi[Ii]+f[di+-6];var Li=ci+-7,Ai=f;Ai[Li]=Ai[Li]+f[di+-7],f[di+-6]=fi*i[ui]-pi*i[ui+1],f[di+-7]=pi*i[ui]+fi*i[ui+1],ci-=8,di-=8,ui+=hi}for(var Ni=T-3>>1,Vi=T-6;Ni<Vi;)for(var Ri=Ni++,Pi=e>>Ri+2,Mi=1<<Ri+3,Di=Pi>>1,Fi=1<<Ri+1,Oi=0,Wi=a-1,Ui=(e>>Ri+6)+1;--Ui>0;){for(var Hi=i[Oi],Gi=i[Oi+1],zi=i[Oi+Mi],Yi=i[Oi+Mi+1],Xi=i[Oi+2*Mi],Ki=i[Oi+2*Mi+1],Zi=i[Oi+3*Mi],ji=i[Oi+3*Mi+1],Qi=Wi,Ji=Wi+-Di,qi=Fi+1;--qi>0;){var $i=f[Qi]-f[Ji],tn=f[Qi+-1]-f[Ji+-1];f[Qi]=f[Qi]+f[Ji],f[Qi+-1]=f[Qi+-1]+f[Ji+-1],f[Ji]=$i*Hi-tn*Gi,f[Ji+-1]=tn*Hi+$i*Gi,$i=f[Qi+-2]-f[Ji+-2],tn=f[Qi+-3]-f[Ji+-3],f[Qi+-2]=f[Qi+-2]+f[Ji+-2],f[Qi+-3]=f[Qi+-3]+f[Ji+-3],f[Ji+-2]=$i*zi-tn*Yi,f[Ji+-3]=tn*zi+$i*Yi,$i=f[Qi+-4]-f[Ji+-4],tn=f[Qi+-5]-f[Ji+-5],f[Qi+-4]=f[Qi+-4]+f[Ji+-4],f[Qi+-5]=f[Qi+-5]+f[Ji+-5],f[Ji+-4]=$i*Xi-tn*Ki,f[Ji+-5]=tn*Xi+$i*Ki,$i=f[Qi+-6]-f[Ji+-6],tn=f[Qi+-7]-f[Ji+-7],f[Qi+-6]=f[Qi+-6]+f[Ji+-6],f[Qi+-7]=f[Qi+-7]+f[Ji+-7],f[Ji+-6]=$i*Zi-tn*ji,f[Ji+-7]=tn*Zi+$i*ji,Qi-=Pi,Ji-=Pi}Oi+=4*Mi,Wi-=8}for(var en=a-1,nn=i[e>>3],rn=en,sn=en-16*(e>>5);rn>sn;){var an=f[rn],on=f[rn+-8];f[rn+-8]=an-on,f[rn]=an+on,an=f[rn+-1],on=f[rn+-9],f[rn+-9]=an-on,f[rn+-1]=an+on;var ln=(an=f[rn+-2])-(on=f[rn+-10]);f[rn+-2]=an+on;var hn=(an=f[rn+-3])-(on=f[rn+-11]);f[rn+-3]=an+on,f[rn+-10]=(ln+hn)*nn,f[rn+-11]=(hn-ln)*nn,an=f[rn+-4],ln=(on=f[rn+-12])-an,f[rn+-4]=an+on,hn=(an=f[rn+-5])-(on=f[rn+-13]),f[rn+-5]=an+on,f[rn+-12]=hn,f[rn+-13]=ln,an=f[rn+-6],ln=(on=f[rn+-14])-an,f[rn+-6]=an+on,hn=(an=f[rn+-7])-(on=f[rn+-15]),f[rn+-7]=an+on,f[rn+-14]=(ln+hn)*nn,f[rn+-15]=(ln-hn)*nn;var un=f[rn],cn=f[rn+-4],dn=un-cn,_n=un+cn,fn=(un=f[rn+-2])+(cn=f[rn+-6]),pn=un-cn;f[rn]=_n+fn,f[rn+-2]=_n-fn;var gn=f[rn+-3]-f[rn+-7];f[rn+-4]=dn+gn,f[rn+-6]=dn-gn;var vn=(un=f[rn+-1])-(cn=f[rn+-5]),mn=un+cn,wn=f[rn+-3]+f[rn+-7];f[rn+-1]=mn+wn,f[rn+-3]=mn-wn,f[rn+-5]=vn-pn,f[rn+-7]=vn+pn;var bn=rn-8,Sn=f[bn],yn=f[bn+-4],xn=Sn-yn,Tn=Sn+yn,En=(Sn=f[bn+-2])+(yn=f[bn+-6]),kn=Sn-yn;f[bn]=Tn+En,f[bn+-2]=Tn-En;var Cn=f[bn+-3]-f[bn+-7];f[bn+-4]=xn+Cn,f[bn+-6]=xn-Cn;var In=(Sn=f[bn+-1])-(yn=f[bn+-5]),Bn=Sn+yn,Ln=f[bn+-3]+f[bn+-7];f[bn+-1]=Bn+Ln,f[bn+-3]=Bn-Ln,f[bn+-5]=In-kn,f[bn+-7]=In+kn,rn-=16}for(var An=0,Nn=o-4,Vn=a-4;Nn>=0;){var Rn=s[An];p[Vn+3]=f[Rn],p[Vn+2]=f[Rn+1],p[Nn+3]=f[Rn+2],p[Nn+2]=f[Rn+3],Rn=s[An+1],p[Vn+1]=f[Rn],p[Vn]=f[Rn+1],p[Nn+1]=f[Rn+2],p[Nn]=f[Rn+3],Nn-=4,Vn-=4,An+=2}for(var Pn=0,Mn=0,Dn=a-4;Mn<Dn;){var Fn=p[Mn]-p[Dn+2],On=p[Mn+1]+p[Dn+3],Wn=r[Pn+1]*Fn+r[Pn]*On,Un=r[Pn+1]*On-r[Pn]*Fn,Hn=p[Mn]+p[Dn+2],Gn=p[Mn+1]-p[Dn+3];p[Mn]=Hn+Wn,p[Mn+1]=Gn+Un,p[Dn+2]=Hn-Wn,p[Dn+3]=Un-Gn,Fn=p[Mn+2]-p[Dn],On=p[Mn+3]+p[Dn+1],Wn=r[Pn+3]*Fn+r[Pn+2]*On,Un=r[Pn+3]*On-r[Pn+2]*Fn,Hn=p[Mn+2]+p[Dn],Gn=p[Mn+3]-p[Dn+1],p[Mn+2]=Hn+Wn,p[Mn+3]=Gn+Un,p[Dn]=Hn-Wn,p[Dn+1]=Un-Gn,Pn+=4,Mn+=4,Dn-=4}for(var zn=a-8,Yn=a-8,Xn=0,Kn=a-4,Zn=a,jn=e-4;Yn>=0;){var Qn=h[Yn+6]*n[zn+7]-h[Yn+7]*n[zn+6],Jn=-h[Yn+6]*n[zn+6]-h[Yn+7]*n[zn+7];t[Xn]=Qn,t[Kn+3]=-Qn,t[Zn]=Jn,t[jn+3]=Jn;var qn=h[Yn+4]*n[zn+5]-h[Yn+5]*n[zn+4],$n=-h[Yn+4]*n[zn+4]-h[Yn+5]*n[zn+5];t[Xn+1]=qn,t[Kn+2]=-qn,t[Zn+1]=$n,t[jn+2]=$n,Qn=h[Yn+2]*n[zn+3]-h[Yn+3]*n[zn+2],Jn=-h[Yn+2]*n[zn+2]-h[Yn+3]*n[zn+3],t[Xn+2]=Qn,t[Kn+1]=-Qn,t[Zn+2]=Jn,t[jn+1]=Jn,qn=h[Yn]*n[zn+1]-h[Yn+1]*n[zn],$n=-h[Yn]*n[zn]-h[Yn+1]*n[zn+1],t[Xn+3]=qn,t[Kn]=-qn,t[Zn+3]=$n,t[jn]=$n,zn-=8,Yn-=8,Xn+=4,Zn+=4,Kn-=4,jn-=4}},Lt.step3Iter0Loop=function(t,e,i,n,r){for(var s=i,a=i+n,o=0,l=1+(t>>2);--l>0;){var h=e[s]-e[a],u=e[s+-1]-e[a+-1],c=s,d=e;d[c]=d[c]+e[a];var _=s+-1,f=e;f[_]=f[_]+e[a+-1],e[a]=h*r[o]-u*r[o+1],e[a+-1]=u*r[o]+h*r[o+1],o+=8,h=e[s+-2]-e[a+-2],u=e[s+-3]-e[a+-3];var p=s+-2,g=e;g[p]=g[p]+e[a+-2];var v=s+-3,m=e;m[v]=m[v]+e[a+-3],e[a+-2]=h*r[o]-u*r[o+1],e[a+-3]=u*r[o]+h*r[o+1],o+=8,h=e[s+-4]-e[a+-4],u=e[s+-5]-e[a+-5];var w=s+-4,b=e;b[w]=b[w]+e[a+-4];var S=s+-5,y=e;y[S]=y[S]+e[a+-5],e[a+-4]=h*r[o]-u*r[o+1],e[a+-5]=u*r[o]+h*r[o+1],o+=8,h=e[s+-6]-e[a+-6],u=e[s+-7]-e[a+-7];var x=s+-6,T=e;T[x]=T[x]+e[a+-6];var E=s+-7,k=e;k[E]=k[E]+e[a+-7],e[a+-6]=h*r[o]-u*r[o+1],e[a+-7]=u*r[o]+h*r[o+1],o+=8,s-=8,a-=8}},Lt.step3InnerRLoop=function(t,e,i,n,r,s){for(var a=0,o=i,l=i+n,h=1+(t>>2);--h>0;){var u=e[o]-e[l],c=e[o+-1]-e[l+-1],d=o,_=e;_[d]=_[d]+e[l];var f=o+-1,p=e;p[f]=p[f]+e[l+-1],e[l]=u*r[a]-c*r[a+1],e[l+-1]=c*r[a]+u*r[a+1],a+=s,u=e[o+-2]-e[l+-2],c=e[o+-3]-e[l+-3];var g=o+-2,v=e;v[g]=v[g]+e[l+-2];var m=o+-3,w=e;w[m]=w[m]+e[l+-3],e[l+-2]=u*r[a]-c*r[a+1],e[l+-3]=c*r[a]+u*r[a+1],a+=s,u=e[o+-4]-e[l+-4],c=e[o+-5]-e[l+-5];var b=o+-4,S=e;S[b]=S[b]+e[l+-4];var y=o+-5,x=e;x[y]=x[y]+e[l+-5],e[l+-4]=u*r[a]-c*r[a+1],e[l+-5]=c*r[a]+u*r[a+1],a+=s,u=e[o+-6]-e[l+-6],c=e[o+-7]-e[l+-7];var T=o+-6,E=e;E[T]=E[T]+e[l+-6];var k=o+-7,C=e;C[k]=C[k]+e[l+-7],e[l+-6]=u*r[a]-c*r[a+1],e[l+-7]=c*r[a]+u*r[a+1],o-=8,l-=8,a+=s}},Lt.step3InnerSLoop=function(t,e,i,n,r,s,a,o){for(var l=r[s],h=r[s+1],u=r[s+a],c=r[s+a+1],d=r[s+2*a],_=r[s+2*a+1],f=r[s+3*a],p=r[s+3*a+1],g=i,v=i+n,m=t+1;--m>0;){var w=e[g]-e[v],b=e[g+-1]-e[v+-1];e[g]=e[g]+e[v],e[g+-1]=e[g+-1]+e[v+-1],e[v]=w*l-b*h,e[v+-1]=b*l+w*h,w=e[g+-2]-e[v+-2],b=e[g+-3]-e[v+-3],e[g+-2]=e[g+-2]+e[v+-2],e[g+-3]=e[g+-3]+e[v+-3],e[v+-2]=w*u-b*c,e[v+-3]=b*u+w*c,w=e[g+-4]-e[v+-4],b=e[g+-5]-e[v+-5],e[g+-4]=e[g+-4]+e[v+-4],e[g+-5]=e[g+-5]+e[v+-5],e[v+-4]=w*d-b*_,e[v+-5]=b*d+w*_,w=e[g+-6]-e[v+-6],b=e[g+-7]-e[v+-7],e[g+-6]=e[g+-6]+e[v+-6],e[g+-7]=e[g+-7]+e[v+-7],e[v+-6]=w*f-b*p,e[v+-7]=b*f+w*p,g-=o,v-=o}},Lt.iter54=function(t,e){var i=t[e],n=t[e+-4],r=i-n,s=i+n,a=(i=t[e+-2])+(n=t[e+-6]),o=i-n;t[e]=s+a,t[e+-2]=s-a;var l=t[e+-3]-t[e+-7];t[e+-4]=r+l,t[e+-6]=r-l;var h=(i=t[e+-1])-(n=t[e+-5]),u=i+n,c=t[e+-3]+t[e+-7];t[e+-1]=u+c,t[e+-3]=u-c,t[e+-5]=h-o,t[e+-7]=h+o},Lt.step3InnerSLoopLd654=function(t,e,i,n,r){for(var s=n[r>>3],a=i,o=i-16*t;a>o;){var l=e[a],h=e[a+-8];e[a+-8]=l-h,e[a]=l+h,l=e[a+-1],h=e[a+-9],e[a+-9]=l-h,e[a+-1]=l+h;var u=(l=e[a+-2])-(h=e[a+-10]);e[a+-2]=l+h;var c=(l=e[a+-3])-(h=e[a+-11]);e[a+-3]=l+h,e[a+-10]=(u+c)*s,e[a+-11]=(c-u)*s,l=e[a+-4],u=(h=e[a+-12])-l,e[a+-4]=l+h,c=(l=e[a+-5])-(h=e[a+-13]),e[a+-5]=l+h,e[a+-12]=c,e[a+-13]=u,l=e[a+-6],u=(h=e[a+-14])-l,e[a+-6]=l+h,c=(l=e[a+-7])-(h=e[a+-15]),e[a+-7]=l+h,e[a+-14]=(u+c)*s,e[a+-15]=(u-c)*s;var d=e[a],_=e[a+-4],f=d-_,p=d+_,g=(d=e[a+-2])+(_=e[a+-6]),v=d-_;e[a]=p+g,e[a+-2]=p-g;var m=e[a+-3]-e[a+-7];e[a+-4]=f+m,e[a+-6]=f-m;var w=(d=e[a+-1])-(_=e[a+-5]),b=d+_,S=e[a+-3]+e[a+-7];e[a+-1]=b+S,e[a+-3]=b-S,e[a+-5]=w-v,e[a+-7]=w+v;var y=a-8,x=e[y],T=e[y+-4],E=x-T,k=x+T,C=(x=e[y+-2])+(T=e[y+-6]),I=x-T;e[y]=k+C,e[y+-2]=k-C;var B=e[y+-3]-e[y+-7];e[y+-4]=E+B,e[y+-6]=E-B;var L=(x=e[y+-1])-(T=e[y+-5]),A=x+T,N=e[y+-3]+e[y+-7];e[y+-1]=A+N,e[y+-3]=A-N,e[y+-5]=L-I,e[y+-7]=L+I,a-=16}};var At=function(t,e,i){this.seekFunc=e,this.inputLength=i,this.decoder=Rt.start(t),this.decoder.setupSampleNumber(e,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};n["kha.audio2.ogg.vorbis.Reader"]=At,At.__name__=!0,At.openFromBytes=function(t){var e=new I(t),i=e;return new At(e,function(t){At.seekBytes(i,t)},t.length)},At.seekBytes=function(t,e){t.set_position(e)},At.readAll=function(t,e,i){null==i&&(i=!1);var n=new I(t),r=Rt.start(n),s=n;r.setupSampleNumber(function(t){At.seekBytes(s,t)},t.length);for(var a=r.header,o=new Float32Array(4096*a.channel);;){for(var l=r.read(o,4096,a.channel,a.sampleRate,i),h=0,u=l*a.channel;h<u;){var c=h++;e.writeFloat(o[c])}if(0==l)break;l}return r.header},At.prototype={decoder:null,get_header:function(){return this.decoder.header},get_totalSample:function(){return this.decoder.totalSample},get_totalMillisecond:function(){var t=this.decoder.totalSample,e=this.get_header().sampleRate;return p.toFloat(t)/p.toFloat(e)*1e3},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(t){return this.decoder.seek(this.seekFunc,this.inputLength,t),this.decoder.currentSample},get_currentMillisecond:function(){var t=this.get_currentSample(),e=this.get_header().sampleRate;return p.toFloat(t)/p.toFloat(e)*1e3},set_currentMillisecond:function(t){return this.set_currentSample(Math.floor(p.toFloat(this.get_header().sampleRate)*(t/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(t,e,i,n,r){return null==r&&(r=!1),this.decoder.ensurePosition(this.seekFunc),null==e&&(e=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==n&&(n=this.get_header().sampleRate),this.decoder.read(t,e,i,n,r)},clone:function(){var t=Object.create(At.prototype);return t.seekFunc=this.seekFunc,t.inputLength=this.inputLength,t.decoder=this.decoder.clone(this.seekFunc),t.loopStart=this.loopStart,t.loopLength=this.loopLength,t},sampleToMillisecond:function(t){var e=this.get_header().sampleRate;return p.toFloat(t)/p.toFloat(e)*1e3},millisecondToSample:function(t){return Math.floor(p.toFloat(this.get_header().sampleRate)*(t/1e3))},__class__:At};var Nt=function(t){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=t,this.inputPosition=0,this.page=new Xt,It.init()};n["kha.audio2.ogg.vorbis.VorbisDecodeState"]=Nt,Nt.__name__=!0,Nt.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,currentSample:null,previousWindow:null,previousLength:null,finalY:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(t,e){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var n=new Array(i),r=0,s=i;r<s;){n[r++]=this.input.readByte()}if(this.segments=n,this.endSegWithKnownLoc=-2,-1!=t||-1!=e)for(var a=i-1;a>=0&&!(this.segments[a]<255);)a>=0&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=t),--a;if(this.firstDecode){for(var o=0,l=new Zt,h=0,u=i;h<u;){var c=h++;o+=this.segments[c]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=t,this.pFirst=l}this.nextSeg=0},clone:function(t){var e=Object.create(Nt.prototype);return t(this.inputPosition),e.input=this.input,e.eof=this.eof,e.validBits=this.validBits,e.discardSamplesDeferred=this.discardSamplesDeferred,e.firstDecode=this.firstDecode,e.nextSeg=this.nextSeg,e.bytesInSeg=this.bytesInSeg,e.acc=e.acc,e.lastSeg=this.lastSeg,e.lastSegWhich=this.lastSegWhich,e.currentLoc=this.currentLoc,e.currentLocValid=this.currentLocValid,e.inputPosition=this.inputPosition,e.firstAudioPageOffset=this.firstAudioPageOffset,e.error=this.error,e.segments=this.segments,e.pFirst=this.pFirst,e.pLast=this.pLast,e.page=this.page.clone(),e},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(e){var t=e instanceof M?e.val:e;if(t instanceof jt)return this.lastSeg=!0,this.error=t,0;throw e}if(0==(1&this.page.flag))throw new M(new jt(Qt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var e=this.segments[this.nextSeg++];return e<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=e,e},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new M(new jt(Qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var t,e,i,n,r=!1;try{this.inputPosition+=1,t=this.input.readByte()}catch(e){var s=e instanceof M?e.val:e;if(!(s instanceof N))throw e;r=!0,t=0}if(r)return!1;if(79==t?(this.inputPosition+=1,n=103!=this.input.readByte()):n=!0,n?i=!0:(this.inputPosition+=1,i=103!=this.input.readByte()),i?e=!0:(this.inputPosition+=1,e=83!=this.input.readByte()),e)throw new M(new jt(Qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(t){if(this.validBits<0)return 0;if(this.validBits<t){if(t>24)return this.readBits(24)+(this.readBits(t-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<t))break}if(this.validBits<0)return 0;var e=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,e}var i=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,i},readPacketRaw:function(){return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()):-1},readPacket:function(){var t;return 0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,t=this.input.readByte()):t=-1,this.validBits=0,t},flushPacket:function(){for(;0!=this.bytesInSeg||!this.lastSeg&&0!=this.next();)this.bytesInSeg--,this.inputPosition+=1,this.input.readByte()},vorbisValidate:function(){var t,e,i,n,r,s,a=new E(new ArrayBuffer(6));if(0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,t=this.input.readByte()):t=-1,this.validBits=0,a.b[0]=t,0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,e=this.input.readByte()):e=-1,this.validBits=0,a.b[1]=e,0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,i=this.input.readByte()):i=-1,this.validBits=0,a.b[2]=i,0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,n=this.input.readByte()):n=-1,this.validBits=0,a.b[3]=n,0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,r=this.input.readByte()):r=-1,this.validBits=0,a.b[4]=r,0!=this.bytesInSeg||!this.lastSeg&&0!=this.next()?(this.bytesInSeg--,this.inputPosition+=1,s=this.input.readByte()):s=-1,this.validBits=0,a.b[5]=s,"vorbis"!=a.toString())throw new M(new jt(Qt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}))},firstPageValidate:function(){if(1!=this.segments.length)throw new M(new jt(Qt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new M(new jt(Qt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},capturePattern:function(){var t,e,i;if(this.inputPosition+=1,79==this.input.readByte()?(this.inputPosition+=1,i=103!=this.input.readByte()):i=!0,i?e=!0:(this.inputPosition+=1,e=103!=this.input.readByte()),e?t=!0:(this.inputPosition+=1,t=83!=this.input.readByte()),t)throw new M(new jt(Qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}))},skip:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},decode:function(t){this.validBits<10&&this.prepHuffman();var e,i=t.fastHuffman[1023&this.acc];if(i>=0){var n=t.codewordLengths[i];this.acc=this.acc>>>n,this.validBits-=n,this.validBits<0?(this.validBits=0,e=-1):e=i}else e=this.decodeScalarRaw(t);return t.sparse&&(e=t.sortedValues[e]),e},decodeRaw:function(t){this.validBits<10&&this.prepHuffman();var e=t.fastHuffman[1023&this.acc];if(e>=0){var i=t.codewordLengths[e];return this.acc=this.acc>>>i,this.validBits-=i,this.validBits<0?(this.validBits=0,-1):e}return this.decodeScalarRaw(t)},isLastByte:function(){return 0==this.bytesInSeg&&this.lastSeg},finishDecodePacket:function(t,e,i){var n=i.left.start,r=!1,s=e>>1;if(this.firstDecode)this.currentLoc=-s,this.discardSamplesDeferred=e-i.right.end,r=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,n=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(r&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(e-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:n,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(s-i.left.start),r=!0}return r&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:n,right:i.right.start}},readInt32:function(){return this.inputPosition+=4,this.input.readInt32()},readByte:function(){return this.inputPosition+=1,this.input.readByte()},read:function(t){this.inputPosition+=t;for(var e=new Array(t),i=0,n=t;i<n;){e[i++]=this.input.readByte()}return e},readBytes:function(t){return this.inputPosition+=t,this.input.read(t)},readString:function(t){return this.inputPosition+=t,this.input.readString(t)},getSampleNumber:function(t,e){var i=this.inputPosition,n=p.gte(e,65536)&&p.gte(e-65536,this.firstAudioPageOffset)?e-65536:this.firstAudioPageOffset;t(this.inputPosition=n);var r=0,s=!1,a=this.findPage(t,e);switch(a._hx_index){case 0:var o=a.last;r=a.end,s=o;break;case 1:throw new M(new jt(Qt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;t:for(;!s;){t(this.inputPosition=r);var h=this.findPage(t,e);switch(h._hx_index){case 0:var u=h.last;r=h.end,s=u;break;case 1:break t}n=l+1,l=this.inputPosition}t(this.inputPosition=l),this.inputPosition+=6;for(var c=new Array(6),d=0;d<6;){c[d++]=this.input.readByte()}this.inputPosition+=4;var _=this.input.readInt32();this.inputPosition+=4;var f=this.input.readInt32();if(-1==_&&-1==f||f>0)throw new M(new jt(Qt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Zt,this.pLast.pageStart=l,this.pLast.pageEnd=r,this.pLast.lastDecodedSample=_,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=n,t(this.inputPosition=i),_},forcePageResync:function(){this.nextSeg=-1},setInputOffset:function(t,e){t(this.inputPosition=e)},findPage:function(t,e){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i,n,r=this.inputPosition;if(r-25>e)return Vt.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,n=103!=this.input.readByte()):n=!0,n?i=!0:(this.inputPosition+=1,i=83!=this.input.readByte()),i)continue;var s=new Array(27);if(s[0]=79,s[1]=103,s[2]=103,s[3]=83,this.inputPosition+=1,s[4]=this.input.readByte(),this.inputPosition+=1,s[5]=this.input.readByte(),this.inputPosition+=1,s[6]=this.input.readByte(),this.inputPosition+=1,s[7]=this.input.readByte(),this.inputPosition+=1,s[8]=this.input.readByte(),this.inputPosition+=1,s[9]=this.input.readByte(),this.inputPosition+=1,s[10]=this.input.readByte(),this.inputPosition+=1,s[11]=this.input.readByte(),this.inputPosition+=1,s[12]=this.input.readByte(),this.inputPosition+=1,s[13]=this.input.readByte(),this.inputPosition+=1,s[14]=this.input.readByte(),this.inputPosition+=1,s[15]=this.input.readByte(),this.inputPosition+=1,s[16]=this.input.readByte(),this.inputPosition+=1,s[17]=this.input.readByte(),this.inputPosition+=1,s[18]=this.input.readByte(),this.inputPosition+=1,s[19]=this.input.readByte(),this.inputPosition+=1,s[20]=this.input.readByte(),this.inputPosition+=1,s[21]=this.input.readByte(),this.inputPosition+=1,s[22]=this.input.readByte(),this.inputPosition+=1,s[23]=this.input.readByte(),this.inputPosition+=1,s[24]=this.input.readByte(),this.inputPosition+=1,s[25]=this.input.readByte(),this.inputPosition+=1,s[26]=this.input.readByte(),0!=s[4]){t(this.inputPosition=r);continue}var a=s[22]+(s[23]<<8)+(s[24]<<16)+(s[25]<<24);s[22]=0,s[23]=0,s[24]=0,s[25]=0;for(var o=0,l=0;l<27;){var h=l++;o=o<<8^It.table[s[h]^o>>>24]}var u=0;try{for(var c=0,d=s[26];c<d;){c++;this.inputPosition+=1;var _=this.input.readByte();o=o<<8^It.table[_^o>>>24],u+=_}for(var f=0,p=u;f<p;){f++;this.inputPosition+=1;var g=this.input.readByte();o=o<<8^It.table[g^o>>>24]}}catch(t){var v=t instanceof M?t.val:t;if(v instanceof N){return Vt.NotFound}throw t}if(o==a){var m=this.inputPosition;return t(this.inputPosition=r-1),Vt.Found(m,0!=(4&s[5]))}}}}catch(t){var w=t instanceof M?t.val:t;if(w instanceof N){return Vt.NotFound}throw t}},analyzePage:function(t,e){var i=new Zt,n=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var r=new Array(27),s=0;s<27;){r[s++]=this.input.readByte()}var a=r,o=a[26];this.inputPosition+=o;for(var l=new Array(o),h=0,u=o;h<u;){l[h++]=this.input.readByte()}for(var c=l,d=0,_=0,f=a[26];_<f;){d+=c[_++]}if(i.pageEnd=i.pageStart+27+a[26]+d,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,t(this.inputPosition=i.pageStart),i;for(var p=0,g=0==(1&a[5]),v=e.modes.length,m=0,w=a[26];m<w;){var b=m++;if(g){if(0==c[b])return t(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var S=this.input.readByte();if(0!=(1&S))return t(this.inputPosition=i.pageStart),null;S>>=1;var y=v-1,x=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if((S&=(1<<(y<16384?y<16?x[y]:y<512?5+x[y>>5]:10+x[y>>10]:y<16777216?y<524288?15+x[y>>15]:20+x[y>>20]:y<536870912?25+x[y>>25]:y<-2147483648?30+x[y>>30]:0))-1)>=v)return t(this.inputPosition=i.pageStart),null;n[p++]=e.modes[S].blockflag;var T=c[b]-1;this.inputPosition+=T;for(var E=new Array(T),k=0,C=T;k<C;){E[k++]=this.input.readByte()}}else{var I=c[b];this.inputPosition+=I;for(var B=new Array(I),L=0,A=I;L<A;){B[L++]=this.input.readByte()}}g=c[b]<255}var N=0;p>1&&(N+=n[p-1]?e.blocksize1:e.blocksize0);for(var V=p-2;V>=1;)n[--V]?n[V+1]?N+=e.blocksize1>>1:N+=(e.blocksize1-e.blocksize0>>2)+(e.blocksize0>>1):N+=e.blocksize0>>1,--V;return i.firstDecodedSample=i.lastDecodedSample-N,t(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(t){this.prepHuffman();var e=t.codewordLengths,i=t.codewords,n=t.sortedCodewords;if(t.entries>8?null!=n:null!=i){for(var r=this.acc,s=(r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8)>>>16|r<<16,a=0,o=t.sortedEntries;o>1;){var l=a+(o>>1);p.gte(s,n[l])?(a=l,o-=o>>1):o>>=1}t.sparse||(a=t.sortedValues[a]);var h=e[a];return this.validBits>=h?(this.acc=this.acc>>>h,this.validBits-=h,a):(this.validBits=0,-1)}for(var u=0,c=t.entries;u<c;){var d=u++,_=e[d];if(255!=_&&i[d]==(this.acc&(1<<_)-1))return this.validBits>=_?(this.acc=this.acc>>>_,this.validBits-=_,d):(this.validBits=0,-1)}return this.error=new jt(Qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:Nt};var Vt=s["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:(i=function(t,e){return{_hx_index:0,end:t,last:e,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:r}},i.__params__=["end","last"],i),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:r}},Rt=function(t,e){this.header=t,this.decodeState=e,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=new Array(t.channel);this.channelBuffers=i;var n=new Array(t.channel);this.previousWindow=n;var r=new Array(t.channel);this.finalY=r;for(var s=0,a=t.channel;s<a;){var o=s++,l=this.channelBuffers,h=new Array(t.blocksize1);l[o]=h;var u=this.previousWindow,c=new Array(t.blocksize1/2|0);u[o]=c,this.finalY[o]=[]}var d=new Array(2);this.a=d;var _=new Array(2);this.b=_;var f=new Array(2);this.c=f;var p=new Array(2);this.window=p;var g=new Array(2);this.bitReverseData=g,this.initBlocksize(0,t.blocksize0),this.initBlocksize(1,t.blocksize1)};n["kha.audio2.ogg.vorbis.VorbisDecoder"]=Rt,Rt.__name__=!0,Rt.start=function(t){var e=new Nt(t),i=Ut.read(e),n=new Rt(i,e);return e.startFirstDecode(),n.pumpFirstFrame(),n},Rt.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(t,e,i,n,r){var s=this.header.sampleRate;if(0!=(p.toFloat(n)%p.toFloat(s)|0))throw new M("Unsupported sampleRate : can't convert "+d.string(p.toFloat(this.header.sampleRate))+" to "+n);if(i%this.header.channel!=0)throw new M("Unsupported channels : can't convert "+this.header.channel+" to "+i);var a=this.header.sampleRate,o=p.toFloat(n)/p.toFloat(a)|0,l=i/this.header.channel|0,h=0,u=Math.floor(e/o);null!=this.totalSample&&u>this.totalSample-this.currentSample&&(u=this.totalSample-this.currentSample);for(var c=0;h<u;){var _=this.channelBufferEnd-this.channelBufferStart;_>=u-h&&(_=u-h);for(var f=this.channelBufferStart,g=this.channelBufferStart+_;f<g;)for(var v=f++,m=0,w=o;m<w;){m++;for(var b=0,S=this.header.channel;b<S;)for(var y=b++,x=0,T=l;x<T;){x++;var E=this.channelBuffers[y][v];E>1?E=1:E<-1&&(E=-1),r&&(t[c]=E,++c)}}if(h+=_,this.channelBufferStart+=_,h==u||0==this.getFrameFloat())break}for(var k=h,C=u;k<C;){k++;for(var I=0,B=o;I<B;){I++;for(var L=0,A=this.header.channel;L<A;){L++;for(var N=0,V=l;N<V;){N++;r&&(t[c]=0,++c)}}}}return this.currentSample+=u,u*o},skipSamples:function(t){var e=0;for(null!=this.totalSample&&t>this.totalSample-this.currentSample&&(t=this.totalSample-this.currentSample);e<t;){var i=this.channelBufferEnd-this.channelBufferStart;if(i>=t-e&&(i=t-e),e+=i,this.channelBufferStart+=i,e==t||0==this.getFrameFloat())break}return this.currentSample+=t,t},setupSampleNumber:function(t,e){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(t,e))},seek:function(t,e,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(t,e),0==this.totalSample))throw new M(new jt(Qt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var n=this.decodeState.pFirst,r=this.decodeState.pLast;if(i>=r.lastDecodedSample&&(i=r.lastDecodedSample-1),i<n.lastDecodedSample)this.seekFrameFromPage(t,n.pageStart,0,i);else{for(var s=0;n.pageEnd<r.pageStart;){var a=n.pageEnd,o=r.afterPreviousPageStart,l=n.lastDecodedSample,h=r.lastDecodedSample;if(null==l||null==h)throw new M(new jt(Qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));p.gt(o,a+4e3)&&(o-=4e3);var u=a+Math.floor(p.toFloat(o-a)/p.toFloat(h-l)*(i-l));if(s>=4){var c=a+(o-a>>>1);u=s>=8?c:p.gt(c,u)?u+(c-u>>>1):c+(u-c>>>1)}++s,t(this.decodeState.inputPosition=u);var d=this.decodeState.findPage(t,e);switch(d._hx_index){case 0:d.last,d.end;break;case 1:throw new M(new jt(Qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var _=this.decodeState.analyzePage(t,this.header);if(null==_)throw new M(new jt(Qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));_.afterPreviousPageStart=u,_.pageStart!=r.pageStart?i<_.lastDecodedSample?r=_:n=_:r=_}if(!(n.lastDecodedSample<=i&&i<r.lastDecodedSample))throw new M(new jt(Qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(t,r.pageStart,n.lastDecodedSample,i)}}},seekFrameFromPage:function(t,e,i,n){var r=0,s=i;t(this.decodeState.inputPosition=e),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,h=null;;){l=h,h=this.decodeState.clone(t);var u=this.decodeInitial();if(null==u){h=l;break}o=u.left.start,a=u.left.end;var c=0==r?a:o;if(n<s+u.right.start-c)break;for(var d=this.decodeState;0!=d.bytesInSeg||!d.lastSeg&&0!=d.next();)d.bytesInSeg--,d.inputPosition+=1,d.input.readByte();s+=u.right.start-c,++r}this.decodeState=h,t(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=s,this.skipSamples(n-s)},clone:function(t){var e=Object.create(Rt.prototype);e.currentSample=this.currentSample,e.totalSample=this.totalSample,e.previousLength=this.previousLength,e.channelBufferStart=this.channelBufferStart,e.channelBufferEnd=this.channelBufferEnd,e.a=this.a,e.b=this.b,e.c=this.c,e.window=this.window,e.bitReverseData=this.bitReverseData,e.header=this.header,e.decodeState=this.decodeState.clone(t);var i=new Array(this.header.channel);e.channelBuffers=i;var n=new Array(this.header.channel);e.previousWindow=n;var r=new Array(this.header.channel);e.finalY=r;for(var s=0,a=this.header.channel;s<a;){var o=s++;e.channelBuffers[o]=Pt.copyVector(this.channelBuffers[o]),e.previousWindow[o]=Pt.copyVector(this.previousWindow[o]),e.finalY[o]=h.array(this.finalY[o])}return e},ensurePosition:function(t){t(this.decodeState.inputPosition)},getFrameFloat:function(){var t=this.decodePacket();if(null==t)return this.channelBufferStart=this.channelBufferEnd=0,0;var e=this.finishFrame(t);return this.channelBufferStart=t.left,this.channelBufferEnd=t.left+e,e},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(t){var e=t.len,i=t.right,n=t.left;if(0!=this.previousLength)for(var r=this.previousLength,s=this.getWindow(r),a=0,o=this.header.channel;a<o;)for(var l=a++,h=this.channelBuffers[l],u=this.previousWindow[l],c=0,d=r;c<d;){var _=c++;h[n+_]=h[n+_]*s[_]+u[_]*s[r-1-_]}var f=this.previousLength;this.previousLength=e-i;for(var p=0,g=this.header.channel;p<g;)for(var v=p++,m=this.previousWindow[v],w=this.channelBuffers[v],b=0,S=e-i;b<S;){var y=b++;m[y]=w[i+y]}return 0==f?0:(e<i&&(i=e),i-n)},getWindow:function(t){return(t<<=1)==this.header.blocksize0?this.window[0]:t==this.header.blocksize1?this.window[1]:null},initBlocksize:function(t,e){var i=e>>1,n=e>>2,r=e>>3,s=this.a,a=new Array(i);s[t]=a;var o=this.b,l=new Array(i);o[t]=l;var h=this.c,u=new Array(n);h[t]=u;var c=this.window,d=new Array(i);c[t]=d;var _=this.bitReverseData,f=new Array(r);_[t]=f,Pt.computeTwiddleFactors(e,this.a[t],this.b[t],this.c[t]),Pt.computeWindow(e,this.window[t]),Pt.computeBitReverse(e,this.bitReverseData[t])},inverseMdct:function(t,e,i){for(var n=i?1:0,r=this.a[n],s=this.b[n],a=this.c[n],o=this.bitReverseData[n],l=e>>1,h=e>>2,u=e>>3,c=new Array(l),d=l-2,_=0,f=0,p=l;f!=p;)c[d+1]=t[f]*r[_]-t[f+2]*r[_+1],c[d]=t[f]*r[_+1]+t[f+2]*r[_],d-=2,_+=2,f+=4;for(f=l-3;d>=0;)c[d+1]=-t[f+2]*r[_]- -t[f]*r[_+1],c[d]=-t[f+2]*r[_+1]+-t[f]*r[_],d-=2,_+=2,f-=4;for(var g=t,v=c,m=l-8,w=h,b=0,S=h,y=0;m>=0;){var x=v[w+1]-v[b+1],T=v[w]-v[b];g[S+1]=v[w+1]+v[b+1],g[S]=v[w]+v[b],g[y+1]=x*r[m+4]-T*r[m+5],g[y]=T*r[m+4]+x*r[m+5],x=v[w+3]-v[b+3],T=v[w+2]-v[b+2],g[S+3]=v[w+3]+v[b+3],g[S+2]=v[w+2]+v[b+2],g[y+3]=x*r[m]-T*r[m+1],g[y+2]=T*r[m]+x*r[m+1],m-=8,S+=4,y+=4,w+=4,b+=4}for(var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=(e<16384?e<16?E[e]:e<512?5+E[e>>5]:10+E[e>>10]:e<16777216?e<524288?15+E[e>>15]:20+E[e>>20]:e<536870912?25+E[e>>25]:e<-2147483648?30+E[e>>30]:0)-1,C=l-1-0*h,I=C,B=C+-(e>>3),L=0,A=1+(e>>4>>2);--A>0;){var N=g[I]-g[B],V=g[I+-1]-g[B+-1],R=I,P=g;P[R]=P[R]+g[B];var M=I+-1,D=g;D[M]=D[M]+g[B+-1],g[B]=N*r[L]-V*r[L+1],g[B+-1]=V*r[L]+N*r[L+1],L+=8,N=g[I+-2]-g[B+-2],V=g[I+-3]-g[B+-3];var F=I+-2,O=g;O[F]=O[F]+g[B+-2];var W=I+-3,U=g;U[W]=U[W]+g[B+-3],g[B+-2]=N*r[L]-V*r[L+1],g[B+-3]=V*r[L]+N*r[L+1],L+=8,N=g[I+-4]-g[B+-4],V=g[I+-5]-g[B+-5];var H=I+-4,G=g;G[H]=G[H]+g[B+-4];var z=I+-5,Y=g;Y[z]=Y[z]+g[B+-5],g[B+-4]=N*r[L]-V*r[L+1],g[B+-5]=V*r[L]+N*r[L+1],L+=8,N=g[I+-6]-g[B+-6],V=g[I+-7]-g[B+-7];var X=I+-6,K=g;K[X]=K[X]+g[B+-6];var Z=I+-7,j=g;j[Z]=j[Z]+g[B+-7],g[B+-6]=N*r[L]-V*r[L+1],g[B+-7]=V*r[L]+N*r[L+1],L+=8,I-=8,B-=8}for(var Q=l-1-h,J=Q,q=Q+-(e>>3),$=0,tt=1+(e>>4>>2);--tt>0;){var et=g[J]-g[q],it=g[J+-1]-g[q+-1],nt=J,rt=g;rt[nt]=rt[nt]+g[q];var st=J+-1,at=g;at[st]=at[st]+g[q+-1],g[q]=et*r[$]-it*r[$+1],g[q+-1]=it*r[$]+et*r[$+1],$+=8,et=g[J+-2]-g[q+-2],it=g[J+-3]-g[q+-3];var ot=J+-2,lt=g;lt[ot]=lt[ot]+g[q+-2];var ht=J+-3,ut=g;ut[ht]=ut[ht]+g[q+-3],g[q+-2]=et*r[$]-it*r[$+1],g[q+-3]=it*r[$]+et*r[$+1],$+=8,et=g[J+-4]-g[q+-4],it=g[J+-5]-g[q+-5];var ct=J+-4,dt=g;dt[ct]=dt[ct]+g[q+-4];var _t=J+-5,ft=g;ft[_t]=ft[_t]+g[q+-5],g[q+-4]=et*r[$]-it*r[$+1],g[q+-5]=it*r[$]+et*r[$+1],$+=8,et=g[J+-6]-g[q+-6],it=g[J+-7]-g[q+-7];var pt=J+-6,gt=g;gt[pt]=gt[pt]+g[q+-6];var vt=J+-7,mt=g;mt[vt]=mt[vt]+g[q+-7],g[q+-6]=et*r[$]-it*r[$+1],g[q+-7]=it*r[$]+et*r[$+1],$+=8,J-=8,q-=8}for(var wt=l-1-0*u,bt=0,St=wt,yt=wt+-(e>>4),xt=1+(e>>5>>2);--xt>0;){var Tt=g[St]-g[yt],Et=g[St+-1]-g[yt+-1],kt=St,Ct=g;Ct[kt]=Ct[kt]+g[yt];var It=St+-1,Bt=g;Bt[It]=Bt[It]+g[yt+-1],g[yt]=Tt*r[bt]-Et*r[bt+1],g[yt+-1]=Et*r[bt]+Tt*r[bt+1],bt+=16,Tt=g[St+-2]-g[yt+-2],Et=g[St+-3]-g[yt+-3];var Lt=St+-2,At=g;At[Lt]=At[Lt]+g[yt+-2];var Nt=St+-3,Vt=g;Vt[Nt]=Vt[Nt]+g[yt+-3],g[yt+-2]=Tt*r[bt]-Et*r[bt+1],g[yt+-3]=Et*r[bt]+Tt*r[bt+1],bt+=16,Tt=g[St+-4]-g[yt+-4],Et=g[St+-5]-g[yt+-5];var Rt=St+-4,Pt=g;Pt[Rt]=Pt[Rt]+g[yt+-4];var Mt=St+-5,Dt=g;Dt[Mt]=Dt[Mt]+g[yt+-5],g[yt+-4]=Tt*r[bt]-Et*r[bt+1],g[yt+-5]=Et*r[bt]+Tt*r[bt+1],bt+=16,Tt=g[St+-6]-g[yt+-6],Et=g[St+-7]-g[yt+-7];var Ft=St+-6,Ot=g;Ot[Ft]=Ot[Ft]+g[yt+-6];var Wt=St+-7,Ut=g;Ut[Wt]=Ut[Wt]+g[yt+-7],g[yt+-6]=Tt*r[bt]-Et*r[bt+1],g[yt+-7]=Et*r[bt]+Tt*r[bt+1],St-=8,yt-=8,bt+=16}for(var Ht=l-1-u,Gt=0,zt=Ht,Yt=Ht+-(e>>4),Xt=1+(e>>5>>2);--Xt>0;){var Kt=g[zt]-g[Yt],Zt=g[zt+-1]-g[Yt+-1],jt=zt,Qt=g;Qt[jt]=Qt[jt]+g[Yt];var Jt=zt+-1,qt=g;qt[Jt]=qt[Jt]+g[Yt+-1],g[Yt]=Kt*r[Gt]-Zt*r[Gt+1],g[Yt+-1]=Zt*r[Gt]+Kt*r[Gt+1],Gt+=16,Kt=g[zt+-2]-g[Yt+-2],Zt=g[zt+-3]-g[Yt+-3];var $t=zt+-2,te=g;te[$t]=te[$t]+g[Yt+-2];var ee=zt+-3,ie=g;ie[ee]=ie[ee]+g[Yt+-3],g[Yt+-2]=Kt*r[Gt]-Zt*r[Gt+1],g[Yt+-3]=Zt*r[Gt]+Kt*r[Gt+1],Gt+=16,Kt=g[zt+-4]-g[Yt+-4],Zt=g[zt+-5]-g[Yt+-5];var ne=zt+-4,re=g;re[ne]=re[ne]+g[Yt+-4];var se=zt+-5,ae=g;ae[se]=ae[se]+g[Yt+-5],g[Yt+-4]=Kt*r[Gt]-Zt*r[Gt+1],g[Yt+-5]=Zt*r[Gt]+Kt*r[Gt+1],Gt+=16,Kt=g[zt+-6]-g[Yt+-6],Zt=g[zt+-7]-g[Yt+-7];var oe=zt+-6,le=g;le[oe]=le[oe]+g[Yt+-6];var he=zt+-7,ue=g;ue[he]=ue[he]+g[Yt+-7],g[Yt+-6]=Kt*r[Gt]-Zt*r[Gt+1],g[Yt+-7]=Zt*r[Gt]+Kt*r[Gt+1],zt-=8,Yt-=8,Gt+=16}for(var ce=l-1-2*u,de=0,_e=ce,fe=ce+-(e>>4),pe=1+(e>>5>>2);--pe>0;){var ge=g[_e]-g[fe],ve=g[_e+-1]-g[fe+-1],me=_e,we=g;we[me]=we[me]+g[fe];var be=_e+-1,Se=g;Se[be]=Se[be]+g[fe+-1],g[fe]=ge*r[de]-ve*r[de+1],g[fe+-1]=ve*r[de]+ge*r[de+1],de+=16,ge=g[_e+-2]-g[fe+-2],ve=g[_e+-3]-g[fe+-3];var ye=_e+-2,xe=g;xe[ye]=xe[ye]+g[fe+-2];var Te=_e+-3,Ee=g;Ee[Te]=Ee[Te]+g[fe+-3],g[fe+-2]=ge*r[de]-ve*r[de+1],g[fe+-3]=ve*r[de]+ge*r[de+1],de+=16,ge=g[_e+-4]-g[fe+-4],ve=g[_e+-5]-g[fe+-5];var ke=_e+-4,Ce=g;Ce[ke]=Ce[ke]+g[fe+-4];var Ie=_e+-5,Be=g;Be[Ie]=Be[Ie]+g[fe+-5],g[fe+-4]=ge*r[de]-ve*r[de+1],g[fe+-5]=ve*r[de]+ge*r[de+1],de+=16,ge=g[_e+-6]-g[fe+-6],ve=g[_e+-7]-g[fe+-7];var Le=_e+-6,Ae=g;Ae[Le]=Ae[Le]+g[fe+-6];var Ne=_e+-7,Ve=g;Ve[Ne]=Ve[Ne]+g[fe+-7],g[fe+-6]=ge*r[de]-ve*r[de+1],g[fe+-7]=ve*r[de]+ge*r[de+1],_e-=8,fe-=8,de+=16}for(var Re=l-1-3*u,Pe=0,Me=Re,De=Re+-(e>>4),Fe=1+(e>>5>>2);--Fe>0;){var Oe=g[Me]-g[De],We=g[Me+-1]-g[De+-1],Ue=Me,He=g;He[Ue]=He[Ue]+g[De];var Ge=Me+-1,ze=g;ze[Ge]=ze[Ge]+g[De+-1],g[De]=Oe*r[Pe]-We*r[Pe+1],g[De+-1]=We*r[Pe]+Oe*r[Pe+1],Pe+=16,Oe=g[Me+-2]-g[De+-2],We=g[Me+-3]-g[De+-3];var Ye=Me+-2,Xe=g;Xe[Ye]=Xe[Ye]+g[De+-2];var Ke=Me+-3,Ze=g;Ze[Ke]=Ze[Ke]+g[De+-3],g[De+-2]=Oe*r[Pe]-We*r[Pe+1],g[De+-3]=We*r[Pe]+Oe*r[Pe+1],Pe+=16,Oe=g[Me+-4]-g[De+-4],We=g[Me+-5]-g[De+-5];var je=Me+-4,Qe=g;Qe[je]=Qe[je]+g[De+-4];var Je=Me+-5,qe=g;qe[Je]=qe[Je]+g[De+-5],g[De+-4]=Oe*r[Pe]-We*r[Pe+1],g[De+-5]=We*r[Pe]+Oe*r[Pe+1],Pe+=16,Oe=g[Me+-6]-g[De+-6],We=g[Me+-7]-g[De+-7];var $e=Me+-6,ti=g;ti[$e]=ti[$e]+g[De+-6];var ei=Me+-7,ii=g;ii[ei]=ii[ei]+g[De+-7],g[De+-6]=Oe*r[Pe]-We*r[Pe+1],g[De+-7]=We*r[Pe]+Oe*r[Pe+1],Me-=8,De-=8,Pe+=16}for(var ni=2,ri=k-3>>1;ni<ri;)for(var si=ni++,ai=e>>si+2,oi=ai>>1,li=0,hi=1<<si+1;li<hi;)for(var ui=l-1-ai*li++,ci=1<<si+3,di=0,_i=ui,fi=ui+-oi,pi=1+(e>>si+4>>2);--pi>0;){var gi=g[_i]-g[fi],vi=g[_i+-1]-g[fi+-1],mi=_i,wi=g;wi[mi]=wi[mi]+g[fi];var bi=_i+-1,Si=g;Si[bi]=Si[bi]+g[fi+-1],g[fi]=gi*r[di]-vi*r[di+1],g[fi+-1]=vi*r[di]+gi*r[di+1],di+=ci,gi=g[_i+-2]-g[fi+-2],vi=g[_i+-3]-g[fi+-3];var yi=_i+-2,xi=g;xi[yi]=xi[yi]+g[fi+-2];var Ti=_i+-3,Ei=g;Ei[Ti]=Ei[Ti]+g[fi+-3],g[fi+-2]=gi*r[di]-vi*r[di+1],g[fi+-3]=vi*r[di]+gi*r[di+1],di+=ci,gi=g[_i+-4]-g[fi+-4],vi=g[_i+-5]-g[fi+-5];var ki=_i+-4,Ci=g;Ci[ki]=Ci[ki]+g[fi+-4];var Ii=_i+-5,Bi=g;Bi[Ii]=Bi[Ii]+g[fi+-5],g[fi+-4]=gi*r[di]-vi*r[di+1],g[fi+-5]=vi*r[di]+gi*r[di+1],di+=ci,gi=g[_i+-6]-g[fi+-6],vi=g[_i+-7]-g[fi+-7];var Li=_i+-6,Ai=g;Ai[Li]=Ai[Li]+g[fi+-6];var Ni=_i+-7,Vi=g;Vi[Ni]=Vi[Ni]+g[fi+-7],g[fi+-6]=gi*r[di]-vi*r[di+1],g[fi+-7]=vi*r[di]+gi*r[di+1],_i-=8,fi-=8,di+=ci}for(var Ri=k-3>>1,Pi=k-6;Ri<Pi;)for(var Mi=Ri++,Di=e>>Mi+2,Fi=1<<Mi+3,Oi=Di>>1,Wi=1<<Mi+1,Ui=0,Hi=l-1,Gi=(e>>Mi+6)+1;--Gi>0;){for(var zi=r[Ui],Yi=r[Ui+1],Xi=r[Ui+Fi],Ki=r[Ui+Fi+1],Zi=r[Ui+2*Fi],ji=r[Ui+2*Fi+1],Qi=r[Ui+3*Fi],Ji=r[Ui+3*Fi+1],qi=Hi,$i=Hi+-Oi,tn=Wi+1;--tn>0;){var en=g[qi]-g[$i],nn=g[qi+-1]-g[$i+-1];g[qi]=g[qi]+g[$i],g[qi+-1]=g[qi+-1]+g[$i+-1],g[$i]=en*zi-nn*Yi,g[$i+-1]=nn*zi+en*Yi,en=g[qi+-2]-g[$i+-2],nn=g[qi+-3]-g[$i+-3],g[qi+-2]=g[qi+-2]+g[$i+-2],g[qi+-3]=g[qi+-3]+g[$i+-3],g[$i+-2]=en*Xi-nn*Ki,g[$i+-3]=nn*Xi+en*Ki,en=g[qi+-4]-g[$i+-4],nn=g[qi+-5]-g[$i+-5],g[qi+-4]=g[qi+-4]+g[$i+-4],g[qi+-5]=g[qi+-5]+g[$i+-5],g[$i+-4]=en*Zi-nn*ji,g[$i+-5]=nn*Zi+en*ji,en=g[qi+-6]-g[$i+-6],nn=g[qi+-7]-g[$i+-7],g[qi+-6]=g[qi+-6]+g[$i+-6],g[qi+-7]=g[qi+-7]+g[$i+-7],g[$i+-6]=en*Qi-nn*Ji,g[$i+-7]=nn*Qi+en*Ji,qi-=Di,$i-=Di}Ui+=4*Fi,Hi-=8}for(var rn=l-1,sn=r[e>>3],an=rn,on=rn-16*(e>>5);an>on;){var ln=g[an],hn=g[an+-8];g[an+-8]=ln-hn,g[an]=ln+hn,ln=g[an+-1],hn=g[an+-9],g[an+-9]=ln-hn,g[an+-1]=ln+hn;var un=(ln=g[an+-2])-(hn=g[an+-10]);g[an+-2]=ln+hn;var cn=(ln=g[an+-3])-(hn=g[an+-11]);g[an+-3]=ln+hn,g[an+-10]=(un+cn)*sn,g[an+-11]=(cn-un)*sn,ln=g[an+-4],un=(hn=g[an+-12])-ln,g[an+-4]=ln+hn,cn=(ln=g[an+-5])-(hn=g[an+-13]),g[an+-5]=ln+hn,g[an+-12]=cn,g[an+-13]=un,ln=g[an+-6],un=(hn=g[an+-14])-ln,g[an+-6]=ln+hn,cn=(ln=g[an+-7])-(hn=g[an+-15]),g[an+-7]=ln+hn,g[an+-14]=(un+cn)*sn,g[an+-15]=(un-cn)*sn;var dn=g[an],_n=g[an+-4],fn=dn-_n,pn=dn+_n,gn=(dn=g[an+-2])+(_n=g[an+-6]),vn=dn-_n;g[an]=pn+gn,g[an+-2]=pn-gn;var mn=g[an+-3]-g[an+-7];g[an+-4]=fn+mn,g[an+-6]=fn-mn;var wn=(dn=g[an+-1])-(_n=g[an+-5]),bn=dn+_n,Sn=g[an+-3]+g[an+-7];g[an+-1]=bn+Sn,g[an+-3]=bn-Sn,g[an+-5]=wn-vn,g[an+-7]=wn+vn;var yn=an-8,xn=g[yn],Tn=g[yn+-4],En=xn-Tn,kn=xn+Tn,Cn=(xn=g[yn+-2])+(Tn=g[yn+-6]),In=xn-Tn;g[yn]=kn+Cn,g[yn+-2]=kn-Cn;var Bn=g[yn+-3]-g[yn+-7];g[yn+-4]=En+Bn,g[yn+-6]=En-Bn;var Ln=(xn=g[yn+-1])-(Tn=g[yn+-5]),An=xn+Tn,Nn=g[yn+-3]+g[yn+-7];g[yn+-1]=An+Nn,g[yn+-3]=An-Nn,g[yn+-5]=Ln-In,g[yn+-7]=Ln+In,an-=16}for(var Vn=0,Rn=h-4,Pn=l-4;Rn>=0;){var Mn=o[Vn];v[Pn+3]=g[Mn],v[Pn+2]=g[Mn+1],v[Rn+3]=g[Mn+2],v[Rn+2]=g[Mn+3],Mn=o[Vn+1],v[Pn+1]=g[Mn],v[Pn]=g[Mn+1],v[Rn+1]=g[Mn+2],v[Rn]=g[Mn+3],Rn-=4,Pn-=4,Vn+=2}for(var Dn=0,Fn=0,On=l-4;Fn<On;){var Wn=v[Fn]-v[On+2],Un=v[Fn+1]+v[On+3],Hn=a[Dn+1]*Wn+a[Dn]*Un,Gn=a[Dn+1]*Un-a[Dn]*Wn,zn=v[Fn]+v[On+2],Yn=v[Fn+1]-v[On+3];v[Fn]=zn+Hn,v[Fn+1]=Yn+Gn,v[On+2]=zn-Hn,v[On+3]=Gn-Yn,Wn=v[Fn+2]-v[On],Un=v[Fn+3]+v[On+1],Hn=a[Dn+3]*Wn+a[Dn+2]*Un,Gn=a[Dn+3]*Un-a[Dn+2]*Wn,zn=v[Fn+2]+v[On],Yn=v[Fn+3]-v[On+1],v[Fn+2]=zn+Hn,v[Fn+3]=Yn+Gn,v[On]=zn-Hn,v[On+1]=Gn-Yn,Dn+=4,Fn+=4,On-=4}for(var Xn=l-8,Kn=l-8,Zn=0,jn=l-4,Qn=l,Jn=e-4;Kn>=0;){var qn=c[Kn+6]*s[Xn+7]-c[Kn+7]*s[Xn+6],$n=-c[Kn+6]*s[Xn+6]-c[Kn+7]*s[Xn+7];t[Zn]=qn,t[jn+3]=-qn,t[Qn]=$n,t[Jn+3]=$n;var tr=c[Kn+4]*s[Xn+5]-c[Kn+5]*s[Xn+4],er=-c[Kn+4]*s[Xn+4]-c[Kn+5]*s[Xn+5];t[Zn+1]=tr,t[jn+2]=-tr,t[Qn+1]=er,t[Jn+2]=er,qn=c[Kn+2]*s[Xn+3]-c[Kn+3]*s[Xn+2],$n=-c[Kn+2]*s[Xn+2]-c[Kn+3]*s[Xn+3],t[Zn+2]=qn,t[jn+1]=-qn,t[Qn+2]=$n,t[Jn+1]=$n,tr=c[Kn]*s[Xn+1]-c[Kn+1]*s[Xn],er=-c[Kn]*s[Xn]-c[Kn+1]*s[Xn+1],t[Zn+3]=tr,t[jn]=-tr,t[Qn+3]=er,t[Jn]=er,Xn-=8,Kn-=8,Zn+=4,Qn+=4,jn-=4,Jn-=4}},decodePacket:function(){var t=this.decodeInitial();return null==t?null:this.decodePacketRest(t)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var t,e=this.decodeState;if(0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,t=e.input.readByte()):t=-1,e.validBits=0,-1==t)break}}var i=this.header.modes.length-1,n=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],r=this.decodeState.readBits(i<16384?i<16?n[i]:i<512?5+n[i>>5]:10+n[i>>10]:i<16777216?i<524288?15+n[i>>15]:20+n[i>>20]:i<536870912?25+n[i>>25]:i<-2147483648?30+n[i>>30]:0);if(-1==r||r>=this.header.modes.length)throw new M(new jt(Qt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var s,a,o,l=this.header.modes[r];l.blockflag?(s=this.header.blocksize1,a=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(a=o=0,s=this.header.blocksize0);var h=s>>1;return{mode:r,left:l.blockflag&&0==a?{start:s-this.header.blocksize0>>2,end:s+this.header.blocksize0>>2}:{start:0,end:h},right:l.blockflag&&0==o?{start:3*s-this.header.blocksize0>>2,end:3*s+this.header.blocksize0>>2}:{start:h,end:s}}},decodePacketRest:function(t){for(var e=this.header.modes[t.mode],i=new Array(256),n=new Array(256),r=e.blockflag?this.header.blocksize1:this.header.blocksize0,s=this.header.mapping[e.mapping],a=r>>1,o=[256,128,86,64],l=this.header.codebooks,h=0,u=this.header.channel;h<u;){var c=h++,d=s.chan[c].mux;i[c]=!1;var _=this.header.floorConfig[s.submapFloor[d]];if(0==_.type)throw new M(new jt(Qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var f=_.floor1;if(0!=this.decodeState.readBits(1)){var p=[],g=new Array(256),v=o[f.floor1Multiplier-1],m=2,w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(p=this.finalY[c])[0]=this.decodeState.readBits((v<16384?v<16?w[v]:v<512?5+w[v>>5]:10+w[v>>10]:v<16777216?v<524288?15+w[v>>15]:20+w[v>>20]:v<536870912?25+w[v>>25]:v<-2147483648?30+w[v>>30]:0)-1);var b=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];p[1]=this.decodeState.readBits((v<16384?v<16?b[v]:v<512?5+b[v>>5]:10+b[v>>10]:v<16777216?v<524288?15+b[v>>15]:20+b[v>>20]:v<536870912?25+b[v>>25]:v<-2147483648?30+b[v>>30]:0)-1);for(var S=0,y=f.partitions;S<y;){var x=S++,T=f.partitionClassList[x],E=f.classDimensions[T],k=f.classSubclasses[T],C=(1<<k)-1,I=0;if(0!=k){var B=l[f.classMasterbooks[T]],L=this.decodeState;L.validBits<10&&L.prepHuffman();var A,N=B.fastHuffman[1023&L.acc];if(N>=0){var V=B.codewordLengths[N];L.acc=L.acc>>>V,L.validBits-=V,L.validBits<0?(L.validBits=0,A=-1):A=N}else A=L.decodeScalarRaw(B);B.sparse&&(A=B.sortedValues[A]),I=A}for(var R=f.subclassBooks[T],P=0,D=E;P<D;){P++;var F=R[I&C];I>>=k;var O,W=m++;if(F>=0){var U=this.decodeState,H=l[F];U.validBits<10&&U.prepHuffman();var G,z=H.fastHuffman[1023&U.acc];if(z>=0){var Y=H.codewordLengths[z];U.acc=U.acc>>>Y,U.validBits-=Y,U.validBits<0?(U.validBits=0,G=-1):G=z}else G=U.decodeScalarRaw(H);H.sparse&&(G=H.sortedValues[G]),O=G}else O=0;p[W]=O}}if(-1==this.decodeState.validBits){i[c]=!0;continue}g[0]=g[1]=!0;for(var X=f.neighbors,K=f.xlist,Z=2,j=f.values;Z<j;){var Q=Z++,J=X[Q][0],q=X[Q][1],$=K[J],tt=p[J],et=p[q]-tt,it=K[q]-$,nt=Math.abs(et)*(K[Q]-$)/it|0,rt=et<0?tt-nt:tt+nt,st=p[Q],at=v-rt,ot=at<rt?2*at:2*rt;0!=st?(g[J]=g[q]=!0,g[Q]=!0,p[Q]=st>=ot?at>rt?st-rt+rt:rt-st+at-1:0!=(1&st)?rt-(st+1>>1):rt+(st>>1)):(g[Q]=!1,p[Q]=rt)}for(var lt=0,ht=f.values;lt<ht;){var ut=lt++;g[ut]||(p[ut]=-1)}}else i[c]=!0}for(var ct=0,dt=this.header.channel;ct<dt;){var _t=ct++;n[_t]=i[_t]}for(var ft=0,pt=s.couplingSteps;ft<pt;){var gt=ft++;i[s.chan[gt].magnitude]&&i[s.chan[gt].angle]||(i[s.chan[gt].magnitude]=i[s.chan[gt].angle]=!1)}for(var vt=0,mt=s.submaps;vt<mt;){for(var wt=vt++,bt=new Array(this.header.channel),St=new Array(256),yt=0,xt=0,Tt=this.header.channel;xt<Tt;){var Et=xt++;s.chan[Et].mux==wt&&(i[Et]?(St[yt]=!0,bt[yt]=null):(St[yt]=!1,bt[yt]=this.channelBuffers[Et]),++yt)}var kt=s.submapResidue[wt];this.header.residueConfig[kt].decode(this.decodeState,this.header,bt,yt,a,St,this.channelBuffers)}for(var Ct=s.couplingSteps,It=r>>1;--Ct>=0;)for(var Bt=this.channelBuffers[s.chan[Ct].magnitude],Lt=this.channelBuffers[s.chan[Ct].angle],At=0,Nt=It;At<Nt;){var Vt,Rt,Pt=At++;Bt[Pt]>0?Lt[Pt]>0?(Rt=Bt[Pt],Vt=Bt[Pt]-Lt[Pt]):(Vt=Bt[Pt],Rt=Bt[Pt]+Lt[Pt]):Lt[Pt]>0?(Rt=Bt[Pt],Vt=Bt[Pt]+Lt[Pt]):(Vt=Bt[Pt],Rt=Bt[Pt]-Lt[Pt]),Bt[Pt]=Rt,Lt[Pt]=Vt}for(var Mt=0,Dt=this.header.channel;Mt<Dt;){var Ft=Mt++;if(n[Ft])for(var Ot=0,Wt=It;Ot<Wt;){var Ut=Ot++;this.channelBuffers[Ft][Ut]=0}else s.doFloor(this.header.floorConfig,Ft,r,this.channelBuffers[Ft],this.finalY[Ft],null)}for(var Ht=0,Gt=this.header.channel;Ht<Gt;){var zt=Ht++;this.inverseMdct(this.channelBuffers[zt],r,e.blockflag)}for(var Yt=this.decodeState;0!=Yt.bytesInSeg||!Yt.lastSeg&&0!=Yt.next();)Yt.bytesInSeg--,Yt.inputPosition+=1,Yt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,r,t)},__class__:Rt};var Pt=function(){};n["kha.audio2.ogg.vorbis.VorbisTools"]=Pt,Pt.__name__=!0,Pt.assert=function(t,e){},Pt.neighbors=function(t,e){for(var i=-1,n=65536,r=0,s=0,a=0,o=e;a<o;){var l=a++;t[l]>i&&t[l]<t[e]&&(r=l,i=t[l]),t[l]<n&&t[l]>t[e]&&(s=l,n=t[l])}return{low:r,high:s}},Pt.floatUnpack=function(t){var e=p.toFloat(2097151&t),i=(2145386496&t)>>>21;return(0!=(-2147483648&t)?-e:e)*Math.pow(2,i-788)},Pt.bitReverse=function(t){return(t=(-16711936&(t=(-252645136&(t=(-858993460&(t=(-1431655766&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8)>>>16|t<<16},Pt.pointCompare=function(t,e){return t.x<e.x?-1:t.x>e.x?1:0},Pt.uintAsc=function(t,e){return p.gt(e,t)?-1:t==e?0:1},Pt.lookup1Values=function(t,e){var i=0|Math.exp(Math.log(t)/e);return(0|Math.pow(i+1,e))<=t&&++i,i},Pt.computeWindow=function(t,e){for(var i=t>>1,n=0,r=i;n<r;){var s=n++;e[s]=Math.sin(1.5707963267948966*Pt.square(Math.sin((s+.5)/i*.5*3.141592653589793)))}},Pt.square=function(t){return t*t},Pt.computeBitReverse=function(t,e){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=(t<16384?t<16?i[t]:t<512?5+i[t>>5]:10+i[t>>10]:t<16777216?t<524288?15+i[t>>15]:20+i[t>>20]:t<536870912?25+i[t>>25]:t<-2147483648?30+i[t>>30]:0)-1,r=0,s=t>>3;r<s;){var a=r++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e[a]=(o>>>16|o<<16)>>>32-n+3<<2}},Pt.computeTwiddleFactors=function(t,e,i,n){for(var r=t>>3,s=0,a=0,o=t>>2;a<o;){var l=a++;e[s]=Math.cos(4*l*3.141592653589793/t),e[s+1]=-Math.sin(4*l*3.141592653589793/t),i[s]=.5*Math.cos(3.141592653589793*(s+1)/t/2),i[s+1]=.5*Math.sin(3.141592653589793*(s+1)/t/2),s+=2}for(var h=0,u=0,c=r;u<c;){u++;n[h]=Math.cos(2*(h+1)*3.141592653589793/t),n[h+1]=-Math.sin(2*(h+1)*3.141592653589793/t),h+=2}},Pt.drawLine=function(t,e,i,n,r,s){if(null==Pt.integerDivideTable){var a=new Array(32);Pt.integerDivideTable=a;for(var o=0;o<32;){var l=o++,h=Pt.integerDivideTable,u=new Array(64);h[l]=u;for(var c=1;c<64;){var d=c++;Pt.integerDivideTable[l][d]=l/d|0}}}var _,f,p=r-i,g=n-e,v=p<0?-p:p,m=e,w=i,b=0;g<64&&v<32?f=p<0?(_=-Pt.integerDivideTable[v][g])-1:(_=Pt.integerDivideTable[v][g])+1:(_=p/g|0,f=p<0?_-1:_+1),v-=(_<0?-_:_)*g,n>s&&(n=s);var S=m,y=t;y[S]=y[S]*Pt.INVERSE_DB_TABLE[w];for(var x=m+1,T=n;x<T;){(b+=v)>=g?(b-=g,w+=f):w+=_;var E=x++,k=t;k[E]=k[E]*Pt.INVERSE_DB_TABLE[w]}},Pt.predictPoint=function(t,e,i,n,r){var s=r-n,a=i-e,o=Math.abs(s)*(t-e)/a|0;return s<0?n-o:n+o},Pt.emptyFloatVector=function(t){return new Array(t)},Pt.copyVector=function(t){for(var e=new Array(t.length),i=0,n=t.length;i<n;){var r=i++;e[r]=t[r]}return e};var Mt=function(){};n["kha.audio2.ogg.vorbis.data.Codebook"]=Mt,Mt.__name__=!0,Mt.read=function(t){var e=new Mt;if(66!=t.readBits(8)||67!=t.readBits(8)||86!=t.readBits(8))throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var i=t.readBits(8);e.dimensions=(t.readBits(8)<<8)+i;var n=t.readBits(8),r=t.readBits(8);e.entries=(t.readBits(8)<<16)+(r<<8)+n;var s=t.readBits(1);e.sparse=0==s&&0!=t.readBits(1);var a=new Array(e.entries);e.sparse||(e.codewordLengths=a);var o,l=0;if(0!=s)for(var h=0,u=t.readBits(5)+1;h<e.entries;){var c=e.entries-h,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],_=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0);if(h+_>e.entries)throw new M(new jt(Qt.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var f=0,g=_;f<g;){a[h+f++]=u}h+=_,++u}else for(var v=0,m=e.entries;v<m;){var w=v++;0!=(e.sparse?t.readBits(1):1)?(a[w]=t.readBits(5)+1,++l):a[w]=255}if(e.sparse&&l>=e.entries>>2&&(e.codewordLengths=a,e.sparse=!1),e.sparse)o=l;else{for(var b=0,S=0,y=e.entries;S<y;){var x=a[S++];x>10&&255!=x&&++b}o=b}e.sortedEntries=o;var T=null;if(e.sparse){if(0!=e.sortedEntries){var E=new Array(e.sortedEntries);e.codewordLengths=E;var k=new Array(e.entries);e.codewords=k,T=new Array(e.entries)}e.entries,e.sortedEntries}else{var C=new Array(e.entries);e.codewords=C}if(!e.computeCodewords(a,e.entries,T))throw new M(new jt(Qt.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=e.sortedEntries){e.sortedCodewords=[];var I=new Array(e.sortedEntries);e.sortedValues=I,e.computeSortedHuffman(a,T)}if(e.sparse&&(T=null,e.codewords=null,a=null),e.computeAcceleratedHuffman(),e.lookupType=t.readBits(4),e.lookupType>2)throw new M(new jt(Qt.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(e.lookupType>0){var B=t.readBits(32),L=p.toFloat(2097151&B),A=(2145386496&B)>>>21,N=0!=(-2147483648&B)?-L:L;e.minimumValue=N*Math.pow(2,A-788);var V=t.readBits(32),R=p.toFloat(2097151&V),P=(2145386496&V)>>>21,D=0!=(-2147483648&V)?-R:R;e.deltaValue=D*Math.pow(2,P-788),e.valueBits=t.readBits(4)+1,e.sequenceP=0!=t.readBits(1),1==e.lookupType?e.lookupValues=Pt.lookup1Values(e.entries,e.dimensions):e.lookupValues=e.entries*e.dimensions;for(var F=new Array(e.lookupValues),O=0,W=e.lookupValues;O<W;){var U=O++,H=t.readBits(e.valueBits);if(-1==H)throw new M(new jt(Qt.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));F[U]=H}var G=new Array(e.lookupValues);e.multiplicands=G;for(var z=0,Y=e.lookupValues;z<Y;){var X=z++;e.multiplicands[X]=F[X]*e.deltaValue+e.minimumValue}if(2==e.lookupType&&e.sequenceP){for(var K=1,Z=e.lookupValues;K<Z;){var j=K++;e.multiplicands[j]=e.multiplicands[j-1]}e.sequenceP=!1}}return e},Mt.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,addEntry:function(t,e,i,n,r){this.sparse?(this.codewords[i]=t,this.codewordLengths[i]=n,r[i]=e):this.codewords[e]=t},includeInSort:function(t){return!!this.sparse||255!=t&&t>10},computeCodewords:function(t,e,i){var n=new Array(32);n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=0,n[16]=0,n[17]=0,n[18]=0,n[19]=0,n[20]=0,n[21]=0,n[22]=0,n[23]=0,n[24]=0,n[25]=0,n[26]=0,n[27]=0,n[28]=0,n[29]=0,n[30]=0,n[31]=0;for(var r=0;r<e&&!(t[r]<255);)++r;if(r==e)return!0;var s=0,a=s++;this.sparse?(this.codewords[a]=0,this.codewordLengths[a]=t[r],i[a]=r):this.codewords[r]=0;for(var o=0;++o<=t[r];)n[o]=1<<32-o;for(o=r;++o<e;){var l=t[o];if(255!=l){for(;l>0&&0==n[l];)--l;if(0==l)return!1;var h=n[l];n[l]=0;var u=h,c=(u=(-16711936&(u=(-252645136&(u=(-858993460&(u=(-1431655766&u)>>>1|(1431655765&u)<<1))>>>2|(858993459&u)<<2))>>>4|(252645135&u)<<4))>>>8|(16711935&u)<<8)>>>16|u<<16,d=s++;if(this.sparse?(this.codewords[d]=c,this.codewordLengths[d]=t[o],i[d]=o):this.codewords[o]=c,l!=t[o])for(var _=t[o];_>l;)n[_]=h+(1<<32-_),--_}}return!0},computeSortedHuffman:function(t,e){if(this.sparse)for(var i=0,n=this.sortedEntries;i<n;){var r=i++,s=this.codewords[r];s=(-16711936&(s=(-252645136&(s=(-858993460&(s=(-1431655766&s)>>>1|(1431655765&s)<<1))>>>2|(858993459&s)<<2))>>>4|(252645135&s)<<4))>>>8|(16711935&s)<<8,this.sortedCodewords[r]=s>>>16|s<<16}else for(var a=0,o=0,l=this.entries;o<l;){var h=o++,u=t[h];if(this.sparse||255!=u&&u>10){var c=this.codewords[h];c=(-16711936&(c=(-252645136&(c=(-858993460&(c=(-1431655766&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,this.sortedCodewords[a++]=c>>>16|c<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(Pt.uintAsc);for(var d=0,_=this.sparse?this.sortedEntries:this.entries;d<_;){var f=d++,g=this.sparse?t[e[f]]:t[f];if(this.sparse||255!=g&&g>10){for(var v=this.codewords[f],m=(v=(-16711936&(v=(-252645136&(v=(-858993460&(v=(-1431655766&v)>>>1|(1431655765&v)<<1))>>>2|(858993459&v)<<2))>>>4|(252645135&v)<<4))>>>8|(16711935&v)<<8)>>>16|v<<16,w=0,b=this.sortedEntries;b>1;){var S=w+(b>>1);p.gte(m,this.sortedCodewords[S])?(w=S,b-=b>>1):b>>=1}this.sparse?(this.sortedValues[w]=e[f],this.codewordLengths[w]=g):this.sortedValues[w]=f}}},computeAcceleratedHuffman:function(){var t=new Array(1024);this.fastHuffman=t,this.fastHuffman[0]=-1;for(var e=0;e<1024;){var i=e++;this.fastHuffman[i]=-1}for(var n=0,r=this.sparse?this.sortedEntries:this.entries;n<r;){var s=n++;if(this.codewordLengths[s]<=10){var a;if(this.sparse){var o=this.sortedCodewords[s];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[s];for(;a<1024;)this.fastHuffman[a]=s,a+=1<<this.codewordLengths[s]}}},codebookDecode:function(t,e,i,n){t.validBits<10&&t.prepHuffman();var r,s=this.fastHuffman[1023&t.acc];if(s>=0){var a=this.codewordLengths[s];t.acc=t.acc>>>a,t.validBits-=a,t.validBits<0?(t.validBits=0,r=-1):r=s}else r=t.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var o=r,l=this.lookupValues,h=this.sequenceP,u=this.multiplicands,c=this.minimumValue;if(o<0)return!1;if(n>this.dimensions&&(n=this.dimensions),1==this.lookupType){for(var d=1,_=0,f=0,g=n;f<g;){var v=f++,m=u[p.toFloat(o/d|0)%p.toFloat(l)|0]+_,w=i+v,b=e;b[w]=b[w]+m,h&&(_=m+c),d*=l}return!0}if(o*=this.dimensions,h)for(var S=0,y=0,x=n;y<x;){var T=y++,E=u[o+T]+S,k=i+T,C=e;C[k]=C[k]+E,S=E+c}else for(var I=0,B=n;I<B;){var L=I++,A=i+L,N=e;N[A]=N[A]+(u[o+L]+0)}return!0},codebookDecodeStep:function(t,e,i,n,r){t.validBits<10&&t.prepHuffman();var s,a=this.fastHuffman[1023&t.acc];if(a>=0){var o=this.codewordLengths[a];t.acc=t.acc>>>o,t.validBits-=o,t.validBits<0?(t.validBits=0,s=-1):s=a}else s=t.decodeScalarRaw(this);this.sparse&&(s=this.sortedValues[s]);var l=s,h=0;if(l<0)return!1;n>this.dimensions&&(n=this.dimensions);var u=this.lookupValues,c=this.sequenceP,d=this.multiplicands;if(1==this.lookupType){for(var _=1,f=0,g=n;f<g;){var v=f++,m=d[p.toFloat(l/_|0)%p.toFloat(u)|0]+h,w=i+v*r,b=e;b[w]=b[w]+m,c&&(h=m),_*=u}return!0}l*=this.dimensions;for(var S=0,y=n;S<y;){var x=S++,T=d[l+x]+h,E=i+x*r,k=e;k[E]=k[E]+T,c&&(h=T)}return!0},decodeStart:function(t){t.validBits<10&&t.prepHuffman();var e,i=this.fastHuffman[1023&t.acc];if(i>=0){var n=this.codewordLengths[i];t.acc=t.acc>>>n,t.validBits-=n,t.validBits<0?(t.validBits=0,e=-1):e=i}else e=t.decodeScalarRaw(this);return this.sparse&&(e=this.sortedValues[e]),e},decodeDeinterleaveRepeat:function(t,e,i,n,r,s,a){var o=this.dimensions;if(0==this.lookupType)throw new M(new jt(Qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,h=this.sequenceP,u=this.lookupValues;a>0;){var c=0;t.validBits<10&&t.prepHuffman();var d,_=this.fastHuffman[1023&t.acc];if(_>=0){var f=this.codewordLengths[_];t.acc=t.acc>>>f,t.validBits-=f,t.validBits<0?(t.validBits=0,d=-1):d=_}else d=t.decodeScalarRaw(this);this.sparse&&(d=this.sortedValues[d]);var g=d;if(g<0){if(0==t.bytesInSeg&&t.lastSeg)return null;throw new M(new jt(Qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(n+r*i+o>s*i&&(o=s*i-(r*i-n)),1==this.lookupType){var v=1;if(h)for(var m=0,w=o;m<w;){m++;var b=l[p.toFloat(g/v|0)%p.toFloat(u)|0]+c,S=r,y=e[n];y[S]=y[S]+b,++n==i&&(n=0,++r),c=b,v*=u}else for(var x=0,T=o;x<T;){x++;var E=l[p.toFloat(g/v|0)%p.toFloat(u)|0]+c,k=r,C=e[n];C[k]=C[k]+E,++n==i&&(n=0,++r),v*=u}}else if(g*=this.dimensions,h)for(var I=0,B=o;I<B;){var L=l[g+I++]+c,A=r,N=e[n];N[A]=N[A]+L,++n==i&&(n=0,++r),c=L}else for(var V=0,R=o;V<R;){var P=l[g+V++]+c,D=r,F=e[n];F[D]=F[D]+P,++n==i&&(n=0,++r)}a-=o}return{cInter:n,pInter:r}},residueDecode:function(t,e,i,n,r){if(0==r)for(var s=n/this.dimensions|0,a=0,o=s;a<o;){var l=a++;if(!this.codebookDecodeStep(t,e,i+l,n-i-l,s))return!1}else for(var h=0;h<n;){if(!this.codebookDecode(t,e,i,n-h))return!1;h+=this.dimensions,i+=this.dimensions}return!0},__class__:Mt};var Dt=function(){this.data=new T};n["kha.audio2.ogg.vorbis.data.Comment"]=Dt,Dt.__name__=!0,Dt.prototype={data:null,get_title:function(){return this.getString("title")},get_loopStart:function(){return d.parseInt(this.getString("loopstart"))},get_loopLength:function(){return d.parseInt(this.getString("looplength"))},get_version:function(){return this.getString("version")},get_album:function(){return this.getString("album")},get_organization:function(){return this.getString("organization")},get_tracknumber:function(){return this.getString("tracknumber")},get_performer:function(){return this.getString("performer")},get_copyright:function(){return this.getString("copyright")},get_license:function(){return this.getString("license")},get_artist:function(){return this.getString("artist")},get_description:function(){return this.getString("description")},get_genre:function(){return this.getString("genre")},get_date:function(){return this.getString("date")},get_location:function(){return this.getString("location")},get_contact:function(){return this.getString("contact")},get_isrc:function(){return this.getString("isrc")},get_artists:function(){return this.getArray("artist")},add:function(t,e){t=t.toLowerCase();var i=this.data;if(null!=Ai[t]?i.existsReserved(t):i.h.hasOwnProperty(t)){var n=this.data;(null!=Ai[t]?n.getReserved(t):n.h[t]).push(e)}else{var r=[e],s=this.data;null!=Ai[t]?s.setReserved(t,r):s.h[t]=r}},getString:function(t){t=t.toLowerCase();var e=this.data;if(null!=Ai[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return(null!=Ai[t]?i.getReserved(t):i.h[t])[0]}return null},getArray:function(t){t=t.toLowerCase();var e=this.data;if(null!=Ai[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return null!=Ai[t]?i.getReserved(t):i.h[t]}return null},__class__:Dt};var Ft=function(){};n["kha.audio2.ogg.vorbis.data.Floor"]=Ft,Ft.__name__=!0,Ft.read=function(t,e){var i=new Ft;if(i.type=t.readBits(16),i.type>1)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var n=i.floor0=new Ot;n.order=t.readBits(8),n.rate=t.readBits(16),n.barkMapSize=t.readBits(16),n.amplitudeBits=t.readBits(6),n.amplitudeOffset=t.readBits(8),n.numberOfBooks=t.readBits(4)+1;for(var r=0,s=n.numberOfBooks;r<s;){var a=r++;n.bookList[a]=t.readBits(8)}throw new M(new jt(Qt.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=i.floor1=new Wt,h=-1;l.partitions=t.readBits(5);var u=new Array(l.partitions);l.partitionClassList=u;for(var c=0,d=l.partitions;c<d;){var _=c++;l.partitionClassList[_]=t.readBits(4),l.partitionClassList[_]>h&&(h=l.partitionClassList[_])}var f=new Array(h+1);l.classDimensions=f;var p=new Array(h+1);l.classMasterbooks=p;var g=new Array(h+1);l.classSubclasses=g;var v=new Array(h+1);l.subclassBooks=v;for(var m=0,w=h+1;m<w;){var b=m++;if(l.classDimensions[b]=t.readBits(3)+1,l.classSubclasses[b]=t.readBits(2),0!=l.classSubclasses[b]&&(l.classMasterbooks[b]=t.readBits(8),l.classMasterbooks[b]>=e.length))throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var S=1<<l.classSubclasses[b],y=l.subclassBooks,x=new Array(S);y[b]=x;for(var T=0,E=S;T<E;){var k=T++;if(l.subclassBooks[b][k]=t.readBits(8)-1,l.subclassBooks[b][k]>=e.length)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=t.readBits(2)+1,l.rangebits=t.readBits(4);var C=new Array(250);l.xlist=C,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var I=0,B=l.partitions;I<B;)for(var L=I++,A=l.partitionClassList[L],N=0,V=l.classDimensions[A];N<V;){N++;l.xlist[l.values]=t.readBits(l.rangebits),l.values++}for(var R=0,P=l.values;R<P;){var D=R++;o.push(new Ht),o[D].x=l.xlist[D],o[D].y=D}o.sort(Pt.pointCompare);var F=new Array(l.values);l.sortedOrder=F;for(var O=0,W=l.values;O<W;){var U=O++;l.sortedOrder[U]=o[U].y}var H=new Array(l.values);l.neighbors=H;for(var G=2,z=l.values;G<z;){for(var Y=G++,X=l.xlist,K=-1,Z=65536,j=0,Q=0,J=0,q=Y;J<q;){var $=J++;X[$]>K&&X[$]<X[Y]&&(j=$,K=X[$]),X[$]<Z&&X[$]>X[Y]&&(Q=$,Z=X[$])}var tt=j,et=Q,it=l.neighbors,nt=new Array(l.values);it[Y]=nt,l.neighbors[Y][0]=tt,l.neighbors[Y][1]=et}return i},Ft.prototype={floor0:null,floor1:null,type:null,__class__:Ft};var Ot=function(){};n["kha.audio2.ogg.vorbis.data.Floor0"]=Ot,Ot.__name__=!0,Ot.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:Ot};var Wt=function(){};n["kha.audio2.ogg.vorbis.data.Floor1"]=Wt,Wt.__name__=!0,Wt.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Wt};var Ut=function(){};n["kha.audio2.ogg.vorbis.data.Header"]=Ut,Ut.__name__=!0,Ut.read=function(t){var e=t.page;if(e.start(t),0==(2&e.flag))throw new M(new jt(Qt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&e.flag))throw new M(new jt(Qt.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&e.flag))throw new M(new jt(Qt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.firstPageValidate(),t.inputPosition+=1,1!=t.input.readByte())throw new M(new jt(Qt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var i,n,r,s,a,o,l=new E(new ArrayBuffer(6));if(0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,i=t.input.readByte()):i=-1,t.validBits=0,l.b[0]=i,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,n=t.input.readByte()):n=-1,t.validBits=0,l.b[1]=n,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,r=t.input.readByte()):r=-1,t.validBits=0,l.b[2]=r,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,s=t.input.readByte()):s=-1,t.validBits=0,l.b[3]=s,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,a=t.input.readByte()):a=-1,t.validBits=0,l.b[4]=a,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,o=t.input.readByte()):o=-1,t.validBits=0,l.b[5]=o,"vorbis"!=l.toString())throw new M(new jt(Qt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));t.inputPosition+=4;var h=t.input.readInt32();if(0!=h)throw new M(new jt(Qt.INVALID_FIRST_PAGE,"vorbis version : "+h,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var u=new Ut;if(t.inputPosition+=1,u.channel=t.input.readByte(),0==u.channel)throw new M(new jt(Qt.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(u.channel>16)throw new M(new jt(Qt.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.inputPosition+=4,u.sampleRate=t.input.readInt32(),0==u.sampleRate)throw new M(new jt(Qt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=4,u.maximumBitRate=t.input.readInt32(),t.inputPosition+=4,u.nominalBitRate=t.input.readInt32(),t.inputPosition+=4,u.minimumBitRate=t.input.readInt32(),t.inputPosition+=1;var c=t.input.readByte(),d=15&c,_=c>>4;if(u.blocksize0=1<<d,u.blocksize1=1<<_,d<6||d>13)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<6||_>13)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(d>_)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=1;var f=t.input.readByte();if(0==(1&f))throw new M(new jt(Qt.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.page.start(t),t.startPacket();for(var p=0,g=new L;0!=(p=t.next());)t.inputPosition+=p,g.write(t.input.read(p)),t.bytesInSeg=0;var v=new I(g.getBytes());v.readByte(),v.read(6);var m,w=v.readInt32();u.vendor=v.readString(w),u.comment=new Dt;for(var b=0,S=v.readInt32();b<S;){b++;var y=v.readInt32(),x=v.readString(y),T=x.indexOf("=");-1!=T&&u.comment.add(x.substring(0,T),x.substring(T+1))}if(0==(1&v.readByte()))throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.startPacket(),0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,m=t.input.readByte()):m=-1,t.validBits=0,5!=m)throw new M(new jt(Qt.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var k,C,B,A,N,V,R=new E(new ArrayBuffer(6));if(0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,k=t.input.readByte()):k=-1,t.validBits=0,R.b[0]=k,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,C=t.input.readByte()):C=-1,t.validBits=0,R.b[1]=C,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,B=t.input.readByte()):B=-1,t.validBits=0,R.b[2]=B,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,A=t.input.readByte()):A=-1,t.validBits=0,R.b[3]=A,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,N=t.input.readByte()):N=-1,t.validBits=0,R.b[4]=N,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,V=t.input.readByte()):V=-1,t.validBits=0,R.b[5]=V,"vorbis"!=R.toString())throw new M(new jt(Qt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var P=t.readBits(8)+1,D=new Array(P);u.codebooks=D;for(var F=0,O=P;F<O;){var W=F++;u.codebooks[W]=Mt.read(t)}for(var U=0,H=f=t.readBits(6)+1;U<H;){U++;if(0!=t.readBits(16))throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var G=t.readBits(6)+1,z=new Array(G);u.floorConfig=z;for(var Y=0,X=G;Y<X;){var K=Y++;u.floorConfig[K]=Ft.read(t,u.codebooks)}var Z=t.readBits(6)+1,j=new Array(Z);u.residueConfig=j;for(var Q=0,J=Z;Q<J;){var q=Q++;u.residueConfig[q]=Jt.read(t,u.codebooks)}var $=t.readBits(6)+1,tt=new Array($);u.mapping=tt;for(var et=0,it=$;et<it;){var nt=et++,rt=Gt.read(t,u.channel);u.mapping[nt]=rt;for(var st=0,at=rt.submaps;st<at;){var ot=st++;if(rt.submapFloor[ot]>=u.floorConfig.length)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(rt.submapResidue[ot]>=u.residueConfig.length)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}}var lt=t.readBits(6)+1,ht=new Array(lt);u.modes=ht;for(var ut=0,ct=lt;ut<ct;){var dt=ut++,_t=Yt.read(t);if(u.modes[dt]=_t,_t.mapping>=u.mapping.length)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next();)t.bytesInSeg--,t.inputPosition+=1,t.input.readByte();return u},Ut.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Ut};var Ht=function(){};n["kha.audio2.ogg.vorbis.data.IntPoint"]=Ht,Ht.__name__=!0,Ht.prototype={x:null,y:null,__class__:Ht};var Gt=function(){};n["kha.audio2.ogg.vorbis.data.Mapping"]=Gt,Gt.__name__=!0,Gt.read=function(t,e){var i=new Gt,n=t.readBits(16);if(0!=n)throw new M(new jt(Qt.INVALID_SETUP,"mapping type "+n,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var r=new Array(e);i.chan=r;for(var s=0,a=e;s<a;){var o=s++;i.chan[o]=new zt}if(0!=t.readBits(1)?i.submaps=t.readBits(4)+1:i.submaps=1,0!=t.readBits(1)){i.couplingSteps=t.readBits(8)+1;for(var l=0,h=i.couplingSteps;l<h;){var u=l++,c=e-1,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[u].magnitude=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0);var _=e-1,f=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[u].angle=t.readBits(_<16384?_<16?f[_]:_<512?5+f[_>>5]:10+f[_>>10]:_<16777216?_<524288?15+f[_>>15]:20+f[_>>20]:_<536870912?25+f[_>>25]:_<-2147483648?30+f[_>>30]:0),i.chan[u].magnitude>=e)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[u].angle>=e)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[u].magnitude==i.chan[u].angle)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=t.readBits(2))throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.submaps>1)for(var p=0,g=e;p<g;){var v=p++;if(i.chan[v].mux=t.readBits(4),i.chan[v].mux>=i.submaps)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var m=0,w=e;m<w;){var b=m++;i.chan[b].mux=0}var S=new Array(i.submaps);i.submapFloor=S;var y=new Array(i.submaps);i.submapResidue=y;for(var x=0,T=i.submaps;x<T;){var E=x++;t.readBits(8),i.submapFloor[E]=t.readBits(8),i.submapResidue[E]=t.readBits(8)}return i},Gt.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(t,e,i,n,r,s){var a=i>>1,o=this.chan[e].mux,l=t[this.submapFloor[o]];if(0==l.type)throw new M(new jt(Qt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var h=l.floor1,u=0,c=r[0]*h.floor1Multiplier,d=1,_=h.values;d<_;){var f=d++,p=h.sortedOrder[f];if(r[p]>=0){var g=r[p]*h.floor1Multiplier,v=h.xlist[p];Pt.drawLine(n,u,c,v,g,a),u=v,c=g}}if(u<a)for(var m=u,w=a;m<w;){var b=m++,S=n;S[b]=S[b]*Pt.INVERSE_DB_TABLE[c]}},__class__:Gt};var zt=function(){};n["kha.audio2.ogg.vorbis.data.MappingChannel"]=zt,zt.__name__=!0,zt.prototype={magnitude:null,angle:null,mux:null,__class__:zt};var Yt=function(){};n["kha.audio2.ogg.vorbis.data.Mode"]=Yt,Yt.__name__=!0,Yt.read=function(t){var e=new Yt;if(e.blockflag=0!=t.readBits(1),e.windowtype=t.readBits(16),e.transformtype=t.readBits(16),e.mapping=t.readBits(8),0!=e.windowtype)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=e.transformtype)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return e},Yt.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:Yt};var Xt=function(){};n["kha.audio2.ogg.vorbis.data.Page"]=Xt,Xt.__name__=!0,Xt.prototype={flag:null,clone:function(){var t=new Xt;return t.flag=this.flag,t},start:function(t){var e,i,n;if(t.inputPosition+=1,79==t.input.readByte()?(t.inputPosition+=1,n=103!=t.input.readByte()):n=!0,n?i=!0:(t.inputPosition+=1,i=103!=t.input.readByte()),i?e=!0:(t.inputPosition+=1,e=83!=t.input.readByte()),e)throw new M(new jt(Qt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(t)},startWithoutCapturePattern:function(t){t.inputPosition+=1;var e=t.input.readByte();if(0!=e)throw new M(new jt(Qt.INVALID_STREAM_STRUCTURE_VERSION,""+e,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));t.inputPosition+=1,this.flag=t.input.readByte(),t.inputPosition+=4;var i=t.input.readInt32();t.inputPosition+=4;var n=t.input.readInt32();t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.setup(i,n)},__class__:Xt};var Kt=function(){};n["kha.audio2.ogg.vorbis.data.PageFlag"]=Kt,Kt.__name__=!0;var Zt=function(){};n["kha.audio2.ogg.vorbis.data.ProbedPage"]=Zt,Zt.__name__=!0,Zt.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:Zt};var jt=function(t,e,i){null==e&&(e=""),this.type=t,this.message=e,this.posInfos=i};n["kha.audio2.ogg.vorbis.data.ReaderError"]=jt,jt.__name__=!0,jt.prototype={type:null,message:null,posInfos:null,__class__:jt};var Qt=s["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:r}},Jt=function(){};n["kha.audio2.ogg.vorbis.data.Residue"]=Jt,Jt.__name__=!0,Jt.read=function(t,e){var i=new Jt;if(i.type=t.readBits(16),i.type>2)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var n=new Array(64);i.begin=t.readBits(24),i.end=t.readBits(24),i.partSize=t.readBits(24)+1;var r=i.classifications=t.readBits(6)+1;i.classbook=t.readBits(8);for(var s=0,a=i.classifications;s<a;){var o=s++,l=0,h=t.readBits(3);0!=t.readBits(1)&&(l=t.readBits(5)),n[o]=8*l+h}var u=new Array(i.classifications);i.residueBooks=u;for(var c=0,d=i.classifications;c<d;){var _=c++,f=i.residueBooks,p=new Array(8);f[_]=p;for(var g=0;g<8;){var v=g++;if(0!=(n[_]&1<<v)){if(i.residueBooks[_][v]=t.readBits(8),i.residueBooks[_][v]>=e.length)throw new M(new jt(Qt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[_][v]=-1}}var m=e[i.classbook].entries,w=e[i.classbook].dimensions,b=new Array(m);i.classdata=b;for(var S=0,y=m;S<y;)for(var x=S++,T=x,E=w,k=i.classdata,C=new Array(w),I=k[x]=C;--E>=0;)I[E]=T%r,T=T/r|0;return i},Jt.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(t,e,i,n,r,s,a){for(var o=e.codebooks,l=o[this.classbook].dimensions,h=this.end-this.begin,u=this.partSize,c=p.toFloat(h)/p.toFloat(u)|0,d=new Array(e.channel*c+1),_=0,f=n;_<f;){var g=_++;if(!s[g])for(var v=i[g],m=0,w=v.length;m<w;){v[m++]=0}}if(2!=this.type||1==n)for(var b=0;b<8;)for(var S=b++,y=0;y<c;){if(0==S)for(var x=0,T=n;x<T;){var E=x++;if(!s[E]){var k=o[this.classbook];t.validBits<10&&t.prepHuffman();var C,I=k.fastHuffman[1023&t.acc];if(I>=0){var B=k.codewordLengths[I];t.acc=t.acc>>>B,t.validBits-=B,t.validBits<0?(t.validBits=0,C=-1):C=I}else C=t.decodeScalarRaw(k);k.sparse&&(C=k.sortedValues[C]);var L=C;if(-1==L)return;for(var A=l;--A>=0;)d[E*c+A+y]=L%this.classifications,L=L/this.classifications|0}}for(var N=0,V=l;N<V;){N++;if(y>=c)break;for(var R=0,P=n;R<P;){var M=R++;if(!s[M]){var D=d[M*c+y],F=this.residueBooks[D][S];if(F>=0){var O=i[M],W=this.begin+y*u,U=u;if(!o[F].residueDecode(t,O,W,U,this.type))return}}}++y}}else{for(var H=0,G=n;H<G;){var z=H++;if(!s[z])break;if(z==n-1)return}for(var Y=0;Y<8;){var X=Y++,K=0;if(2==n)for(;K<c;){var Z=this.begin+K*u,j=1&Z,Q=Z>>>1;if(0==X){var J=o[this.classbook];t.validBits<10&&t.prepHuffman();var q,$=J.fastHuffman[1023&t.acc];if($>=0){var tt=J.codewordLengths[$];t.acc=t.acc>>>tt,t.validBits-=tt,t.validBits<0?(t.validBits=0,q=-1):q=$}else q=t.decodeScalarRaw(J);J.sparse&&(q=J.sortedValues[q]);var et=q;if(-1==et)return;for(var it=l;--it>=0;)d[it+K]=et%this.classifications,et=et/this.classifications|0}for(var nt=0,rt=l;nt<rt;){nt++;if(K>=c)break;var st=this.begin+K*u,at=d[K],ot=this.residueBooks[at][X];if(ot>=0){var lt=o[ot].decodeDeinterleaveRepeat(t,i,n,j,Q,r,u);if(null==lt)return;j=lt.cInter,Q=lt.pInter}else j=1&(st+=u),Q=st>>>1;++K}}else if(1==n)for(;K<c;){var ht=0,ut=this.begin+K*u;if(0==X){var ct=o[this.classbook];t.validBits<10&&t.prepHuffman();var dt,_t=ct.fastHuffman[1023&t.acc];if(_t>=0){var ft=ct.codewordLengths[_t];t.acc=t.acc>>>ft,t.validBits-=ft,t.validBits<0?(t.validBits=0,dt=-1):dt=_t}else dt=t.decodeScalarRaw(ct);ct.sparse&&(dt=ct.sortedValues[dt]);var pt=dt;if(-1==pt)return;for(var gt=l;--gt>=0;)d[gt+K]=pt%this.classifications,pt=pt/this.classifications|0}for(var vt=0,mt=l;vt<mt;){vt++;if(K>=c)break;var wt=this.begin+K*u,bt=this.residueBooks[d[K]][X];if(bt>=0){var St=o[bt].decodeDeinterleaveRepeat(t,i,n,ht,ut,r,u);if(null==St)return;ht=St.cInter,ut=St.pInter}else ht=0,ut=wt+=u;++K}}else for(;K<c;){var yt=this.begin+K*u,xt=p.toFloat(yt)%p.toFloat(n)|0,Tt=p.toFloat(yt)/p.toFloat(n)|0;if(0==X){var Et=o[this.classbook];t.validBits<10&&t.prepHuffman();var kt,Ct=Et.fastHuffman[1023&t.acc];if(Ct>=0){var It=Et.codewordLengths[Ct];t.acc=t.acc>>>It,t.validBits-=It,t.validBits<0?(t.validBits=0,kt=-1):kt=Ct}else kt=t.decodeScalarRaw(Et);Et.sparse&&(kt=Et.sortedValues[kt]);var Bt=kt;if(-1==Bt)return;for(var Lt=l;--Lt>=0;)d[Lt+K]=Bt%this.classifications,Bt=Bt/this.classifications|0}for(var At=0,Nt=l;At<Nt;){At++;if(K>=c)break;var Vt=this.begin+K*u,Rt=this.residueBooks[d[K]][X];if(Rt>=0){var Pt=o[Rt].decodeDeinterleaveRepeat(t,i,n,xt,Tt,r,u);if(null==Pt)return;xt=Pt.cInter,Tt=Pt.pInter}else Vt+=u,xt=p.toFloat(Vt)%p.toFloat(n)|0,Tt=p.toFloat(Vt)/p.toFloat(n)|0;++K}}}}},__class__:Jt};var qt=function(){};n["kha.audio2.ogg.vorbis.data.Setting"]=qt,qt.__name__=!0;var $t=function(){};n["kha.compute.ConstantLocation"]=$t,$t.__name__=!0,$t.prototype={__class__:$t};var te=function(){};n["kha.compute.TextureUnit"]=te,te.__name__=!0,te.prototype={__class__:te};var ee=function(){};n["kha.graphics1.Graphics"]=ee,ee.__name__=!0,ee.prototype={begin:null,end:null,setPixel:null,__class__:ee};var ie=function(){this.transformations=[new ti(1,0,0,0,1,0,0,0,1)],this.transformationIndex=0,this.opacities=[1],this.myFontSize=12,this.pipe=null};n["kha.graphics2.Graphics"]=ie,ie.__name__=!0,ie.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},flush:function(){},clear:function(t){},drawImage:function(t,e,i){this.drawSubImage(t,e,i,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,i,n,r,s,a){this.drawScaledSubImage(t,n,r,s,a,e,i,s,a)},drawScaledImage:function(t,e,i,n,r){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,i,n,r)},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){},drawRect:function(t,e,i,n,r){null==r&&(r=1)},fillRect:function(t,e,i,n){},drawString:function(t,e,i){},drawCharacters:function(t,e,i,n,r){},drawLine:function(t,e,i,n,r){null==r&&(r=1)},drawVideo:function(t,e,i,n,r){},fillTriangle:function(t,e,i,n,r,s){},get_imageScaleQuality:function(){return re.Low},set_imageScaleQuality:function(t){return re.High},get_mipmapScaleQuality:function(){return re.Low},set_mipmapScaleQuality:function(t){return re.High},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},get_transformation:function(){return this.transformations[this.transformationIndex]},set_transformation:function(t){this.setTransformation(t);var e=this.transformations[this.transformationIndex];return e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,t},pushTransformation:function(t){this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ti(1,0,0,0,1,0,0,0,1));var e=this.transformations[this.transformationIndex];e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(this.transformations[this.transformationIndex])},popTransformation:function(){return this.transformationIndex--,this.setTransformation(this.transformations[this.transformationIndex]),this.transformations[this.transformationIndex+1]},scale:function(t,e){var i=this.transformations[this.transformationIndex],n=t,r=e,s=this.transformations[this.transformationIndex],a=n*s._00+0*s._01+0*s._02,o=n*s._10+0*s._11+0*s._12,l=n*s._20+0*s._21+0*s._22,h=0*s._00+r*s._01+0*s._02,u=0*s._10+r*s._11+0*s._12,c=0*s._20+r*s._21+0*s._22,d=0*s._00+0*s._01+1*s._02,_=0*s._10+0*s._11+1*s._12,f=0*s._20+0*s._21+1*s._22;i._00=a,i._10=o,i._20=l,i._01=h,i._11=u,i._21=c,i._02=d,i._12=_,i._22=f},translation:function(t,e){var i=t,n=e,r=this.transformations[this.transformationIndex];return new ti(1*r._00+0*r._01+i*r._02,1*r._10+0*r._11+i*r._12,1*r._20+0*r._21+i*r._22,0*r._00+1*r._01+n*r._02,0*r._10+1*r._11+n*r._12,0*r._20+1*r._21+n*r._22,0*r._00+0*r._01+1*r._02,0*r._10+0*r._11+1*r._12,0*r._20+0*r._21+1*r._22)},translate:function(t,e){var i=this.transformations[this.transformationIndex],n=t,r=e,s=this.transformations[this.transformationIndex],a=1*s._00+0*s._01+n*s._02,o=1*s._10+0*s._11+n*s._12,l=1*s._20+0*s._21+n*s._22,h=0*s._00+1*s._01+r*s._02,u=0*s._10+1*s._11+r*s._12,c=0*s._20+1*s._21+r*s._22,d=0*s._00+0*s._01+1*s._02,_=0*s._10+0*s._11+1*s._12,f=0*s._20+0*s._21+1*s._22;i._00=a,i._10=o,i._20=l,i._01=h,i._11=u,i._21=c,i._02=d,i._12=_,i._22=f},pushTranslation:function(t,e){var i=t,n=e,r=this.transformations[this.transformationIndex],s=1*r._00+0*r._01+i*r._02,a=1*r._10+0*r._11+i*r._12,o=1*r._20+0*r._21+i*r._22,l=0*r._00+1*r._01+n*r._02,h=0*r._10+1*r._11+n*r._12,u=0*r._20+1*r._21+n*r._22,c=0*r._00+0*r._01+1*r._02,d=0*r._10+0*r._11+1*r._12,_=0*r._20+0*r._21+1*r._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ti(1,0,0,0,1,0,0,0,1));var f=this.transformations[this.transformationIndex];f._00=s,f._10=a,f._20=o,f._01=l,f._11=h,f._21=u,f._02=c,f._12=d,f._22=_,this.setTransformation(this.transformations[this.transformationIndex])},rotation:function(t,e,i){var n=e,r=i,s=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),h=1*s+0*o+0*n,u=1*a+0*l+0*n,c=0+1*n,d=0*s+1*o+0*r,_=0*a+1*l+0*r,f=0+1*r,p=0*s+0*o+0,g=0*a+0*l+0,v=-e,m=-i,w=1*h+0*u+0*c,b=0*h+1*u+0*c,S=h*v+u*m+1*c,y=1*d+0*_+0*f,x=0*d+1*_+0*f,T=d*v+_*m+1*f,E=1*p+0*g+0,k=0*p+1*g+0,C=p*v+g*m+1,I=this.transformations[this.transformationIndex];return new ti(w*I._00+b*I._01+S*I._02,w*I._10+b*I._11+S*I._12,w*I._20+b*I._21+S*I._22,y*I._00+x*I._01+T*I._02,y*I._10+x*I._11+T*I._12,y*I._20+x*I._21+T*I._22,E*I._00+k*I._01+C*I._02,E*I._10+k*I._11+C*I._12,E*I._20+k*I._21+C*I._22)},rotate:function(t,e,i){var n=this.transformations[this.transformationIndex],r=e,s=i,a=Math.cos(t),o=-Math.sin(t),l=Math.sin(t),h=Math.cos(t),u=1*a+0*l+0*r,c=1*o+0*h+0*r,d=0+1*r,_=0*a+1*l+0*s,f=0*o+1*h+0*s,p=0+1*s,g=0*a+0*l+0,v=0*o+0*h+0,m=-e,w=-i,b=1*u+0*c+0*d,S=0*u+1*c+0*d,y=u*m+c*w+1*d,x=1*_+0*f+0*p,T=0*_+1*f+0*p,E=_*m+f*w+1*p,k=1*g+0*v+0,C=0*g+1*v+0,I=g*m+v*w+1,B=this.transformations[this.transformationIndex],L=b*B._00+S*B._01+y*B._02,A=b*B._10+S*B._11+y*B._12,N=b*B._20+S*B._21+y*B._22,V=x*B._00+T*B._01+E*B._02,R=x*B._10+T*B._11+E*B._12,P=x*B._20+T*B._21+E*B._22,M=k*B._00+C*B._01+I*B._02,D=k*B._10+C*B._11+I*B._12,F=k*B._20+C*B._21+I*B._22;n._00=L,n._10=A,n._20=N,n._01=V,n._11=R,n._21=P,n._02=M,n._12=D,n._22=F},pushRotation:function(t,e,i){var n=e,r=i,s=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),h=1*s+0*o+0*n,u=1*a+0*l+0*n,c=0+1*n,d=0*s+1*o+0*r,_=0*a+1*l+0*r,f=0+1*r,p=0*s+0*o+0,g=0*a+0*l+0,v=-e,m=-i,w=1*h+0*u+0*c,b=0*h+1*u+0*c,S=h*v+u*m+1*c,y=1*d+0*_+0*f,x=0*d+1*_+0*f,T=d*v+_*m+1*f,E=1*p+0*g+0,k=0*p+1*g+0,C=p*v+g*m+1,I=this.transformations[this.transformationIndex],B=w*I._00+b*I._01+S*I._02,L=w*I._10+b*I._11+S*I._12,A=w*I._20+b*I._21+S*I._22,N=y*I._00+x*I._01+T*I._02,V=y*I._10+x*I._11+T*I._12,R=y*I._20+x*I._21+T*I._22,P=E*I._00+k*I._01+C*I._02,M=E*I._10+k*I._11+C*I._12,D=E*I._20+k*I._21+C*I._22;this.transformationIndex++,this.transformationIndex==this.transformations.length&&this.transformations.push(new ti(1,0,0,0,1,0,0,0,1));var F=this.transformations[this.transformationIndex];F._00=B,F._10=L,F._20=A,F._01=N,F._11=V,F._21=R,F._02=P,F._12=M,F._22=D,this.setTransformation(this.transformations[this.transformationIndex])},pushOpacity:function(t){this.setOpacity(t),this.opacities.push(t)},popOpacity:function(){var t=this.opacities.pop();return this.setOpacity(this.get_opacity()),t},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(t){return this.setOpacity(t),this.opacities[this.opacities.length-1]=t},scissor:function(t,e,i,n){},disableScissor:function(){},pipe:null,get_pipeline:function(){return this.pipe},set_pipeline:function(t){return this.setPipeline(t),this.pipe=t},transformations:null,transformationIndex:null,opacities:null,myFontSize:null,setTransformation:function(t){},setOpacity:function(t){},setPipeline:function(t){},__class__:ie};var ne=function(t){this.canvas=t};n["kha.graphics2.Graphics1"]=ne,ne.__name__=!0,ne.__interfaces__=[ee],ne.prototype={canvas:null,texture:null,pixels:null,begin:function(){null!=this.texture&&this.texture.get_realWidth()==this.canvas.get_width()&&this.texture.get_realHeight()==this.canvas.get_height()||(this.texture=$.create(this.canvas.get_width(),this.canvas.get_height(),0,2)),this.pixels=this.texture.lock()},end:function(){this.texture.unlock(),this.canvas.get_g2().begin(),this.canvas.get_g2().drawImage(this.texture,0,0),this.canvas.get_g2().end()},setPixel:function(t,e,i){this.pixels.setInt32(e*this.texture.get_realWidth()*4+4*t,i)},__class__:ne};var re=s["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:r},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:r}},se=function(){};n["kha.graphics2.truetype.VectorOfIntPointer"]=se,se.__name__=!0,se.prototype={value:null,__class__:se};var ae=function(){};n["kha.graphics2.truetype.Stbtt_temp_rect"]=ae,ae.__name__=!0,ae.prototype={x0:null,y0:null,x1:null,y1:null,__class__:ae};var oe=function(){};n["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=oe,oe.__name__=!0,oe.prototype={advanceWidth:null,leftSideBearing:null,__class__:oe};var le=function(){};n["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=le,le.__name__=!0,le.prototype={ascent:null,descent:null,lineGap:null,__class__:le};var he=function(){};n["kha.graphics2.truetype.Stbtt_temp_region"]=he,he.__name__=!0,he.prototype={width:null,height:null,xoff:null,yoff:null,__class__:he};var ue=function(){};n["kha.graphics2.truetype.Stbtt_bakedchar"]=ue,ue.__name__=!0,ue.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:ue};var ce=function(){};n["kha.graphics2.truetype.Stbtt_aligned_quad"]=ce,ce.__name__=!0,ce.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,__class__:ce};var de=function(){};n["kha.graphics2.truetype.Stbtt_packedchar"]=de,de.__name__=!0,de.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,xoff2:null,yoff2:null,__class__:de};var _e=function(){};n["kha.graphics2.truetype.Stbtt_pack_range"]=_e,_e.__name__=!0,_e.prototype={font_size:null,first_unicode_codepoint_in_range:null,array_of_unicode_codepoints:null,num_chars:null,chardata_for_range:null,h_oversample:null,v_oversample:null,__class__:_e};var fe=function(){};n["kha.graphics2.truetype.Stbtt_pack_context"]=fe,fe.__name__=!0,fe.prototype={width:null,height:null,stride_in_bytes:null,padding:null,h_oversample:null,v_oversample:null,pixels:null,__class__:fe};var pe=function(){};n["kha.graphics2.truetype.Stbtt_fontinfo"]=pe,pe.__name__=!0,pe.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:pe};var ge=function(){};n["kha.graphics2.truetype.Stbtt_vertex"]=ge,ge.__name__=!0,ge.prototype={x:null,y:null,cx:null,cy:null,type:null,padding:null,__class__:ge};var ve=function(){};n["kha.graphics2.truetype.Stbtt__bitmap"]=ve,ve.__name__=!0,ve.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:ve};var me=function(){};n["kha.graphics2.truetype.Stbtt__edge"]=me,me.__name__=!0,me.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:me};var we=function(){};n["kha.graphics2.truetype.Stbtt__active_edge"]=we,we.__name__=!0,we.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:we};var be=function(){};n["kha.graphics2.truetype.Stbtt__point"]=be,be.__name__=!0,be.prototype={x:null,y:null,__class__:be};var Se=function(){};n["kha.graphics2.truetype.StbTruetype"]=Se,Se.__name__=!0,Se.STBTT_assert=function(t){if(!t)throw new M("Error")},Se.STBTT_POINT_SIZE=function(t){return-t},Se.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},Se.ttCHAR=function(t,e){null==e&&(e=0);var i=t.readU8(e);return i>=128?i-256:i},Se.ttUSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e);return t.readU8(e+1)|i<<8},Se.ttSHORT=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1)|i<<8;return 0!=(32768&n)?n-65536:n},Se.ttULONG=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|n<<16|i<<24},Se.ttLONG=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|n<<16|i<<24},Se.ttFixed=function(t,e){null==e&&(e=0);var i=t.readU8(e),n=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|n<<16|i<<24},Se.stbtt_tag4=function(t,e,i,n,r,s){return t.readU8(e)==i&&t.readU8(e+1)==n&&t.readU8(e+2)==r&&t.readU8(e+3)==s},Se.stbtt_tag=function(t,e,i){var n=l.cca(i,0),r=l.cca(i,1),s=l.cca(i,2),a=l.cca(i,3);return t.readU8(e)==n&&t.readU8(e+1)==r&&t.readU8(e+2)==s&&t.readU8(e+3)==a},Se.stbtt__isfont=function(t){var e=l.cca("1",0);if(t.readU8(0)==e&&0==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3))return!0;var i=l.cca("typ1",0),n=l.cca("typ1",1),r=l.cca("typ1",2),s=l.cca("typ1",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==r&&t.readU8(3)==s)return!0;var a=l.cca("OTTO",0),o=l.cca("OTTO",1),h=l.cca("OTTO",2),u=l.cca("OTTO",3);return t.readU8(0)==a&&t.readU8(1)==o&&t.readU8(2)==h&&t.readU8(3)==u||0==t.readU8(0)&&1==t.readU8(1)&&0==t.readU8(2)&&0==t.readU8(3)},Se.stbtt__find_table=function(t,e,i){for(var n=e+4,r=t.readU8(n),s=e+12,a=0,o=t.readU8(n+1)|r<<8;a<o;){var h=s+16*a++,u=l.cca(i,0),c=l.cca(i,1),d=l.cca(i,2),_=l.cca(i,3);if(t.readU8(h)==u&&t.readU8(h+1)==c&&t.readU8(h+2)==d&&t.readU8(h+3)==_){var f=h+8,p=t.readU8(f),g=t.readU8(f+1),v=t.readU8(f+2);return t.readU8(f+3)|v<<8|g<<16|p<<24}}return 0},Se.stbtt_GetFontOffsetForIndex=function(t,e){if(Se.stbtt__isfont(t))return 0==e?0:-1;var i=l.cca("ttcf",0),n=l.cca("ttcf",1),r=l.cca("ttcf",2),s=l.cca("ttcf",3);if(t.readU8(0)==i&&t.readU8(1)==n&&t.readU8(2)==r&&t.readU8(3)==s){var a,o=t.readU8(4),h=t.readU8(5),u=t.readU8(6);if(65536!=(t.readU8(7)|u<<8|h<<16|o<<24)){var c=t.readU8(4),d=t.readU8(5),_=t.readU8(6);a=131072==(t.readU8(7)|_<<8|d<<16|c<<24)}else a=!0;if(a){var f=t.readU8(8),p=t.readU8(9),g=t.readU8(10);if(e>=(t.readU8(11)|g<<8|p<<16|f<<24))return-1;var v=12+4*e,m=t.readU8(v),w=t.readU8(v+1),b=t.readU8(v+2);return t.readU8(v+3)|b<<8|w<<16|m<<24}}return-1},Se.stbtt_InitFont=function(t,e,i){t.data=e,t.fontstart=i;var n=Se.stbtt__find_table(e,i,"cmap");if(t.loca=Se.stbtt__find_table(e,i,"loca"),t.head=Se.stbtt__find_table(e,i,"head"),t.glyf=Se.stbtt__find_table(e,i,"glyf"),t.hhea=Se.stbtt__find_table(e,i,"hhea"),t.hmtx=Se.stbtt__find_table(e,i,"hmtx"),t.kern=Se.stbtt__find_table(e,i,"kern"),0==n||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var r=Se.stbtt__find_table(e,i,"maxp");if(0!=r){var s=r+4,a=e.readU8(s),o=e.readU8(s+1);t.numGlyphs=o|a<<8}else t.numGlyphs=65535;var l=n+2,h=e.readU8(l),u=e.readU8(l+1)|h<<8;t.index_map=0;for(var c=0,d=u;c<d;){var _=n+4+8*c++,f=e.readU8(_);switch(e.readU8(_+1)|f<<8){case 0:var p=_+4,g=e.readU8(p),v=e.readU8(p+1),m=e.readU8(p+2),w=e.readU8(p+3);t.index_map=n+(w|m<<8|v<<16|g<<24);break;case 3:var b=_+2,S=e.readU8(b);switch(e.readU8(b+1)|S<<8){case 1:case 10:var y=_+4,x=e.readU8(y),T=e.readU8(y+1),E=e.readU8(y+2),k=e.readU8(y+3);t.index_map=n+(k|E<<8|T<<16|x<<24)}}}if(0==t.index_map)return!1;var C=t.head+50,I=e.readU8(C),B=e.readU8(C+1);return t.indexToLocFormat=B|I<<8,!0},Se.stbtt_FindGlyphIndex=function(t,e){var i=t.data,n=t.index_map,r=i.readU8(n),s=i.readU8(n+1)|r<<8;if(0==s){var a=n+2,o=i.readU8(a);return e<(i.readU8(a+1)|o<<8)-6?i.readU8(n+6+e):0}if(6==s){var l=n+6,h=i.readU8(l),u=i.readU8(l+1)|h<<8,c=n+8,d=i.readU8(c),_=i.readU8(c+1);if(e>=u&&e<u+(_|d<<8)){var f=n+10+2*(e-u),p=i.readU8(f);return i.readU8(f+1)|p<<8}return 0}if(2==s)throw new M("Error");if(4==s){var g=n+6,v=i.readU8(g),m=(i.readU8(g+1)|v<<8)>>1,w=n+8,b=i.readU8(w),S=(i.readU8(w+1)|b<<8)>>1,y=n+10,x=i.readU8(y),T=i.readU8(y+1)|x<<8,E=n+12,k=i.readU8(E),C=(i.readU8(E+1)|k<<8)>>1,I=n+14,B=I;if(e>65535)return 0;var L=B+2*C,A=i.readU8(L);for(e>=(i.readU8(L+1)|A<<8)&&(B+=2*C),B-=2;0!=T;){var N=B+2*(S>>=1),V=i.readU8(N);e>(i.readU8(N+1)|V<<8)&&(B+=2*S),--T}var R=(B+=2)-I>>1,P=I+2*R,D=i.readU8(P);if(e>(i.readU8(P+1)|D<<8))throw new M("Error");var F=n+14+2*m+2+2*R,O=i.readU8(F),W=i.readU8(F+1)|O<<8;if(e<W)return 0;var U=n+14+6*m+2+2*R,H=i.readU8(U),G=i.readU8(U+1)|H<<8;if(0==G){var z=n+14+4*m+2+2*R,Y=i.readU8(z),X=i.readU8(z+1)|Y<<8;return e+(0!=(32768&X)?X-65536:X)}var K=G+2*(e-W)+n+14+6*m+2+2*R,Z=i.readU8(K);return i.readU8(K+1)|Z<<8}if(12==s||13==s){for(var j=n+12,Q=i.readU8(j),J=i.readU8(j+1),q=i.readU8(j+2),$=0,tt=i.readU8(j+3)|q<<8|J<<16|Q<<24;$<tt;){var et=$+(tt-$>>1),it=n+16+12*et,nt=i.readU8(it),rt=i.readU8(it+1),st=i.readU8(it+2),at=i.readU8(it+3)|st<<8|rt<<16|nt<<24,ot=n+16+12*et+4,lt=i.readU8(ot),ht=i.readU8(ot+1),ut=i.readU8(ot+2),ct=i.readU8(ot+3);if(e<at)tt=et;else{if(!(e>(ct|ut<<8|ht<<16|lt<<24))){var dt=n+16+12*et+8,_t=i.readU8(dt),ft=i.readU8(dt+1),pt=i.readU8(dt+2),gt=i.readU8(dt+3)|pt<<8|ft<<16|_t<<24;return 12==s?gt+e-at:gt}$=et+1}}return 0}throw new M("Error")},Se.stbtt_GetCodepointShape=function(t,e){return Se.stbtt_GetGlyphShape(t,Se.stbtt_FindGlyphIndex(t,e))},Se.stbtt_setvertex=function(t,e,i,n,r,s){t.type=e,t.x=i,t.y=n,t.cx=r,t.cy=s},Se.stbtt__GetGlyfOffset=function(t,e){var i,n;if(e>=t.numGlyphs)return-1;if(t.indexToLocFormat>=2)return-1;if(0==t.indexToLocFormat){var r=t.glyf,s=t.data,a=t.loca+2*e,o=s.readU8(a);i=r+2*(s.readU8(a+1)|o<<8);var l=t.glyf,h=t.data,u=t.loca+2*e+2,c=h.readU8(u);n=l+2*(h.readU8(u+1)|c<<8)}else{var d=t.glyf,_=t.data,f=t.loca+4*e,p=_.readU8(f),g=_.readU8(f+1),v=_.readU8(f+2);i=d+(_.readU8(f+3)|v<<8|g<<16|p<<24);var m=t.glyf,w=t.data,b=t.loca+4*e+4,S=w.readU8(b),y=w.readU8(b+1),x=w.readU8(b+2);n=m+(w.readU8(b+3)|x<<8|y<<16|S<<24)}return i==n?-1:i},Se.stbtt_GetGlyphBox=function(t,e,i){var n=Se.stbtt__GetGlyfOffset(t,e);if(n<0)return!1;var r=t.data,s=n+2,a=r.readU8(s),o=r.readU8(s+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=t.data,h=n+4,u=l.readU8(h),c=l.readU8(h+1)|u<<8;i.y0=0!=(32768&c)?c-65536:c;var d=t.data,_=n+6,f=d.readU8(_),p=d.readU8(_+1)|f<<8;i.x1=0!=(32768&p)?p-65536:p;var g=t.data,v=n+8,m=g.readU8(v),w=g.readU8(v+1)|m<<8;return i.y1=0!=(32768&w)?w-65536:w,!0},Se.stbtt_GetCodepointBox=function(t,e,i){return Se.stbtt_GetGlyphBox(t,Se.stbtt_FindGlyphIndex(t,e),i)},Se.stbtt_IsGlyphEmpty=function(t,e){var i=Se.stbtt__GetGlyfOffset(t,e);if(i<0)return!0;var n=t.data,r=n.readU8(i),s=n.readU8(i+1)|r<<8;return 0==(0!=(32768&s)?s-65536:s)},Se.stbtt__close_shape=function(t,e,i,n,r,s,a,o,l,h){return n?(i&&Se.stbtt_setvertex(t[e++],3,l+a>>1,h+o>>1,l,h),Se.stbtt_setvertex(t[e++],3,r,s,a,o)):i?Se.stbtt_setvertex(t[e++],3,r,s,l,h):Se.stbtt_setvertex(t[e++],2,r,s,0,0),e},Se.copyVertices=function(t,e,i,n){for(var r=0,s=n;r<s;){var a=r++;e[i+a]=t[a]}},Se.stbtt_GetGlyphShape=function(t,e){var i=t.data,n=null,r=0,s=Se.stbtt__GetGlyfOffset(t,e);if(s<0)return null;var a=i.readU8(s),o=i.readU8(s+1)|a<<8,l=0!=(32768&o)?o-65536:o;if(l>0){var h,u=0,c=0,d=0,_=!1,f=!1,p=s+10,g=p+2*l,v=i.readU8(g),m=p+2*l+2+(i.readU8(g+1)|v<<8),w=p+2*l-2,b=i.readU8(w),S=1+(i.readU8(w+1)|b<<8),y=S+2*l;if(null==(n=new Array(y)))return null;for(var x=0,T=n.length;x<T;){n[x++]=new ge}d=0;var E=0;h=y-S;for(var k=0,C=S;k<C;){var I=k++;0==E?0!=(8&(u=i.readU8(m++)))&&(E=i.readU8(m++)):--E,n[h+I].type=u}for(var B=0,L=0,A=S;L<A;){var N=L++;if(0!=(2&(u=n[h+N].type))){var V=i.readU8(m++);B+=0!=(16&u)?V:-V}else if(0==(16&u)){var R=i.readU8(m),P=i.readU8(m+1)|R<<8;B+=0!=(32768&P)?P-65536:P,m+=2}n[h+N].x=B}for(var D=0,F=0,O=S;F<O;){var W=F++;if(0!=(4&(u=n[h+W].type))){var U=i.readU8(m++);D+=0!=(32&u)?U:-U}else if(0==(32&u)){var H=i.readU8(m),G=i.readU8(m+1)|H<<8;D+=0!=(32768&G)?G-65536:G,m+=2}n[h+W].y=D}r=0;for(var z=0,Y=z,X=Y,K=X,Z=K,j=Z,Q=0;Q<S;){if(u=n[h+Q].type,B=n[h+Q].x,D=n[h+Q].y,d==Q){0!=Q&&(r=Se.stbtt__close_shape(n,r,_,f,j,Z,Y,z,K,X)),(f=0==(1&u))?(Y=B,z=D,0==(1&n[h+Q+1].type)?(j=B+n[h+Q+1].x>>1,Z=D+n[h+Q+1].y>>1):(j=n[h+Q+1].x,Z=n[h+Q+1].y,++Q)):(j=B,Z=D),Se.stbtt_setvertex(n[r++],1,j,Z,0,0),_=!1;var J=p+2*c,q=i.readU8(J);d=1+(i.readU8(J+1)|q<<8),++c}else 0==(1&u)?(_&&Se.stbtt_setvertex(n[r++],3,K+B>>1,X+D>>1,K,X),K=B,X=D,_=!0):(_?Se.stbtt_setvertex(n[r++],3,B,D,K,X):Se.stbtt_setvertex(n[r++],2,B,D,0,0),_=!1);++Q}r=Se.stbtt__close_shape(n,r,_,f,j,Z,Y,z,K,X)}else if(-1==l){var $=1,tt=s+10;for(r=0,n=null;0!=$;){var et,it,nt=null,rt=1,st=0,at=0,ot=1,lt=0,ht=0,ut=i.readU8(tt),ct=i.readU8(tt+1)|ut<<8,dt=0!=(32768&ct)?ct-65536:ct;tt+=2;var _t=i.readU8(tt),ft=i.readU8(tt+1)|_t<<8,pt=0!=(32768&ft)?ft-65536:ft;if(tt+=2,0==(2&dt))throw new M("Error");if(0!=(1&dt)){var gt=i.readU8(tt),vt=i.readU8(tt+1)|gt<<8;lt=0!=(32768&vt)?vt-65536:vt,tt+=2;var mt=i.readU8(tt),wt=i.readU8(tt+1)|mt<<8;ht=0!=(32768&wt)?wt-65536:wt,tt+=2}else{var bt=i.readU8(tt);lt=bt>=128?bt-256:bt,++tt;var St=i.readU8(tt);ht=St>=128?St-256:St,++tt}if(0!=(8&dt)){var yt=i.readU8(tt),xt=i.readU8(tt+1)|yt<<8;rt=ot=(0!=(32768&xt)?xt-65536:xt)/16384,tt+=2,st=at=0}else if(0!=(64&dt)){var Tt=i.readU8(tt),Et=i.readU8(tt+1)|Tt<<8;rt=(0!=(32768&Et)?Et-65536:Et)/16384,tt+=2,st=at=0;var kt=i.readU8(tt),Ct=i.readU8(tt+1)|kt<<8;ot=(0!=(32768&Ct)?Ct-65536:Ct)/16384,tt+=2}else if(0!=(128&dt)){var It=i.readU8(tt),Bt=i.readU8(tt+1)|It<<8;rt=(0!=(32768&Bt)?Bt-65536:Bt)/16384,tt+=2;var Lt=i.readU8(tt),At=i.readU8(tt+1)|Lt<<8;st=(0!=(32768&At)?At-65536:At)/16384,tt+=2;var Nt=i.readU8(tt),Vt=i.readU8(tt+1)|Nt<<8;at=(0!=(32768&Vt)?Vt-65536:Vt)/16384,tt+=2;var Rt=i.readU8(tt),Pt=i.readU8(tt+1)|Rt<<8;ot=(0!=(32768&Pt)?Pt-65536:Pt)/16384,tt+=2}var Mt=Math.sqrt(rt*rt+st*st),Dt=Math.sqrt(at*at+ot*ot);if((et=null==(it=Se.stbtt_GetGlyphShape(t,pt))?0:it.length)>0){for(var Ft=0,Ot=et;Ft<Ot;){var Wt=it[Ft++],Ut=Wt.x,Ht=Wt.y;Wt.x=Mt*(rt*Ut+at*Ht+lt)|0,Wt.y=Dt*(st*Ut+ot*Ht+ht)|0,Ut=Wt.cx,Ht=Wt.cy,Wt.cx=Mt*(rt*Ut+at*Ht+lt)|0,Wt.cy=Dt*(st*Ut+ot*Ht+ht)|0}if(null==(nt=new Array(r+et)))return null;r>0&&Se.copyVertices(n,nt,0,r),Se.copyVertices(it,nt,r,et),n=nt,r+=et}$=32&dt}}else if(l<0)throw new M("Error");if(null==n)return null;if(n.length<r)throw new M("Error");if(r<n.length){var Gt=new Array(r);return Se.copyVertices(n,Gt,0,r),Gt}return n},Se.stbtt_GetGlyphHMetrics=function(t,e){var i=t.data,n=t.hhea+34,r=i.readU8(n),s=i.readU8(n+1)|r<<8,a=new oe;if(e<s){var o=t.data,l=t.hmtx+4*e,h=o.readU8(l),u=o.readU8(l+1)|h<<8;a.advanceWidth=0!=(32768&u)?u-65536:u;var c=t.data,d=t.hmtx+4*e+2,_=c.readU8(d),f=c.readU8(d+1)|_<<8;a.leftSideBearing=0!=(32768&f)?f-65536:f}else{var p=t.data,g=t.hmtx+4*(s-1),v=p.readU8(g),m=p.readU8(g+1)|v<<8;a.advanceWidth=0!=(32768&m)?m-65536:m;var w=t.data,b=t.hmtx+4*s+2*(e-s),S=w.readU8(b),y=w.readU8(b+1)|S<<8;a.leftSideBearing=0!=(32768&y)?y-65536:y}return a},Se.stbtt_GetGlyphKernAdvance=function(t,e,i){var n,r,s=t.kern,a=t.data;if(0==t.kern)return 0;var o=s+2,l=a.readU8(o);if((a.readU8(o+1)|l<<8)<1)return 0;var h=s+8,u=a.readU8(h);if(1!=(a.readU8(h+1)|u<<8))return 0;for(var c=0,d=s+10,_=a.readU8(d),f=(a.readU8(d+1)|_<<8)-1,p=e<<16|i;c<=f;){var g=s+18+6*(r=c+f>>1),v=a.readU8(g),m=a.readU8(g+1),w=a.readU8(g+2);if(p<(n=a.readU8(g+3)|w<<8|m<<16|v<<24))f=r-1;else{if(!(p>n)){var b=s+22+6*r,S=a.readU8(b),y=a.readU8(b+1)|S<<8;return 0!=(32768&y)?y-65536:y}c=r+1}}return 0},Se.stbtt_GetCodepointKernAdvance=function(t,e,i){return 0==t.kern?0:Se.stbtt_GetGlyphKernAdvance(t,Se.stbtt_FindGlyphIndex(t,e),Se.stbtt_FindGlyphIndex(t,i))},Se.stbtt_GetCodepointHMetrics=function(t,e){return Se.stbtt_GetGlyphHMetrics(t,Se.stbtt_FindGlyphIndex(t,e))},Se.stbtt_GetFontVMetrics=function(t){var e=new le,i=t.data,n=t.hhea+4,r=i.readU8(n),s=i.readU8(n+1)|r<<8;e.ascent=0!=(32768&s)?s-65536:s;var a=t.data,o=t.hhea+6,l=a.readU8(o),h=a.readU8(o+1)|l<<8;e.descent=0!=(32768&h)?h-65536:h;var u=t.data,c=t.hhea+8,d=u.readU8(c),_=u.readU8(c+1)|d<<8;return e.lineGap=0!=(32768&_)?_-65536:_,e},Se.stbtt_GetFontBoundingBox=function(t){var e=new ae,i=t.data,n=t.head+36,r=i.readU8(n),s=i.readU8(n+1)|r<<8;e.x0=0!=(32768&s)?s-65536:s;var a=t.data,o=t.head+38,l=a.readU8(o),h=a.readU8(o+1)|l<<8;e.y0=0!=(32768&h)?h-65536:h;var u=t.data,c=t.head+40,d=u.readU8(c),_=u.readU8(c+1)|d<<8;e.x1=0!=(32768&_)?_-65536:_;var f=t.data,p=t.head+42,g=f.readU8(p),v=f.readU8(p+1)|g<<8;return e.y1=0!=(32768&v)?v-65536:v,e},Se.stbtt_ScaleForPixelHeight=function(t,e){var i=t.data,n=t.hhea+4,r=i.readU8(n),s=i.readU8(n+1)|r<<8,a=t.data,o=t.hhea+6,l=a.readU8(o),h=a.readU8(o+1)|l<<8;return e/((0!=(32768&s)?s-65536:s)-(0!=(32768&h)?h-65536:h))},Se.stbtt_ScaleForMappingEmToPixels=function(t,e){var i=t.data,n=t.head+18,r=i.readU8(n);return e/(i.readU8(n+1)|r<<8)},Se.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,i,n,r,s){var a=new ae;if(Se.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,h=a.y0,u=a.y1;a.x0=Math.floor(o*i+r),a.y0=Math.floor(-u*n+s),a.x1=Math.ceil(l*i+r),a.y1=Math.ceil(-h*n+s)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},Se.stbtt_GetGlyphBitmapBox=function(t,e,i,n){return Se.stbtt_GetGlyphBitmapBoxSubpixel(t,e,i,n,0,0)},Se.stbtt_GetCodepointBitmapBoxSubpixel=function(t,e,i,n,r,s){return Se.stbtt_GetGlyphBitmapBoxSubpixel(t,Se.stbtt_FindGlyphIndex(t,e),i,n,r,s)},Se.stbtt_GetCodepointBitmapBox=function(t,e,i,n){return Se.stbtt_GetCodepointBitmapBoxSubpixel(t,e,i,n,0,0)},Se.stbtt__new_active=function(t,e,i,n){var r=new we,s=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==r?r:(r.fdx=s,r.fdy=0!=s?1/s:0,r.fx=t[e].x0+s*(n-t[e].y0),r.fx-=i,r.direction=t[e].invert?1:-1,r.sy=t[e].y0,r.ey=t[e].y1,r.next=null,r)},Se.stbtt__handle_clipped_edge=function(t,e,i,n,r,s,a,o){if(s!=o){if(!(s<o))throw new M("Error");if(!(n.sy<=n.ey))throw new M("Error");if(!(s>n.ey||o<n.sy)){if(s<n.sy&&(r+=(a-r)*(n.sy-s)/(o-s),s=n.sy),o>n.ey&&(a+=(a-r)*(n.ey-o)/(o-s),o=n.ey),r==i){if(!(a<=i+1))throw new M("Error")}else if(r==i+1){if(!(a>=i))throw new M("Error")}else if(r<=i){if(!(a<=i))throw new M("Error")}else if(r>=i+1){if(!(a>=i+1))throw new M("Error")}else if(!(a>=i&&a<=i+1))throw new M("Error");if(r<=i&&a<=i){var l=e+i,h=t;h[l]=h[l]+n.direction*(o-s)}else if(!(r>=i+1&&a>=i+1)){if(!(r>=i&&r<=i+1&&a>=i&&a<=i+1))throw new M("Error");var u=e+i,c=t;c[u]=c[u]+n.direction*(o-s)*(1-(r-i+(a-i))/2)}}}},Se.stbtt__fill_active_edges_new=function(t,e,i,n,r,s){for(var a=s+1;null!=r;){if(!(r.ey>=s))throw new M("Error");if(0==r.fdx){var o=r.fx;o<n&&(o>=0?(Se.stbtt__handle_clipped_edge(t,0,0|o,r,o,s,o,a),Se.stbtt__handle_clipped_edge(e,i-1,o+1|0,r,o,s,o,a)):Se.stbtt__handle_clipped_edge(e,i-1,0,r,o,s,o,a))}else{var l,h,u,c,d=r.fx,_=r.fdx,f=d+_,p=r.fdy;if(!(r.sy<=a&&r.ey>=s))throw new M("Error");if(r.sy>s?(l=d+_*(r.sy-s),u=r.sy):(l=d,u=s),r.ey<a?(h=d+_*(r.ey-s),c=r.ey):(h=f,c=a),l>=0&&h>=0&&l<n&&h<n)if((0|l)==(0|h)){var g=0|l,v=c-u;if(!(g>=0&&g<n))throw new M("Error");var m=g,w=t;w[m]=w[m]+r.direction*(1-(l-g+(h-g))/2)*v;var b=i+g,S=e;S[b]=S[b]+r.direction*v}else{if(l>h){var y=u=a-(u-s);u=c=a-(c-s),c=y,y=h,h=l,l=y,_=-_,p=-p,y=d,d=f,f=y}var x=0|l,T=0|h,E=(x+1-d)*p+s,k=r.direction,C=k*(E-u),I=x,B=t;B[I]=B[I]+C*(1-(l-x+(x+1-x))/2);for(var L=k*p,A=x+1,N=T;A<N;){var V=A++,R=t;R[V]=R[V]+(C+L/2),C+=L}if(E+=p*(T-(x+1)),!(Math.abs(C)<=1.01))throw new M("Error");var P=T,D=t;D[P]=D[P]+(C+k*(1-(T-T+(h-T))/2)*(c-E));var F=i+T,O=e;O[F]=O[F]+k*(c-u)}else for(var W=0,U=n;W<U;){var H=W++,G=s,z=H,Y=H+1,X=f,K=a,Z=(H-d)/_+s,j=(H+1-d)/_+s;d<z&&X>Y?(Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,z,Z),Se.stbtt__handle_clipped_edge(t,0,H,r,z,Z,Y,j),Se.stbtt__handle_clipped_edge(t,0,H,r,Y,j,X,K)):X<z&&d>Y?(Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,Y,j),Se.stbtt__handle_clipped_edge(t,0,H,r,Y,j,z,Z),Se.stbtt__handle_clipped_edge(t,0,H,r,z,Z,X,K)):d<z&&X>z?(Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,z,Z),Se.stbtt__handle_clipped_edge(t,0,H,r,z,Z,X,K)):X<z&&d>z?(Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,z,Z),Se.stbtt__handle_clipped_edge(t,0,H,r,z,Z,X,K)):d<Y&&X>Y?(Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,Y,j),Se.stbtt__handle_clipped_edge(t,0,H,r,Y,j,X,K)):X<Y&&d>Y?(Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,Y,j),Se.stbtt__handle_clipped_edge(t,0,H,r,Y,j,X,K)):Se.stbtt__handle_clipped_edge(t,0,H,r,d,G,X,K)}}r=r.next}},Se.stbtt__rasterize_sorted_edges=function(t,e,i,n,r,s){var a,o,l=null,h=0,u=0;t.w>64?a=new Array(2*t.w+1):a=new Array(129);var c=a;o=t.w;var d=s;for(e[u+i].y0=s+t.h+1;h<t.h;){for(var _=d+0,f=d+1,p=l,g=null,v=0,m=t.w;v<m;){a[v++]=0}for(var w=0,b=t.w+1;w<b;){c[o+w++]=0}for(;null!=p;){var S=p;if(S.ey<=_){if(null==g?(l=S.next,p=S.next):(g.next=S.next,p=S.next),0==S.direction)throw new M("Error");S.direction=0}else g=p,p=p.next}for(;e[u].y0<=f;){if(e[u].y0!=e[u].y1){var y=Se.stbtt__new_active(e,u,r,_);if(!(y.ey>=_))throw new M("Error");y.next=l,l=y}++u}null!=l&&Se.stbtt__fill_active_edges_new(a,c,o+1,t.w,l,_);for(var x=0,T=0,E=t.w;T<E;){var k=T++;x+=c[o+k];var C=a[k]+x,I=0|(C=255*Math.abs(C)+.5);I>255&&(I=255),t.pixels.writeU8(t.pixels_offset+h*t.stride+k,I)}for(g=null,p=l;null!=p;){var B=p;B.fx+=B.fdx,g=p,p=p.next}++d,++h}},Se.STBTT__COMPARE=function(t,e){return t.y0<e.y0},Se.stbtt__sort_edges_ins_sort=function(t,e){for(var i,n=1,r=e;n<r;){var s=n++,a=t[s],o=a;for(i=s;i>0;){var l=t[i-1];if(!Se.STBTT__COMPARE(o,l))break;t[i]=t[i-1],--i}s!=i&&(t[i]=a)}},Se.stbtt__sort_edges_quicksort=function(t,e,i){for(;i>12;){var n,r=i>>1,s=Se.STBTT__COMPARE(t[e],t[e+r]),a=Se.STBTT__COMPARE(t[e+r],t[e+i-1]);if(s!=a){var o=Se.STBTT__COMPARE(t[e],t[e+i-1])==a?0:i-1;n=t[e+o],t[e+o]=t[e+r],t[e+r]=n}n=t[e],t[e]=t[e+r],t[e+r]=n;for(var l=1,h=i-1;;){for(;Se.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;Se.STBTT__COMPARE(t[e],t[e+h]);)--h;if(l>=h)break;n=t[e+l],t[e+l]=t[e+h],t[e+h]=n,++l,--h}h<i-l?(Se.stbtt__sort_edges_quicksort(t,e,h),e+=l,i-=l):(Se.stbtt__sort_edges_quicksort(t,e+l,i-l),i=h)}},Se.stbtt__sort_edges=function(t,e){Se.stbtt__sort_edges_quicksort(t,0,e),Se.stbtt__sort_edges_ins_sort(t,e)},Se.stbtt__rasterize=function(t,e,i,n,r,s,a,o,l,h,u){for(var c,d=u?-s:s,_=0,f=0,p=n;f<p;){_+=i[f++]}var g=new Array(_+1);if(null!=g){for(var v=0,m=g.length;v<m;){g[v++]=new me}_=0;for(var w=0,b=0,S=n;b<S;){var y=b++,x=e,T=0+w;w+=i[y],c=i[y]-1;for(var E=0,k=i[y];E<k;){var C=E++,I=C,B=c;x[T+c].y!=x[T+C].y?(g[_].invert=!1,(u?x[T+c].y>x[T+C].y:x[T+c].y<x[T+C].y)&&(g[_].invert=!0,I=c,B=C),g[_].x0=x[T+I].x*r+a,g[_].y0=1*(x[T+I].y*d+o),g[_].x1=x[T+B].x*r+a,g[_].y1=1*(x[T+B].y*d+o),++_,c=C):c=C}}Se.stbtt__sort_edges(g,_),Se.stbtt__rasterize_sorted_edges(t,g,_,1,l,h)}},Se.stbtt__add_point=function(t,e,i,n){null!=t&&(t[e].x=i,t[e].y=n)},Se.stbtt__tesselate_curve=function(t,e,i,n,r,s,a,o,l,h){var u=(i+2*r+a)/4,c=(n+2*s+o)/4,d=(i+a)/2-u,_=(n+o)/2-c;return h>16?1:(d*d+_*_>l?(Se.stbtt__tesselate_curve(t,e,i,n,(i+r)/2,(n+s)/2,u,c,l,h+1),Se.stbtt__tesselate_curve(t,e,u,c,(r+a)/2,(s+o)/2,a,o,l,h+1)):(Se.stbtt__add_point(t,e.value,a,o),e.value+=1),1)},Se.stbtt_FlattenCurves=function(t,e,i,n,r){for(var s=null,a=0,o=i*i,l=0,h=0,u=0,c=e;u<c;){1==t[u++].type&&++l}if(r.value=l,0==l)return null;var d=new Array(l);if(n.value=d,null==n.value)return r.value=0,null;for(var _=0;_<2;){var f=0,p=0;if(1==_++){if(null==(s=new Array(a)))return n.value=null,r.value=0,null;for(var g=0,v=s.length;g<v;){s[g++]=new be}}a=0,l=-1;for(var m=0,w=e;m<w;){var b=m++;switch(t[b].type){case 1:l>=0&&(n.value[l]=a-h),++l,h=a,f=t[b].x,p=t[b].y,Se.stbtt__add_point(s,a++,f,p);break;case 2:f=t[b].x,p=t[b].y,Se.stbtt__add_point(s,a++,f,p);break;case 3:var S={value:a};Se.stbtt__tesselate_curve(s,S,f,p,t[b].cx,t[b].cy,t[b].x,t[b].y,o,0),a=S.value,f=t[b].x,p=t[b].y}}n.value[l]=a-h}return s},Se.stbtt_Rasterize=function(t,e,i,n,r,s,a,o,l,h,u){var c,d=r>s?s:r,_=0,f={value:_},p=new se,g=Se.stbtt_FlattenCurves(i,n,e/d,p,f);_=f.value,c=p.value,null!=g&&Se.stbtt__rasterize(t,g,c,_,r,s,a,o,l,h,u)},Se.stbtt_GetGlyphBitmapSubpixel=function(t,e,i,n,r,s,a){var o=new ve,l=Se.stbtt_GetGlyphShape(t,s),h=l.length;if(0==e&&(e=i),0==i){if(0==e)return null;i=e}var u=Se.stbtt_GetGlyphBitmapBoxSubpixel(t,s,e,i,n,r),c=u.x0,d=u.y0,_=u.x1,f=u.y1;return o.w=_-c,o.h=f-d,o.pixels=null,a.width=o.w,a.height=o.h,a.xoff=c,a.yoff=d,0!=o.w&&0!=o.h&&(o.pixels=Je.alloc(o.w*o.h),null!=o.pixels&&(o.stride=o.w,Se.stbtt_Rasterize(o,.35,l,h,e,i,n,r,c,d,!0))),o.pixels},Se.stbtt_GetGlyphBitmap=function(t,e,i,n,r){return Se.stbtt_GetGlyphBitmapSubpixel(t,e,i,0,0,n,r)},Se.stbtt_MakeGlyphBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,h,u){var c,d,_=Se.stbtt_GetGlyphShape(t,u),f=null==_?0:_.length,p=new ve,g=Se.stbtt_GetGlyphBitmapBoxSubpixel(t,u,a,o,l,h);c=g.x0,d=g.y0,p.pixels=e,p.pixels_offset=i,p.w=n,p.h=r,p.stride=s,0!=p.w&&0!=p.h&&Se.stbtt_Rasterize(p,.35,_,f,a,o,l,h,c,d,!0)},Se.stbtt_MakeGlyphBitmap=function(t,e,i,n,r,s,a,o,l){Se.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},Se.stbtt_GetCodepointBitmapSubpixel=function(t,e,i,n,r,s,a){return Se.stbtt_GetGlyphBitmapSubpixel(t,e,i,n,r,Se.stbtt_FindGlyphIndex(t,s),a)},Se.stbtt_MakeCodepointBitmapSubpixel=function(t,e,i,n,r,s,a,o,l,h,u){Se.stbtt_MakeGlyphBitmapSubpixel(t,e,i,n,r,s,a,o,l,h,Se.stbtt_FindGlyphIndex(t,u))},Se.stbtt_GetCodepointBitmap=function(t,e,i,n,r){return Se.stbtt_GetCodepointBitmapSubpixel(t,e,i,0,0,n,r)},Se.stbtt_MakeCodepointBitmap=function(t,e,i,n,r,s,a,o,l){Se.stbtt_MakeCodepointBitmapSubpixel(t,e,i,n,r,s,a,o,0,0,l)},Se.stbtt_BakeFontBitmap=function(t,e,i,n,r,s,a,o){var l=new pe;if(!Se.stbtt_InitFont(l,t,e))return-1;for(var h=1,u=h,c=1,d=Se.stbtt_ScaleForPixelHeight(l,i),_=0,f=0;f<a.length;){var p=a[f];++f;var g=Se.stbtt_FindGlyphIndex(l,p),v=Se.stbtt_GetGlyphHMetrics(l,g),m=v.advanceWidth,w=(v.leftSideBearing,Se.stbtt_GetGlyphBitmapBox(l,g,d,d)),b=w.x0,S=w.y0,y=w.x1-b,x=w.y1-S;if(u+y+1>=r&&(h=c,u=1),h+x+1>=s)return-_;if(u+y>=r)throw new M("Error");if(h+x>=s)throw new M("Error");o[_].x0=u,o[_].y0=h,o[_].x1=u+y,o[_].y1=h+x,o[_].xadvance=d*m,o[_].xoff=b,o[_].yoff=S,u=u+y+1,h+x+1>c&&(c=h+x+1),++_}for(var T,E=0,k=r*s;E<k;){var C=E++;n.writeU8(C,0)}_=0;for(var I=0;I<a.length;){var B=a[I];++I;var L=Se.stbtt_FindGlyphIndex(l,B);T=o[_],Se.stbtt_MakeGlyphBitmap(l,n,T.x0+T.y0*r,T.x1-T.x0,T.y1-T.y0,r,d,d,L),++_}return c},Se.stbtt_GetBakedQuad=function(t,e,i,n,r,s,a,o){var l=o?0:-.5,h=1/e,u=1/i,c=t[n],d=Math.floor(r.value+c.xoff+.5),_=Math.floor(s.value+c.yoff+.5);a.x0=d+l,a.y0=_+l,a.x1=d+c.x1-c.x0+l,a.y1=_+c.y1-c.y0+l,a.s0=c.x0*h,a.t0=c.y0*u,a.s1=c.x1*h,a.t1=c.y1*u,r.value+=c.xadvance};var ye=function(){};n["kha.graphics4.ConstantLocation"]=ye,ye.__name__=!0;var xe=function(t){this.texture_=t};n["kha.graphics4.CubeMap"]=xe,xe.__name__=!0,xe.__interfaces__=[q,Y],xe.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 3:return 4;case 4:return 1;default:return 0}},xe.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},xe.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},xe.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;default:return 1}},xe.createRenderTarget=function(t,e,i,n){null==n&&(n=0),null==i&&(i=0),null==e&&(e=0);var r=new xe(null);return r.format=e,r.renderTarget_=Krom.createRenderTargetCubeMap(t,xe.getDepthBufferBits(i),xe.getRenderTargetFormat(e),xe.getStencilBufferBits(i),n),r},xe.prototype={texture_:null,renderTarget_:null,format:null,graphics4:null,unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},width:null,get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},height:null,get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},g1:null,get_g1:function(){return null},g2:null,get_g2:function(){return null},g4:null,get_g4:function(){return null==this.graphics4&&(this.graphics4=new qe(this)),this.graphics4},__class__:xe};var Te=function(t,e){null!=t&&(this.shader=Krom.createFragmentShader(t[0].bytes.b.bufferValue,e[0]))};n["kha.graphics4.FragmentShader"]=Te,Te.__name__=!0,Te.fromSource=function(t){var e=new Te(null,null);return e.shader=Krom.createFragmentShaderFromSource(t),e},Te.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Te};var Ee=function(t,e){this.shader=Krom.createGeometryShader(t[0].bytes.b.bufferValue,e[0])};n["kha.graphics4.GeometryShader"]=Ee,Ee.__name__=!0,Ee.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Ee};var ke=function(){};n["kha.graphics4.Graphics"]=ke,ke.__name__=!0,ke.prototype={begin:null,beginFace:null,beginEye:null,end:null,vsynced:null,refreshRate:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setTextureArray:null,setVideoTexture:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setTextureCompareMode:null,setCubeMapCompareMode:null,setCubeMap:null,setCubeMapDepth:null,setStencilReferenceValue:null,instancedRenderingAvailable:null,setPipeline:null,setBool:null,setInt:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setVector2:null,setVector3:null,setVector4:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,flush:null,__class__:ke};var Ce=function(t){this.pipeline=t,this.projectionLocation=t.getConstantLocation("projectionMatrix"),this.textureLocation=t.getTextureUnit("tex")};n["kha.graphics4.PipelineCache"]=Ce,Ce.__name__=!0,Ce.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:Ce};var Ie=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,Ie.bufferIndex=0,Ie.initShaders(),this.myPipeline=Ie.standardImagePipeline,this.initBuffers()};n["kha.graphics4.ImageShaderPainter"]=Ie,Ie.__name__=!0,Ie.initShaders=function(){if(null==Ie.structure&&(Ie.structure=Ae.createImageVertexStructure()),null==Ie.standardImagePipeline){var t=Ae.createImagePipeline(Ie.structure);t.compile(),Ie.standardImagePipeline=new Ce(t)}},Ie.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Ie.standardImagePipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ie.rectVertexBuffer){Ie.rectVertexBuffer=new Oe(6e3,Ie.structure,1),Ie.rectVertices=Ie.rectVertexBuffer.lock(),Ie.indexBuffer=new Ne(9e3,0);for(var t=Ie.indexBuffer.lock(),e=0;e<1500;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Ie.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Ie.bufferIndex*4;Ie.rectVertices[l]=t,Ie.rectVertices[l+1]=e,Ie.rectVertices[l+2]=-5,Ie.rectVertices[l+9]=i,Ie.rectVertices[l+10]=n,Ie.rectVertices[l+11]=-5,Ie.rectVertices[l+18]=r,Ie.rectVertices[l+19]=s,Ie.rectVertices[l+20]=-5,Ie.rectVertices[l+27]=a,Ie.rectVertices[l+28]=o,Ie.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Ie.bufferIndex*4;Ie.rectVertices[r+3]=t,Ie.rectVertices[r+4]=n,Ie.rectVertices[r+12]=t,Ie.rectVertices[r+13]=e,Ie.rectVertices[r+21]=i,Ie.rectVertices[r+22]=e,Ie.rectVertices[r+30]=i,Ie.rectVertices[r+31]=n},setRectColor:function(t,e,i,n){var r=9*Ie.bufferIndex*4;Ie.rectVertices[r+5]=t,Ie.rectVertices[r+6]=e,Ie.rectVertices[r+7]=i,Ie.rectVertices[r+8]=n,Ie.rectVertices[r+14]=t,Ie.rectVertices[r+15]=e,Ie.rectVertices[r+16]=i,Ie.rectVertices[r+17]=n,Ie.rectVertices[r+23]=t,Ie.rectVertices[r+24]=e,Ie.rectVertices[r+25]=i,Ie.rectVertices[r+26]=n,Ie.rectVertices[r+32]=t,Ie.rectVertices[r+33]=e,Ie.rectVertices[r+34]=i,Ie.rectVertices[r+35]=n},drawBuffer:function(){Ie.rectVertexBuffer.unlock(4*Ie.bufferIndex),this.g.setVertexBuffer(Ie.rectVertexBuffer),this.g.setIndexBuffer(Ie.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Ie.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ie.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Ie.bufferIndex=0,Ie.rectVertices=Ie.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setBilinearMipmapFilter:function(t){this.end(),this.bilinearMipmaps=t},drawImage:function(t,e,i,n,r,s,a,o,l,h,u){var c=t;(Ie.bufferIndex+1>=1500||null!=Ie.lastTexture&&c!=Ie.lastTexture)&&this.drawBuffer();var d=.00392156862745098*((16711680&u)>>>16),_=.00392156862745098*((65280&u)>>>8),f=.00392156862745098*(255&u),p=.00392156862745098*(u>>>24)*h,g=9*Ie.bufferIndex*4;Ie.rectVertices[g+5]=d,Ie.rectVertices[g+6]=_,Ie.rectVertices[g+7]=f,Ie.rectVertices[g+8]=p,Ie.rectVertices[g+14]=d,Ie.rectVertices[g+15]=_,Ie.rectVertices[g+16]=f,Ie.rectVertices[g+17]=p,Ie.rectVertices[g+23]=d,Ie.rectVertices[g+24]=_,Ie.rectVertices[g+25]=f,Ie.rectVertices[g+26]=p,Ie.rectVertices[g+32]=d,Ie.rectVertices[g+33]=_,Ie.rectVertices[g+34]=f,Ie.rectVertices[g+35]=p;var v=c.get_width()/c.get_realWidth(),m=c.get_height()/c.get_realHeight(),w=9*Ie.bufferIndex*4;Ie.rectVertices[w+3]=0,Ie.rectVertices[w+4]=m,Ie.rectVertices[w+12]=0,Ie.rectVertices[w+13]=0,Ie.rectVertices[w+21]=v,Ie.rectVertices[w+22]=0,Ie.rectVertices[w+30]=v,Ie.rectVertices[w+31]=m;var b=9*Ie.bufferIndex*4;Ie.rectVertices[b]=e,Ie.rectVertices[b+1]=i,Ie.rectVertices[b+2]=-5,Ie.rectVertices[b+9]=n,Ie.rectVertices[b+10]=r,Ie.rectVertices[b+11]=-5,Ie.rectVertices[b+18]=s,Ie.rectVertices[b+19]=a,Ie.rectVertices[b+20]=-5,Ie.rectVertices[b+27]=o,Ie.rectVertices[b+28]=l,Ie.rectVertices[b+29]=-5,++Ie.bufferIndex,Ie.lastTexture=c},drawImage2:function(t,e,i,n,r,s,a,o,l,h,u,c,d,_,f){var p=t;(Ie.bufferIndex+1>=1500||null!=Ie.lastTexture&&p!=Ie.lastTexture)&&this.drawBuffer();var g=e/p.get_realWidth(),v=i/p.get_realHeight(),m=(e+n)/p.get_realWidth(),w=(i+r)/p.get_realHeight(),b=9*Ie.bufferIndex*4;Ie.rectVertices[b+3]=g,Ie.rectVertices[b+4]=w,Ie.rectVertices[b+12]=g,Ie.rectVertices[b+13]=v,Ie.rectVertices[b+21]=m,Ie.rectVertices[b+22]=v,Ie.rectVertices[b+30]=m,Ie.rectVertices[b+31]=w;var S=.00392156862745098*((16711680&f)>>>16),y=.00392156862745098*((65280&f)>>>8),x=.00392156862745098*(255&f),T=.00392156862745098*(f>>>24)*_,E=9*Ie.bufferIndex*4;Ie.rectVertices[E+5]=S,Ie.rectVertices[E+6]=y,Ie.rectVertices[E+7]=x,Ie.rectVertices[E+8]=T,Ie.rectVertices[E+14]=S,Ie.rectVertices[E+15]=y,Ie.rectVertices[E+16]=x,Ie.rectVertices[E+17]=T,Ie.rectVertices[E+23]=S,Ie.rectVertices[E+24]=y,Ie.rectVertices[E+25]=x,Ie.rectVertices[E+26]=T,Ie.rectVertices[E+32]=S,Ie.rectVertices[E+33]=y,Ie.rectVertices[E+34]=x,Ie.rectVertices[E+35]=T;var k=9*Ie.bufferIndex*4;Ie.rectVertices[k]=s,Ie.rectVertices[k+1]=a,Ie.rectVertices[k+2]=-5,Ie.rectVertices[k+9]=o,Ie.rectVertices[k+10]=l,Ie.rectVertices[k+11]=-5,Ie.rectVertices[k+18]=h,Ie.rectVertices[k+19]=u,Ie.rectVertices[k+20]=-5,Ie.rectVertices[k+27]=c,Ie.rectVertices[k+28]=d,Ie.rectVertices[k+29]=-5,++Ie.bufferIndex,Ie.lastTexture=p},drawImageScale:function(t,e,i,n,r,s,a,o,l,h,u){var c=t;(Ie.bufferIndex+1>=1500||null!=Ie.lastTexture&&c!=Ie.lastTexture)&&this.drawBuffer();var d=e/c.get_realWidth(),_=i/c.get_realHeight(),f=(e+n)/c.get_realWidth(),p=(i+r)/c.get_realHeight(),g=9*Ie.bufferIndex*4;Ie.rectVertices[g+3]=d,Ie.rectVertices[g+4]=p,Ie.rectVertices[g+12]=d,Ie.rectVertices[g+13]=_,Ie.rectVertices[g+21]=f,Ie.rectVertices[g+22]=_,Ie.rectVertices[g+30]=f,Ie.rectVertices[g+31]=p;var v=.00392156862745098*((16711680&u)>>>16),m=.00392156862745098*((65280&u)>>>8),w=.00392156862745098*(255&u),b=9*Ie.bufferIndex*4;Ie.rectVertices[b+5]=v,Ie.rectVertices[b+6]=m,Ie.rectVertices[b+7]=w,Ie.rectVertices[b+8]=h,Ie.rectVertices[b+14]=v,Ie.rectVertices[b+15]=m,Ie.rectVertices[b+16]=w,Ie.rectVertices[b+17]=h,Ie.rectVertices[b+23]=v,Ie.rectVertices[b+24]=m,Ie.rectVertices[b+25]=w,Ie.rectVertices[b+26]=h,Ie.rectVertices[b+32]=v,Ie.rectVertices[b+33]=m,Ie.rectVertices[b+34]=w,Ie.rectVertices[b+35]=h;var S=9*Ie.bufferIndex*4;Ie.rectVertices[S]=s,Ie.rectVertices[S+1]=l,Ie.rectVertices[S+2]=-5,Ie.rectVertices[S+9]=s,Ie.rectVertices[S+10]=a,Ie.rectVertices[S+11]=-5,Ie.rectVertices[S+18]=o,Ie.rectVertices[S+19]=a,Ie.rectVertices[S+20]=-5,Ie.rectVertices[S+27]=o,Ie.rectVertices[S+28]=l,Ie.rectVertices[S+29]=-5,++Ie.bufferIndex,Ie.lastTexture=c},end:function(){Ie.bufferIndex>0&&this.drawBuffer(),Ie.lastTexture=null},__class__:Ie};var Be=function(t){this.myPipeline=null,this.g=t,Be.bufferIndex=0,Be.triangleBufferIndex=0,Be.initShaders(),this.myPipeline=Be.standardColorPipeline,this.initBuffers()};n["kha.graphics4.ColoredShaderPainter"]=Be,Be.__name__=!0,Be.initShaders=function(){if(null==Be.structure&&(Be.structure=Ae.createColoredVertexStructure()),null==Be.standardColorPipeline){var t=Ae.createColoredPipeline(Be.structure);t.compile(),Be.standardColorPipeline=new Ce(t)}},Be.prototype={projectionMatrix:null,g:null,myPipeline:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Be.standardColorPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Be.rectVertexBuffer){Be.rectVertexBuffer=new Oe(4e3,Be.structure,1),Be.rectVertices=Be.rectVertexBuffer.lock(),Be.indexBuffer=new Ne(6e3,0);for(var t=Be.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Be.indexBuffer.unlock(),Be.triangleVertexBuffer=new Oe(3e3,Be.structure,1),Be.triangleVertices=Be.triangleVertexBuffer.lock(),Be.triangleIndexBuffer=new Ne(3e3,0);for(var n=Be.triangleIndexBuffer.lock(),r=0;r<1e3;){var s=r++;n[3*s]=3*s,n[3*s+1]=3*s+1,n[3*s+2]=3*s+2}Be.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=7*Be.bufferIndex*4;Be.rectVertices[l]=t,Be.rectVertices[l+1]=e,Be.rectVertices[l+2]=-5,Be.rectVertices[l+7]=i,Be.rectVertices[l+8]=n,Be.rectVertices[l+9]=-5,Be.rectVertices[l+14]=r,Be.rectVertices[l+15]=s,Be.rectVertices[l+16]=-5,Be.rectVertices[l+21]=a,Be.rectVertices[l+22]=o,Be.rectVertices[l+23]=-5},setRectColors:function(t,e){var i=7*Be.bufferIndex*4,n=t*(.00392156862745098*(e>>>24)),r=n*(.00392156862745098*((16711680&e)>>>16)),s=n*(.00392156862745098*((65280&e)>>>8)),a=n*(.00392156862745098*(255&e));Be.rectVertices[i+3]=r,Be.rectVertices[i+4]=s,Be.rectVertices[i+5]=a,Be.rectVertices[i+6]=n,Be.rectVertices[i+10]=r,Be.rectVertices[i+11]=s,Be.rectVertices[i+12]=a,Be.rectVertices[i+13]=n,Be.rectVertices[i+17]=r,Be.rectVertices[i+18]=s,Be.rectVertices[i+19]=a,Be.rectVertices[i+20]=n,Be.rectVertices[i+24]=r,Be.rectVertices[i+25]=s,Be.rectVertices[i+26]=a,Be.rectVertices[i+27]=n},setTriVertices:function(t,e,i,n,r,s){var a=7*Be.triangleBufferIndex*3;Be.triangleVertices[a]=t,Be.triangleVertices[a+1]=e,Be.triangleVertices[a+2]=-5,Be.triangleVertices[a+7]=i,Be.triangleVertices[a+8]=n,Be.triangleVertices[a+9]=-5,Be.triangleVertices[a+14]=r,Be.triangleVertices[a+15]=s,Be.triangleVertices[a+16]=-5},setTriColors:function(t,e){var i=7*Be.triangleBufferIndex*3,n=t*(.00392156862745098*(e>>>24)),r=n*(.00392156862745098*((16711680&e)>>>16)),s=n*(.00392156862745098*((65280&e)>>>8)),a=n*(.00392156862745098*(255&e));Be.triangleVertices[i+3]=r,Be.triangleVertices[i+4]=s,Be.triangleVertices[i+5]=a,Be.triangleVertices[i+6]=n,Be.triangleVertices[i+10]=r,Be.triangleVertices[i+11]=s,Be.triangleVertices[i+12]=a,Be.triangleVertices[i+13]=n,Be.triangleVertices[i+17]=r,Be.triangleVertices[i+18]=s,Be.triangleVertices[i+19]=a,Be.triangleVertices[i+20]=n},drawBuffer:function(t){t||Be.triangleBufferIndex>0&&this.drawTriBuffer(!0),Be.rectVertexBuffer.unlock(4*Be.bufferIndex),this.g.setVertexBuffer(Be.rectVertexBuffer),this.g.setIndexBuffer(Be.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Be.bufferIndex*3),Be.bufferIndex=0,Be.rectVertices=Be.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||Be.bufferIndex>0&&this.drawBuffer(!0),Be.triangleVertexBuffer.unlock(3*Be.triangleBufferIndex),this.g.setVertexBuffer(Be.triangleVertexBuffer),this.g.setIndexBuffer(Be.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Be.triangleBufferIndex),Be.triangleBufferIndex=0,Be.triangleVertices=Be.triangleVertexBuffer.lock()},fillRect:function(t,e,i,n,r,s,a,o,l,h){Be.triangleBufferIndex>0&&this.drawTriBuffer(!0),Be.bufferIndex+1>=1e3&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(i,n,r,s,a,o,l,h),++Be.bufferIndex},fillTriangle:function(t,e,i,n,r,s,a,o){Be.bufferIndex>0&&this.drawBuffer(!0),Be.triangleBufferIndex+1>=1e3&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(i,n,r,s,a,o),++Be.triangleBufferIndex},endTris:function(t){Be.triangleBufferIndex>0&&this.drawTriBuffer(t)},endRects:function(t){Be.bufferIndex>0&&this.drawBuffer(t)},end:function(){Be.triangleBufferIndex>0&&this.drawTriBuffer(!1),Be.bufferIndex>0&&this.drawBuffer(!1)},__class__:Be};var Le=function(t){this.bakedQuadCache=new tt,this.bilinear=!1,this.myPipeline=null,this.g=t,Le.bufferIndex=0,Le.initShaders(),this.myPipeline=Le.standardTextPipeline,this.initBuffers()};n["kha.graphics4.TextShaderPainter"]=Le,Le.__name__=!0,Le.initShaders=function(){if(null==Le.structure&&(Le.structure=Ae.createTextVertexStructure()),null==Le.standardTextPipeline){var t=Ae.createTextPipeline(Le.structure);t.compile(),Le.standardTextPipeline=new Ce(t)}},Le.findIndex=function(t){ie.fontGlyphs;for(var e=et.charBlocks,i=0,n=0,r=e.length/2|0;n<r;){var s=n++,a=e[2*s],o=e[2*s+1];if(t>=a&&t<=o)return i+t-a;i+=o-a+1}return 0},Le.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},set_pipeline:function(t){return this.myPipeline=null!=t?t:Le.standardTextPipeline,this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Le.rectVertexBuffer){Le.rectVertexBuffer=new Oe(4e3,Le.structure,1),Le.rectVertices=Le.rectVertexBuffer.lock(),Le.indexBuffer=new Ne(6e3,0);for(var t=Le.indexBuffer.lock(),e=0;e<1e3;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}Le.indexBuffer.unlock()}},setRectVertices:function(t,e,i,n,r,s,a,o){var l=9*Le.bufferIndex*4;Le.rectVertices[l]=t,Le.rectVertices[l+1]=e,Le.rectVertices[l+2]=-5,Le.rectVertices[l+9]=i,Le.rectVertices[l+10]=n,Le.rectVertices[l+11]=-5,Le.rectVertices[l+18]=r,Le.rectVertices[l+19]=s,Le.rectVertices[l+20]=-5,Le.rectVertices[l+27]=a,Le.rectVertices[l+28]=o,Le.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,i,n){var r=9*Le.bufferIndex*4;Le.rectVertices[r+3]=t,Le.rectVertices[r+4]=n,Le.rectVertices[r+12]=t,Le.rectVertices[r+13]=e,Le.rectVertices[r+21]=i,Le.rectVertices[r+22]=e,Le.rectVertices[r+30]=i,Le.rectVertices[r+31]=n},setRectColors:function(t,e){var i=9*Le.bufferIndex*4,n=t*(.00392156862745098*(e>>>24));Le.rectVertices[i+5]=.00392156862745098*((16711680&e)>>>16),Le.rectVertices[i+6]=.00392156862745098*((65280&e)>>>8),Le.rectVertices[i+7]=.00392156862745098*(255&e),Le.rectVertices[i+8]=n,Le.rectVertices[i+14]=.00392156862745098*((16711680&e)>>>16),Le.rectVertices[i+15]=.00392156862745098*((65280&e)>>>8),Le.rectVertices[i+16]=.00392156862745098*(255&e),Le.rectVertices[i+17]=n,Le.rectVertices[i+23]=.00392156862745098*((16711680&e)>>>16),Le.rectVertices[i+24]=.00392156862745098*((65280&e)>>>8),Le.rectVertices[i+25]=.00392156862745098*(255&e),Le.rectVertices[i+26]=n,Le.rectVertices[i+32]=.00392156862745098*((16711680&e)>>>16),Le.rectVertices[i+33]=.00392156862745098*((65280&e)>>>8),Le.rectVertices[i+34]=.00392156862745098*(255&e),Le.rectVertices[i+35]=n},drawBuffer:function(){Le.rectVertexBuffer.unlock(4*Le.bufferIndex),this.g.setVertexBuffer(Le.rectVertexBuffer),this.g.setIndexBuffer(Le.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,Le.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*Le.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),Le.bufferIndex=0,Le.rectVertices=Le.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=D.__cast(t,it)},bakedQuadCache:null,drawString:function(t,e,i,n,r,s){var a=this.font._get(this.fontSize),o=a.getTexture();null!=Le.lastTexture&&o!=Le.lastTexture&&this.drawBuffer(),Le.lastTexture=o;for(var l=n,h=r,u=0,c=t.length;u<c;){var d=u++,_=t.charCodeAt(d),f=a.getBakedQuad(this.bakedQuadCache,Le.findIndex(_),l,h);if(null!=f){Le.bufferIndex+1>=1e3&&this.drawBuffer(),this.setRectColors(e,i),this.setRectTexCoords(f.s0*o.get_width()/o.get_realWidth(),f.t0*o.get_height()/o.get_realHeight(),f.s1*o.get_width()/o.get_realWidth(),f.t1*o.get_height()/o.get_realHeight());var p=f.x0,g=f.y1,v=s._02*p+s._12*g+s._22,m=(s._00*p+s._10*g+s._20)/v,w=(s._01*p+s._11*g+s._21)/v,b=f.x0,S=f.y0,y=s._02*b+s._12*S+s._22,x=(s._00*b+s._10*S+s._20)/y,T=(s._01*b+s._11*S+s._21)/y,E=f.x1,k=f.y0,C=s._02*E+s._12*k+s._22,I=(s._00*E+s._10*k+s._20)/C,B=(s._01*E+s._11*k+s._21)/C,L=f.x1,A=f.y1,N=s._02*L+s._12*A+s._22,V=(s._00*L+s._10*A+s._20)/N,R=(s._01*L+s._11*A+s._21)/N;this.setRectVertices(m,w,x,T,I,B,V,R),l+=f.xadvance,++Le.bufferIndex}}},drawCharacters:function(t,e,i,n,r,s,a,o){var l=this.font._get(this.fontSize),h=l.getTexture();null!=Le.lastTexture&&h!=Le.lastTexture&&this.drawBuffer(),Le.lastTexture=h;for(var u=s,c=a,d=e,_=e+i;d<_;){var f=d++,p=l.getBakedQuad(this.bakedQuadCache,Le.findIndex(t[f]),u,c);if(null!=p){Le.bufferIndex+1>=1e3&&this.drawBuffer(),this.setRectColors(n,r),this.setRectTexCoords(p.s0*h.get_width()/h.get_realWidth(),p.t0*h.get_height()/h.get_realHeight(),p.s1*h.get_width()/h.get_realWidth(),p.t1*h.get_height()/h.get_realHeight());var g=p.x0,v=p.y1,m=o._02*g+o._12*v+o._22,w=(o._00*g+o._10*v+o._20)/m,b=(o._01*g+o._11*v+o._21)/m,S=p.x0,y=p.y0,x=o._02*S+o._12*y+o._22,T=(o._00*S+o._10*y+o._20)/x,E=(o._01*S+o._11*y+o._21)/x,k=p.x1,C=p.y0,I=o._02*k+o._12*C+o._22,B=(o._00*k+o._10*C+o._20)/I,L=(o._01*k+o._11*C+o._21)/I,A=p.x1,N=p.y1,V=o._02*A+o._12*N+o._22,R=(o._00*A+o._10*N+o._20)/V,P=(o._01*A+o._11*N+o._21)/V;this.setRectVertices(w,b,T,E,B,L,R,P),u+=p.xadvance,++Le.bufferIndex}}},end:function(){Le.bufferIndex>0&&this.drawBuffer(),Le.lastTexture=null},__class__:Le};var Ae=function(t){this.scissorH=-1,this.scissorW=-1,this.scissorY=-1,this.scissorX=-1,this.scissorEnabled=!1,this.lastPipeline=null,this.pipelineCache=new x,this.myMipmapScaleQuality=re.Low,this.myImageScaleQuality=re.Low,ie.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new Ie(this.g),this.coloredPainter=new Be(this.g),this.textPainter=new Le(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new ei(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==Ae.videoPipeline&&(Ae.videoPipeline=Ae.createImagePipeline(Ae.createImageVertexStructure()),Ae.videoPipeline.fragmentShader=lt.painter_video_frag,Ae.videoPipeline.vertexShader=lt.painter_video_vert,Ae.videoPipeline.compile())};n["kha.graphics4.Graphics2"]=Ae,Ae.__name__=!0,Ae.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},Ae.createImageVertexStructure=function(){var t=new He;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Ae.createImagePipeline=function(t){var e=new Re;return e.fragmentShader=lt.painter_image_frag,e.vertexShader=lt.painter_image_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Ae.createColoredVertexStructure=function(){var t=new He;return t.add("vertexPosition",2),t.add("vertexColor",3),t},Ae.createColoredPipeline=function(t){var e=new Re;return e.fragmentShader=lt.painter_colored_frag,e.vertexShader=lt.painter_colored_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},Ae.createTextVertexStructure=function(){var t=new He;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Ae.createTextPipeline=function(t){var e=new Re;return e.fragmentShader=lt.painter_text_frag,e.vertexShader=lt.painter_text_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},Ae.__super__=ie,Ae.prototype=a(ie.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof Q){var i=this.projectionMatrix,n=2/t,r=-t/t,s=2/(0-e),a=-e/(0-e);i._00=n,i._10=0,i._20=0,i._30=r,i._01=0,i._11=s,i._21=0,i._31=a,i._02=0,i._12=0,i._22=-.002000200020002,i._32=-1.0002000200020003,i._03=0,i._13=0,i._23=0,i._33=1}else if($.get_nonPow2Supported()||(t=Ae.upperPowerOfTwo(t),e=Ae.upperPowerOfTwo(e)),$.renderTargetsInvertedY()){var o=this.projectionMatrix,l=2/t,h=-t/t,u=2/e,c=-e/e;o._00=l,o._10=0,o._20=0,o._30=h,o._01=0,o._11=u,o._21=0,o._31=c,o._02=0,o._12=0,o._22=-.002000200020002,o._32=-1.0002000200020003,o._03=0,o._13=0,o._23=0,o._33=1}else{var d=this.projectionMatrix,_=2/t,f=-t/t,p=2/(0-e),g=-e/(0-e);d._00=_,d._10=0,d._20=0,d._30=f,d._01=0,d._11=p,d._21=0,d._31=g,d._02=0,d._12=0,d._22=-.002000200020002,d._32=-1.0002000200020003,d._03=0,d._13=0,d._23=0,d._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,i){var n=this.coloredPainter;Be.triangleBufferIndex>0&&n.drawTriBuffer(!1),Be.bufferIndex>0&&n.drawBuffer(!1),this.textPainter.end();var r=e+t.get_width(),s=i+t.get_height(),a=this.transformations[this.transformationIndex],o=e,l=s,h=a._02*o+a._12*l+a._22,u=(a._00*o+a._10*l+a._20)/h,c=(a._01*o+a._11*l+a._21)/h,d=this.transformations[this.transformationIndex],_=e,f=i,p=d._02*_+d._12*f+d._22,g=(d._00*_+d._10*f+d._20)/p,v=(d._01*_+d._11*f+d._21)/p,m=this.transformations[this.transformationIndex],w=r,b=i,S=m._02*w+m._12*b+m._22,y=(m._00*w+m._10*b+m._20)/S,x=(m._01*w+m._11*b+m._21)/S,T=this.transformations[this.transformationIndex],E=r,k=s,C=T._02*E+T._12*k+T._22,I=(T._00*E+T._10*k+T._20)/C,B=(T._01*E+T._11*k+T._21)/C,L=this.imagePainter,A=this.get_opacity(),N=this.get_color(),V=t;(Ie.bufferIndex+1>=1500||null!=Ie.lastTexture&&V!=Ie.lastTexture)&&L.drawBuffer();var R=.00392156862745098*((16711680&N)>>>16),P=.00392156862745098*((65280&N)>>>8),M=.00392156862745098*(255&N),D=.00392156862745098*(N>>>24)*A,F=9*Ie.bufferIndex*4;Ie.rectVertices[F+5]=R,Ie.rectVertices[F+6]=P,Ie.rectVertices[F+7]=M,Ie.rectVertices[F+8]=D,Ie.rectVertices[F+14]=R,Ie.rectVertices[F+15]=P,Ie.rectVertices[F+16]=M,Ie.rectVertices[F+17]=D,Ie.rectVertices[F+23]=R,Ie.rectVertices[F+24]=P,Ie.rectVertices[F+25]=M,Ie.rectVertices[F+26]=D,Ie.rectVertices[F+32]=R,Ie.rectVertices[F+33]=P,Ie.rectVertices[F+34]=M,Ie.rectVertices[F+35]=D;var O=V.get_width()/V.get_realWidth(),W=V.get_height()/V.get_realHeight(),U=9*Ie.bufferIndex*4;Ie.rectVertices[U+3]=0,Ie.rectVertices[U+4]=W,Ie.rectVertices[U+12]=0,Ie.rectVertices[U+13]=0,Ie.rectVertices[U+21]=O,Ie.rectVertices[U+22]=0,Ie.rectVertices[U+30]=O,Ie.rectVertices[U+31]=W;var H=9*Ie.bufferIndex*4;Ie.rectVertices[H]=u,Ie.rectVertices[H+1]=c,Ie.rectVertices[H+2]=-5,Ie.rectVertices[H+9]=g,Ie.rectVertices[H+10]=v,Ie.rectVertices[H+11]=-5,Ie.rectVertices[H+18]=y,Ie.rectVertices[H+19]=x,Ie.rectVertices[H+20]=-5,Ie.rectVertices[H+27]=I,Ie.rectVertices[H+28]=B,Ie.rectVertices[H+29]=-5,++Ie.bufferIndex,Ie.lastTexture=V},drawScaledSubImage:function(t,e,i,n,r,s,a,o,l){var h=this.coloredPainter;Be.triangleBufferIndex>0&&h.drawTriBuffer(!1),Be.bufferIndex>0&&h.drawBuffer(!1),this.textPainter.end();var u=this.transformations[this.transformationIndex],c=s,d=a+l,_=u._02*c+u._12*d+u._22,f=(u._00*c+u._10*d+u._20)/_,p=(u._01*c+u._11*d+u._21)/_,g=this.transformations[this.transformationIndex],v=s,m=a,w=g._02*v+g._12*m+g._22,b=(g._00*v+g._10*m+g._20)/w,S=(g._01*v+g._11*m+g._21)/w,y=this.transformations[this.transformationIndex],x=s+o,T=a,E=y._02*x+y._12*T+y._22,k=(y._00*x+y._10*T+y._20)/E,C=(y._01*x+y._11*T+y._21)/E,I=this.transformations[this.transformationIndex],B=s+o,L=a+l,A=I._02*B+I._12*L+I._22,N=(I._00*B+I._10*L+I._20)/A,V=(I._01*B+I._11*L+I._21)/A,R=this.imagePainter,P=this.get_opacity(),M=this.get_color(),D=t;(Ie.bufferIndex+1>=1500||null!=Ie.lastTexture&&D!=Ie.lastTexture)&&R.drawBuffer();var F=e/D.get_realWidth(),O=i/D.get_realHeight(),W=(e+n)/D.get_realWidth(),U=(i+r)/D.get_realHeight(),H=9*Ie.bufferIndex*4;Ie.rectVertices[H+3]=F,Ie.rectVertices[H+4]=U,Ie.rectVertices[H+12]=F,Ie.rectVertices[H+13]=O,Ie.rectVertices[H+21]=W,Ie.rectVertices[H+22]=O,Ie.rectVertices[H+30]=W,Ie.rectVertices[H+31]=U;var G=.00392156862745098*((16711680&M)>>>16),z=.00392156862745098*((65280&M)>>>8),Y=.00392156862745098*(255&M),X=.00392156862745098*(M>>>24)*P,K=9*Ie.bufferIndex*4;Ie.rectVertices[K+5]=G,Ie.rectVertices[K+6]=z,Ie.rectVertices[K+7]=Y,Ie.rectVertices[K+8]=X,Ie.rectVertices[K+14]=G,Ie.rectVertices[K+15]=z,Ie.rectVertices[K+16]=Y,Ie.rectVertices[K+17]=X,Ie.rectVertices[K+23]=G,Ie.rectVertices[K+24]=z,Ie.rectVertices[K+25]=Y,Ie.rectVertices[K+26]=X,Ie.rectVertices[K+32]=G,Ie.rectVertices[K+33]=z,Ie.rectVertices[K+34]=Y,Ie.rectVertices[K+35]=X;var Z=9*Ie.bufferIndex*4;Ie.rectVertices[Z]=f,Ie.rectVertices[Z+1]=p,Ie.rectVertices[Z+2]=-5,Ie.rectVertices[Z+9]=b,Ie.rectVertices[Z+10]=S,Ie.rectVertices[Z+11]=-5,Ie.rectVertices[Z+18]=k,Ie.rectVertices[Z+19]=C,Ie.rectVertices[Z+20]=-5,Ie.rectVertices[Z+27]=N,Ie.rectVertices[Z+28]=V,Ie.rectVertices[Z+29]=-5,++Ie.bufferIndex,Ie.lastTexture=D},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=this.transformations[this.transformationIndex],a=t-r/2,o=e+r/2,l=s._02*a+s._12*o+s._22,h=(s._00*a+s._10*o+s._20)/l,u=(s._01*a+s._11*o+s._21)/l,c=this.transformations[this.transformationIndex],d=t-r/2,_=e-r/2,f=c._02*d+c._12*_+c._22,p=(c._00*d+c._10*_+c._20)/f,g=(c._01*d+c._11*_+c._21)/f,v=this.transformations[this.transformationIndex],m=t+i+r/2,w=e-r/2,b=v._02*m+v._12*w+v._22,S=(v._00*m+v._10*w+v._20)/b,y=(v._01*m+v._11*w+v._21)/b,x=this.transformations[this.transformationIndex],T=t+i+r/2,E=e+r/2,k=x._02*T+x._12*E+x._22,C=(x._00*T+x._10*E+x._20)/k,I=(x._01*T+x._11*E+x._21)/k;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h,u,p,g,S,y,C,I);var B=this.transformations[this.transformationIndex],L=t-r/2,A=e+n-r/2,N=B._02*L+B._12*A+B._22;h=(B._00*L+B._10*A+B._20)/N,u=(B._01*L+B._11*A+B._21)/N;var V=this.transformations[this.transformationIndex],R=t-r/2,P=e+r/2,M=V._02*R+V._12*P+V._22;p=(V._00*R+V._10*P+V._20)/M,g=(V._01*R+V._11*P+V._21)/M;var D=this.transformations[this.transformationIndex],F=t+r/2,O=e+r/2,W=D._02*F+D._12*O+D._22;S=(D._00*F+D._10*O+D._20)/W,y=(D._01*F+D._11*O+D._21)/W;var U=this.transformations[this.transformationIndex],H=t+r/2,G=e+n-r/2,z=U._02*H+U._12*G+U._22;C=(U._00*H+U._10*G+U._20)/z,I=(U._01*H+U._11*G+U._21)/z,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h,u,p,g,S,y,C,I);var Y=this.transformations[this.transformationIndex],X=t-r/2,K=e+n+r/2,Z=Y._02*X+Y._12*K+Y._22;h=(Y._00*X+Y._10*K+Y._20)/Z,u=(Y._01*X+Y._11*K+Y._21)/Z;var j=this.transformations[this.transformationIndex],Q=t-r/2,J=e+n-r/2,q=j._02*Q+j._12*J+j._22;p=(j._00*Q+j._10*J+j._20)/q,g=(j._01*Q+j._11*J+j._21)/q;var $=this.transformations[this.transformationIndex],tt=t+i+r/2,et=e+n-r/2,it=$._02*tt+$._12*et+$._22;S=($._00*tt+$._10*et+$._20)/it,y=($._01*tt+$._11*et+$._21)/it;var nt=this.transformations[this.transformationIndex],rt=t+i+r/2,st=e+n+r/2,at=nt._02*rt+nt._12*st+nt._22;C=(nt._00*rt+nt._10*st+nt._20)/at,I=(nt._01*rt+nt._11*st+nt._21)/at,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h,u,p,g,S,y,C,I);var ot=this.transformations[this.transformationIndex],lt=t+i-r/2,ht=e+n-r/2,ut=ot._02*lt+ot._12*ht+ot._22;h=(ot._00*lt+ot._10*ht+ot._20)/ut,u=(ot._01*lt+ot._11*ht+ot._21)/ut;var ct=this.transformations[this.transformationIndex],dt=t+i-r/2,_t=e+r/2,ft=ct._02*dt+ct._12*_t+ct._22;p=(ct._00*dt+ct._10*_t+ct._20)/ft,g=(ct._01*dt+ct._11*_t+ct._21)/ft;var pt=this.transformations[this.transformationIndex],gt=t+i+r/2,vt=e+r/2,mt=pt._02*gt+pt._12*vt+pt._22;S=(pt._00*gt+pt._10*vt+pt._20)/mt,y=(pt._01*gt+pt._11*vt+pt._21)/mt;var wt=this.transformations[this.transformationIndex],bt=t+i+r/2,St=e+n-r/2,yt=wt._02*bt+wt._12*St+wt._22;C=(wt._00*bt+wt._10*St+wt._20)/yt,I=(wt._01*bt+wt._11*St+wt._21)/yt,this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h,u,p,g,S,y,C,I)},fillRect:function(t,e,i,n){this.imagePainter.end(),this.textPainter.end();var r=this.transformations[this.transformationIndex],s=t,a=e+n,o=r._02*s+r._12*a+r._22,l=(r._00*s+r._10*a+r._20)/o,h=(r._01*s+r._11*a+r._21)/o,u=this.transformations[this.transformationIndex],c=t,d=e,_=u._02*c+u._12*d+u._22,f=(u._00*c+u._10*d+u._20)/_,p=(u._01*c+u._11*d+u._21)/_,g=this.transformations[this.transformationIndex],v=t+i,m=e,w=g._02*v+g._12*m+g._22,b=(g._00*v+g._10*m+g._20)/w,S=(g._01*v+g._11*m+g._21)/w,y=this.transformations[this.transformationIndex],x=t+i,T=e+n,E=y._02*x+y._12*T+y._22,k=(y._00*x+y._10*T+y._20)/E,C=(y._01*x+y._11*T+y._21)/E;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),l,h,f,p,b,S,k,C)},drawString:function(t,e,i){this.imagePainter.end();var n=this.coloredPainter;Be.triangleBufferIndex>0&&n.drawTriBuffer(!1),Be.bufferIndex>0&&n.drawBuffer(!1),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,i,this.transformations[this.transformationIndex])},drawCharacters:function(t,e,i,n,r){this.imagePainter.end();var s=this.coloredPainter;Be.triangleBufferIndex>0&&s.drawTriBuffer(!1),Be.bufferIndex>0&&s.drawBuffer(!1),this.textPainter.drawCharacters(t,e,i,this.get_opacity(),this.get_color(),n,r,this.transformations[this.transformationIndex])},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return ie.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,i,n,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=0,a=0;if(n==e){s=0,a=-1}else{s=1,a=-(i-t)/(n-e)}var o=Math.sqrt(s*s+a*a);if(0!=o){var l=r/o;s*=l,a*=l}var h=t+.5*s,u=e+.5*a,c=i+.5*s,d=n+.5*a,_=h-s,f=u-a,p=c-s,g=d-a,v=this.transformations[this.transformationIndex],m=v._02*h+v._12*u+v._22,w=(v._00*h+v._10*u+v._20)/m,b=(v._01*h+v._11*u+v._21)/m;h=w,u=b;var S=this.transformations[this.transformationIndex],y=S._02*c+S._12*d+S._22,x=(S._00*c+S._10*d+S._20)/y,T=(S._01*c+S._11*d+S._21)/y;c=x,d=T;var E=this.transformations[this.transformationIndex],k=E._02*_+E._12*f+E._22,C=(E._00*_+E._10*f+E._20)/k,I=(E._01*_+E._11*f+E._21)/k;_=C,f=I;var B=this.transformations[this.transformationIndex],L=B._02*p+B._12*g+B._22,A=(B._00*p+B._10*g+B._20)/L,N=(B._01*p+B._11*g+B._21)/L;p=A,g=N,this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),h,u,c,d,_,f),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),_,f,c,d,p,g)},fillTriangle:function(t,e,i,n,r,s){this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformationIndex],o=t,l=e,h=a._02*o+a._12*l+a._22,u=(a._00*o+a._10*l+a._20)/h,c=(a._01*o+a._11*l+a._21)/h,d=this.transformations[this.transformationIndex],_=i,f=n,p=d._02*_+d._12*f+d._22,g=(d._00*_+d._10*f+d._20)/p,v=(d._01*_+d._11*f+d._21)/p,m=this.transformations[this.transformationIndex],w=r,b=s,S=m._02*w+m._12*b+m._22,y=(m._00*w+m._10*b+m._20)/S,x=(m._01*w+m._11*b+m._21)/S;this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),u,c,g,v,y,x)},myImageScaleQuality:null,get_imageScaleQuality:function(){return this.myImageScaleQuality},set_imageScaleQuality:function(t){return t==this.myImageScaleQuality?t:(this.imagePainter.setBilinearFilter(t==re.High),this.textPainter.setBilinearFilter(t==re.High),this.myImageScaleQuality=t)},myMipmapScaleQuality:null,get_mipmapScaleQuality:function(){return this.myMipmapScaleQuality},set_mipmapScaleQuality:function(t){return this.imagePainter.setBilinearMipmapFilter(t==re.High),this.myMipmapScaleQuality=t},pipelineCache:null,lastPipeline:null,setPipeline:function(t){if(t!=this.lastPipeline)if(this.lastPipeline=t,this.flush(),null==t)this.imagePainter.set_pipeline(null),this.coloredPainter.set_pipeline(null),this.textPainter.set_pipeline(null);else{var e=this.pipelineCache.h[t.__id__];null==e&&(e=new Ce(t),this.pipelineCache.set(t,e)),this.imagePainter.set_pipeline(e),this.coloredPainter.set_pipeline(e),this.textPainter.set_pipeline(e)}},scissorEnabled:null,scissorX:null,scissorY:null,scissorW:null,scissorH:null,scissor:function(t,e,i,n){this.scissorEnabled=!0,this.scissorX=t,this.scissorY=e,this.scissorW=i,this.scissorH=n,this.flush(),this.g.scissor(t,e,i,n)},disableScissor:function(){this.scissorEnabled=!1,this.flush(),this.g.disableScissor()},begin:function(t,e){if(null==t&&(t=!0),null!=Ae.current)throw new M("End before you begin");Ae.current=this,this.g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end();var t=this.coloredPainter;Be.triangleBufferIndex>0&&t.drawTriBuffer(!1),Be.bufferIndex>0&&t.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),Ae.current!=this)throw new M("Begin before you end");Ae.current=null},drawVideoInternal:function(t,e,i,n,r){},drawVideo:function(t,e,i,n,r){this.setPipeline(Ae.videoPipeline),this.drawVideoInternal(t,e,i,n,r),this.setPipeline(null)},__class__:Ae});var Ne=function(t,e,i){null==i&&(i=!1),this.indexCount=t,this.buffer=Krom.createIndexBuffer(t)};n["kha.graphics4.IndexBuffer"]=Ne,Ne.__name__=!0,Ne.prototype={buffer:null,_data:null,indexCount:null,delete:function(){Krom.deleteIndexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockIndexBuffer(this.buffer),null==t&&(t=0),null==e&&(e=this.indexCount),this._data.subarray(t,t+e)},unlock:function(){Krom.unlockIndexBuffer(this.buffer)},set:function(){Krom.setIndexBuffer(this.buffer)},count:function(){return this.indexCount},__class__:Ne};var Ve=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=Pe.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};n["kha.graphics4.PipelineStateBase"]=Ve,Ve.__name__=!0,Ve.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,set_colorWriteMask:function(t){var e=this.colorWriteMasksAlpha[0]=t,i=this.colorWriteMasksGreen[0]=e,n=this.colorWriteMasksBlue[0]=i;return this.colorWriteMasksRed[0]=n},get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},conservativeRasterization:null,__class__:Ve};var Re=function(){Ve.call(this),this.pipeline=Krom.createPipeline()};n["kha.graphics4.PipelineState"]=Re,Re.__name__=!0,Re.convertCullMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},Re.convertCompareMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7}},Re.convertStencilAction=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7}},Re.convertBlendingFactor=function(t){switch(t){case 0:case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5;case 7:return 6;case 8:return 7;case 9:return 8;case 10:return 9}},Re.__super__=Ve,Re.prototype=a(Ve.prototype,{pipeline:null,delete:function(){Krom.deletePipeline(this.pipeline),this.pipeline=null},compile:function(){var t=this.inputLayout.length>0?this.inputLayout[0]:null,e=this.inputLayout.length>1?this.inputLayout[1]:null,i=this.inputLayout.length>2?this.inputLayout[2]:null,n=this.inputLayout.length>3?this.inputLayout[3]:null,r=null!=this.geometryShader?this.geometryShader.shader:null,s=null!=this.tessellationControlShader?this.tessellationControlShader.shader:null,a=null!=this.tessellationEvaluationShader?this.tessellationEvaluationShader.shader:null,o=0,l=this.stencilReferenceValue;1==l._hx_index&&(o=l.value);Krom.compilePipeline(this.pipeline,t,e,i,n,this.inputLayout.length,this.vertexShader.shader,this.fragmentShader.shader,r,s,a,{cullMode:Re.convertCullMode(this.cullMode),depthWrite:this.depthWrite,depthMode:Re.convertCompareMode(this.depthMode),stencilMode:Re.convertCompareMode(this.stencilMode),stencilBothPass:Re.convertStencilAction(this.stencilBothPass),stencilDepthFail:Re.convertStencilAction(this.stencilDepthFail),stencilFail:Re.convertStencilAction(this.stencilFail),stencilReferenceValue:o,stencilReadMask:this.stencilReadMask,stencilWriteMask:this.stencilWriteMask,blendSource:Re.convertBlendingFactor(this.blendSource),blendDestination:Re.convertBlendingFactor(this.blendDestination),alphaBlendSource:Re.convertBlendingFactor(this.alphaBlendSource),alphaBlendDestination:Re.convertBlendingFactor(this.alphaBlendDestination),colorWriteMaskRed:this.colorWriteMasksRed,colorWriteMaskGreen:this.colorWriteMasksGreen,colorWriteMaskBlue:this.colorWriteMasksBlue,colorWriteMaskAlpha:this.colorWriteMasksAlpha,conservativeRasterization:this.conservativeRasterization})},set:function(){Krom.setPipeline(this.pipeline)},getConstantLocation:function(t){return Krom.getConstantLocation(this.pipeline,t)},getTextureUnit:function(t){return Krom.getTextureUnit(this.pipeline,t)},__class__:Re});var Pe=s["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:r},Static:(i=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:r}},i.__params__=["value"],i)},Me=function(t,e){this.shader=Krom.createTessellationControlShader(t[0].bytes.b.bufferValue,e[0])};n["kha.graphics4.TessellationControlShader"]=Me,Me.__name__=!0,Me.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Me};var De=function(t,e){this.shader=Krom.createTessellationEvaluationShader(t[0].bytes.b.bufferValue,e[0])};n["kha.graphics4.TessellationEvaluationShader"]=De,De.__name__=!0,De.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:De};var Fe=function(){};n["kha.graphics4.TextureUnit"]=Fe,Fe.__name__=!0;var Oe=function(t,e,i,n,r){null==r&&(r=!1),null==n&&(n=0),this.vertexCount=t,this.structure=e,this.buffer=Krom.createVertexBuffer(t,e.elements,i,n)};n["kha.graphics4.VertexBuffer"]=Oe,Oe.__name__=!0,Oe.prototype={buffer:null,_data:null,vertexCount:null,structure:null,delete:function(){Krom.deleteVertexBuffer(this.buffer),this.buffer=null},lock:function(t,e){return this._data=Krom.lockVertexBuffer(this.buffer),this._data},lockInt16:function(t,e){return new Int16Array(this.lock(t,e).buffer)},unlock:function(t){Krom.unlockVertexBuffer(this.buffer)},stride:function(){return this.structure.byteSize()},count:function(){return this.vertexCount},set:function(t){return Krom.setVertexBuffer(this.buffer),0},__class__:Oe};var We=function(t,e){this.name=t,this.data=e};n["kha.graphics4.VertexElement"]=We,We.__name__=!0,We.prototype={name:null,data:null,__class__:We};var Ue=function(t,e){null!=t&&(this.shader=Krom.createVertexShader(t[0].bytes.b.bufferValue,e[0]))};n["kha.graphics4.VertexShader"]=Ue,Ue.__name__=!0,Ue.fromSource=function(t){var e=new Ue(null,null);return e.shader=Krom.createVertexShaderFromSource(t),e},Ue.prototype={shader:null,delete:function(){Krom.deleteShader(this.shader),this.shader=null},__class__:Ue};var He=function(){this.elements=[],this.instanced=!1};n["kha.graphics4.VertexStructure"]=He,He.__name__=!0,He.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new We(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,i=this.elements.length;e<i;){var n=e++;t+=this.dataByteSize(this.elements[n].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64;case 5:return 4;case 6:return 8}},get:function(t){return this.elements[t]},__class__:He};var Ge=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],Ge.instances[t]=this};n["kha.input.Gamepad"]=Ge,Ge.__name__=!0,Ge.get=function(t){return null==t&&(t=0),t>=Ge.instances.length?null:Ge.instances[t]},Ge.notifyOnConnect=function(t,e){null!=t&&Ge.connectListeners.push(t),null!=e&&Ge.disconnectListeners.push(e)},Ge.removeConnect=function(t,e){null!=t&&l.remove(Ge.connectListeners,t),null!=e&&l.remove(Ge.disconnectListeners,e)},Ge.sendConnectEvent=function(t){Ge.instances[t].connected=!0;for(var e=0,i=Ge.connectListeners;e<i.length;){var n=i[e];++e,n(t)}},Ge.sendDisconnectEvent=function(t){Ge.instances[t].connected=!1;for(var e=0,i=Ge.disconnectListeners;e<i.length;){var n=i[e];++e,n(t)}},Ge.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},remove:function(t,e){null!=t&&l.remove(this.axisListeners,t),null!=e&&l.remove(this.buttonListeners,e)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return dt.getGamepadId(this.index)},sendAxisEvent:function(t,e){for(var i=0,n=this.axisListeners;i<n.length;){var r=n[i];++i,r(t,e)}},sendButtonEvent:function(t,e){for(var i=0,n=this.buttonListeners;i<n.length;){var r=n[i];++i,r(t,e)}},__class__:Ge};var ze=s["kha.input.BlockInterventions"]={__ename__:!0,__constructs__:["Default","Full","None","Custom"],Default:{_hx_index:0,__enum__:"kha.input.BlockInterventions",toString:r},Full:{_hx_index:1,__enum__:"kha.input.BlockInterventions",toString:r},None:{_hx_index:2,__enum__:"kha.input.BlockInterventions",toString:r},Custom:(i=function(t){return{_hx_index:3,func:t,__enum__:"kha.input.BlockInterventions",toString:r}},i.__params__=["func"],i)},Ye=function(){this.__id=ci.nextId++,this._inputBuffer=new E(new ArrayBuffer(1))};n["kha.netsync.Controller"]=Ye,Ye.__name__=!0,Ye.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},_receive:function(t){},__class__:Ye};var Xe=t.kha.input.Keyboard=function(){Ye.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Xe.instance=this};n["kha.input.Keyboard"]=Xe,Xe.__name__=!0,Xe.get=function(t){return null==t&&(t=0),dt.getKeyboard(t)},Xe.disableSystemInterventions=function(t){Xe.keyBehavior=t},Xe.__super__=Ye,Xe.prototype=a(Ye.prototype,{notify:function(t,e,i){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=i&&this.pressListeners.push(i)},remove:function(t,e,i){null!=t&&l.remove(this.downListeners,t),null!=e&&l.remove(this.upListeners,e),null!=i&&l.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){for(var e=0,i=this.downListeners;e<i.length;){var n=i[e];++e,n(t)}},sendUpEvent:function(t){for(var e=0,i=this.upListeners;e<i.length;){var n=i[e];++e,n(t)}},sendPressEvent:function(t){for(var e=0,i=this.pressListeners;e<i.length;){var n=i[e];++e,n(t)}},_receive:function(t){},__class__:Xe});var Ke=t.kha.input.Mouse=function(){Ye.call(this),Ke.instance=this};n["kha.input.Mouse"]=Ke,Ke.__name__=!0,Ke.get=function(t){return null==t&&(t=0),dt.getMouse(t)},Ke.__super__=Ye,Ke.prototype=a(Ye.prototype,{notify:function(t,e,i,n,r){this.notifyWindowed(0,t,e,i,n,r)},remove:function(t,e,i,n,r){this.removeWindowed(0,t,e,i,n,r)},notifyWindowed:function(t,e,i,n,r,s){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}if(null!=r){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(r)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(s)}},removeWindowed:function(t,e,i,n,r,s){null!=e&&(null!=this.windowDownListeners?t<this.windowDownListeners.length?l.remove(this.windowDownListeners[t],e):v.trace('no downListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):v.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?t<this.windowUpListeners.length?l.remove(this.windowUpListeners[t],i):v.trace('no upListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):v.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowMoveListeners?t<this.windowMoveListeners.length?l.remove(this.windowMoveListeners[t],n):v.trace('no moveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):v.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowWheelListeners?t<this.windowWheelListeners.length?l.remove(this.windowWheelListeners[t],r):v.trace('no wheelListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):v.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowLeaveListeners?t<this.windowLeaveListeners.length?l.remove(this.windowLeaveListeners[t],s):v.trace('no leaveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):v.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(t,e){},removeFromLockChange:function(t,e){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=this.windowLeaveListeners)for(var e=0,i=this.windowLeaveListeners[t];e<i.length;){var n=i[e];++e,n()}},sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var r=0,s=this.windowDownListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var r=0,s=this.windowUpListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendMoveEvent:function(t,e,i,n,r){if(null!=this.windowMoveListeners)for(var s=0,a=this.windowMoveListeners[t];s<a.length;){var o=a[s];++s,o(e,i,n,r)}},sendWheelEvent:function(t,e){if(null!=this.windowWheelListeners)for(var i=0,n=this.windowWheelListeners[t];i<n.length;){var r=n[i];++i,r(e)}},_receive:function(t){},__class__:Ke});var Ze=function(){Ke.call(this)};n["kha.input.MouseImpl"]=Ze,Ze.__name__=!0,Ze.__super__=Ke,Ze.prototype=a(Ke.prototype,{lock:function(){dt.lockMouse()},unlock:function(){dt.unlockMouse()},canLock:function(){return dt.canLockMouse()},isLocked:function(){return dt.isMouseLocked()},notifyOnLockChange:function(t,e){dt.notifyOfMouseLockChange(t,e)},removeFromLockChange:function(t,e){dt.removeFromMouseLockChange(t,e)},hideSystemCursor:function(){dt.hideSystemCursor()},showSystemCursor:function(){dt.showSystemCursor()},_receive:function(t){},__class__:Ze});var je=function(){je.instance=this};n["kha.input.Pen"]=je,je.__name__=!0,je.get=function(t){return null==t&&(t=0),dt.getPen(t)},je.prototype={notify:function(t,e,i){this.notifyWindowed(0,t,e,i)},remove:function(t,e,i){this.removeWindowed(0,t,e,i)},notifyWindowed:function(t,e,i,n){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=n){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(n)}},removeWindowed:function(t,e,i,n){null!=e&&null!=this.windowDownListeners&&t<this.windowDownListeners.length&&l.remove(this.windowDownListeners[t],e),null!=i&&null!=this.windowUpListeners&&t<this.windowUpListeners.length&&l.remove(this.windowUpListeners[t],i),null!=n&&null!=this.windowMoveListeners&&t<this.windowMoveListeners.length&&l.remove(this.windowMoveListeners[t],n)},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(t,e,i,n){if(null!=this.windowDownListeners)for(var r=0,s=this.windowDownListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendUpEvent:function(t,e,i,n){if(null!=this.windowUpListeners)for(var r=0,s=this.windowUpListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},sendMoveEvent:function(t,e,i,n){if(null!=this.windowMoveListeners)for(var r=0,s=this.windowMoveListeners[t];r<s.length;){var a=s[r];++r,a(e,i,n)}},__class__:je};var Qe=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],Qe.instance=this};n["kha.input.Surface"]=Qe,Qe.__name__=!0,Qe.get=function(t){return null==t&&(t=0),0!=t?null:Qe.instance},Qe.prototype={notify:function(t,e,i){null!=t&&this.touchStartListeners.push(t),null!=e&&this.touchEndListeners.push(e),null!=i&&this.moveListeners.push(i)},remove:function(t,e,i){null!=t&&l.remove(this.touchStartListeners,t),null!=e&&l.remove(this.touchEndListeners,e),null!=i&&l.remove(this.moveListeners,i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,i){for(var n=0,r=this.touchStartListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendTouchEndEvent:function(t,e,i){for(var n=0,r=this.touchEndListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},sendMoveEvent:function(t,e,i){for(var n=0,r=this.moveListeners;n<r.length;){var s=r[n];++n,s(t,e,i)}},__class__:Qe};var Je=function(t){this.bytes=t};n["kha.internal.BytesBlob"]=Je,Je.__name__=!0,Je.__interfaces__=[q],Je.fromBytes=function(t){return new Je(t)},Je.alloc=function(t){return new Je(new E(new ArrayBuffer(t)))},Je.readF32=function(t){var e=0==(-2147483648&t)?1:-1,i=t>>23&255,n=8388607&t;switch(i){case 0:return 0;case 255:return 0!=n?NaN:e>0?1/0:-1/0;default:return e*((n+8388608)/8388608)*Math.pow(2,i-127)}},Je.bit=function(t,e){if(1==(t>>>e&1)){return 0,!0}return 0,!1},Je.toText=function(t,e){for(var i="",n=0,r=e;n<r;){var s=n++;i+=String.fromCodePoint(t[s])}return i},Je.prototype={bytes:null,sub:function(t,e){return new Je(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.b[t]=e},readU8:function(t){var e=this.bytes.b[t];return++t,e},readS8:function(t){var e=this.bytes.b[t];return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*e+i},readU16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];return t+=2,256*i+e},readU32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3];return t+=4,e+256*i+256*n*256+256*r*256*256},readU32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3];return t+=4,r+256*n+256*i*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1];t+=2;var n=0==(128&e)?1:-1;return e&=127,-1==n?256*e-32767+i:256*e+i},readS16LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=0==(128&i)?1:-1;return i&=127,t+=2,-1==n?256*i-32767+e:256*i+e},readS32LE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3],s=0==(128&r)?1:-1;return r&=127,t+=4,-1==s?-2147483647+e+256*i+256*n*256+256*r*256*256:e+256*i+256*n*256+256*r*256*256},readS32BE:function(t){var e=this.bytes.b[t],i=this.bytes.b[t+1],n=this.bytes.b[t+2],r=this.bytes.b[t+3],s=0==(128&e)?1:-1;return e&=127,t+=4,-1==s?-2147483647+r+256*n+256*i*256+256*e*256*256:r+256*n+256*i*256+256*e*256*256},readF32LE:function(t){return Je.readF32(this.readS32LE(t))},readF32BE:function(t){return Je.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8String:function(){return this.bytes.toString()},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:Je};var qe=function(t){this.renderTarget=t};n["kha.krom.Graphics"]=qe,qe.__name__=!0,qe.__interfaces__=[ke],qe.prototype={renderTarget:null,begin:function(t){Krom.begin(this.renderTarget,t)},beginFace:function(t){Krom.beginFace(this.renderTarget,t)},beginEye:function(t){},end:function(){Krom.end()},flush:function(){},vsynced:function(){return!0},refreshRate:function(){return 60},clear:function(t,e,i){var n=0;null!=t&&(n|=1),null!=e&&(n|=2),null!=i&&(n|=4),Krom.clear(n,null==t?0:t,e,i)},viewport:function(t,e,i,n){Krom.viewport(t,e,i,n)},setVertexBuffer:function(t){t.set(0)},setVertexBuffers:function(t){Krom.setVertexBuffers(t)},setIndexBuffer:function(t){t.set()},setCubeMap:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setCubeMapDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTexture:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setTextureDepth:function(t,e){null!=e&&Krom.setTextureDepth(t,e.renderTarget_)},setTextureArray:function(t,e){},setVideoTexture:function(t,e){},setImageTexture:function(t,e){null!=e&&Krom.setImageTexture(t,e.texture_)},setTextureParameters:function(t,e,i,n,r,s){Krom.setTextureParameters(t,e,i,n,r,s)},setTexture3DParameters:function(t,e,i,n,r,s,a){Krom.setTexture3DParameters(t,e,i,n,r,s,a)},setTextureCompareMode:function(t,e){Krom.setTextureCompareMode(t,e)},setCubeMapCompareMode:function(t,e){Krom.setCubeMapCompareMode(t,e)},setPipeline:function(t){t.set()},setStencilReferenceValue:function(t){},setBool:function(t,e){Krom.setBool(t,e)},setInt:function(t,e){Krom.setInt(t,e)},setFloat:function(t,e){Krom.setFloat(t,e)},setFloat2:function(t,e,i){Krom.setFloat2(t,e,i)},setFloat3:function(t,e,i,n){Krom.setFloat3(t,e,i,n)},setFloat4:function(t,e,i,n,r){Krom.setFloat4(t,e,i,n,r)},setFloats:function(t,e){Krom.setFloats(t,e.buffer)},setVector2:function(t,e){Krom.setFloat2(t,e.x,e.y)},setVector3:function(t,e){Krom.setFloat3(t,e.x,e.y,e.z)},setVector4:function(t,e){Krom.setFloat4(t,e.x,e.y,e.z,e.w)},setMatrix:function(t,e){qe.mat[0]=e._00,qe.mat[1]=e._01,qe.mat[2]=e._02,qe.mat[3]=e._03,qe.mat[4]=e._10,qe.mat[5]=e._11,qe.mat[6]=e._12,qe.mat[7]=e._13,qe.mat[8]=e._20,qe.mat[9]=e._21,qe.mat[10]=e._22,qe.mat[11]=e._23,qe.mat[12]=e._30,qe.mat[13]=e._31,qe.mat[14]=e._32,qe.mat[15]=e._33,Krom.setMatrix(t,qe.mat.buffer)},setMatrix3:function(t,e){qe.mat[0]=e._00,qe.mat[1]=e._01,qe.mat[2]=e._02,qe.mat[3]=e._10,qe.mat[4]=e._11,qe.mat[5]=e._12,qe.mat[6]=e._20,qe.mat[7]=e._21,qe.mat[8]=e._22,Krom.setMatrix3(t,qe.mat.buffer)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0),Krom.drawIndexedVertices(t,e)},drawIndexedVerticesInstanced:function(t,e,i){null==i&&(i=-1),null==e&&(e=0),Krom.drawIndexedVerticesInstanced(t,e,i)},instancedRenderingAvailable:function(){return!0},scissor:function(t,e,i,n){Krom.scissor(t,e,i,n)},disableScissor:function(){Krom.disableScissor()},__class__:qe};var $e=function(t){ht.call(this);var e=t.length/4|0,i=new Float32Array(e);this.uncompressedData=i;for(var n=0,r=e;n<r;){var s=n++;this.uncompressedData[s]=t.getFloat(4*s)}this.compressedData=null};n["kha.krom.Sound"]=$e,$e.__name__=!0,$e.__super__=ht,$e.prototype=a(ht.prototype,{uncompress:function(t){t()},unload:function(){ht.prototype.unload.call(this)},__class__:$e});var ti=function(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l};n["kha.math.FastMatrix3"]=ti,ti.__name__=!0,ti.fromMatrix3=function(t){return new ti(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},ti.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:ti};var ei=function(t,e,i,n,r,s,a,o,l,h,u,c,d,_,f,p){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=h,this._22=u,this._32=c,this._03=d,this._13=_,this._23=f,this._33=p};n["kha.math.FastMatrix4"]=ei,ei.__name__=!0,ei.fromMatrix4=function(t){return new ei(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ei.orthogonalProjection=function(t,e,i,n,r,s){return new ei(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},ei.perspectiveProjection=function(t,e,i,n){var r=1/Math.tan(t/2);return new ei(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ei.lookAt=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=Math.sqrt(n*n+r*r+s*s);if(0!=a){var o=1/a;n*=o,r*=o,s*=o}var l=r*i.z-s*i.y,h=s*i.x-n*i.z,u=n*i.y-r*i.x,c=Math.sqrt(l*l+h*h+u*u);if(0!=c){var d=1/c;l*=d,h*=d,u*=d}var _=h*s-u*r,f=u*n-l*s,p=l*r-h*n;return new ei(l,h,u,-(l*t.x+h*t.y+u*t.z),_,f,p,-(_*t.x+f*t.y+p*t.z),-n,-r,-s,n*t.x+r*t.y+s*t.z,0,0,0,1)},ei.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ei};var ii=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};n["kha.math.FastVector2"]=ii,ii.__name__=!0,ii.fromVector2=function(t){return new ii(t.x,t.y)},ii.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},toString:function(){return"FastVector2("+this.x+", "+this.y+")"},__class__:ii};var ni=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i};n["kha.math.FastVector3"]=ni,ni.__name__=!0,ni.fromVector3=function(t){return new ni(t.x,t.y,t.z)},ni.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},toString:function(){return"FastVector3("+this.x+", "+this.y+", "+this.z+")"},__class__:ni};var ri=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n};n["kha.math.FastVector4"]=ri,ri.__name__=!0,ri.fromVector4=function(t){return new ri(t.x,t.y,t.z,t.w)},ri.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},toString:function(){return"FastVector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},__class__:ri};var si=function(t,e,i,n,r,s,a,o,l){this._00=t,this._10=e,this._20=i,this._01=n,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l};n["kha.math.Matrix3"]=si,si.__name__=!0,si.fromFastMatrix3=function(t){return new si(t._00,t._10,t._20,t._01,t._11,t._21,t._02,t._12,t._22)},si.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:si};var ai=function(t,e,i,n,r,s,a,o,l,h,u,c,d,_,f,p){this._00=t,this._10=e,this._20=i,this._30=n,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=h,this._22=u,this._32=c,this._03=d,this._13=_,this._23=f,this._33=p};n["kha.math.Matrix4"]=ai,ai.__name__=!0,ai.fromFastMatrix4=function(t){return new ai(t._00,t._10,t._20,t._30,t._01,t._11,t._21,t._31,t._02,t._12,t._22,t._32,t._03,t._13,t._23,t._33)},ai.orthogonalProjection=function(t,e,i,n,r,s){return new ai(2/(e-t),0,0,-(e+t)/(e-t),0,2/(n-i),0,-(n+i)/(n-i),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},ai.perspectiveProjection=function(t,e,i,n){var r=1/Math.tan(t/2);return new ai(r/e,0,0,0,0,r,0,0,0,0,(n+i)/(i-n),2*n*i/(i-n),0,0,-1,0)},ai.lookAt=function(t,e,i){var n=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=Math.sqrt(n*n+r*r+s*s);if(0!=a){var o=1/a;n*=o,r*=o,s*=o}var l=r*i.z-s*i.y,h=s*i.x-n*i.z,u=n*i.y-r*i.x,c=Math.sqrt(l*l+h*h+u*u);if(0!=c){var d=1/c;l*=d,h*=d,u*=d}var _=h*s-u*r,f=u*n-l*s,p=l*r-h*n;return new ai(l,h,u,-(l*t.x+h*t.y+u*t.z),_,f,p,-(_*t.x+f*t.y+p*t.z),-n,-r,-s,n*t.x+r*t.y+s*t.z,0,0,0,1)},ai.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:ai};var oi=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};n["kha.math.Vector2"]=oi,oi.__name__=!0,oi.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},__class__:oi};var li=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i};n["kha.math.Vector3"]=li,li.__name__=!0,li.prototype={x:null,y:null,z:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,t},__class__:li};var hi=function(t,e,i,n){null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=i,this.w=n};n["kha.math.Vector4"]=hi,hi.__name__=!0,hi.prototype={x:null,y:null,z:null,w:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},set_length:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,this.z*=i,this.w*=i,t},__class__:hi};var ui=function(){};n["kha.netsync.Client"]=ui,ui.__name__=!0,ui.prototype={get_id:null,id:null,send:null,receive:null,onClose:null,__class__:ui};var ci=function(){};n["kha.netsync.ControllerBuilder"]=ci,ci.__name__=!0;var di=function(){};n["kha.netsync.Entity"]=di,di.__name__=!0,di.prototype={_id:null,_size:null,_send:null,_receive:null,__class__:di};var _i=function(t){this.myId=t};n["kha.netsync.LocalClient"]=_i,_i.__name__=!0,_i.__interfaces__=[ui],_i.prototype={myId:null,send:function(t,e){},receive:function(t){},onClose:function(t){},controllers:null,get_controllers:function(){return null},id:null,get_id:function(){return this.myId},__class__:_i};var fi=function(t,e){this.time=t,this.data=e};n["kha.netsync.State"]=fi,fi.__name__=!0,fi.prototype={time:null,data:null,__class__:fi};var pi=function(t,e,i){this.ping=1,this.currentPlayers=0,this.controllers=new b,this.entities=new b,pi.instance=this,this.maxPlayers=t,this.address=e,this.port=i};n["kha.netsync.Session"]=pi,pi.__name__=!0,pi.the=function(){return pi.instance},pi.prototype={entities:null,controllers:null,maxPlayers:null,currentPlayers:null,ping:null,address:null,port:null,startCallback:null,refusedCallback:null,resetCallback:null,localClient:null,network:null,updateTaskId:null,pingTaskId:null,me:null,get_me:function(){return this.localClient},addEntity:function(t){var e=this.entities,i=t._id();e.h[i]=t},addController:function(t){v.trace("Adding controller id "+t._id(),{fileName:"kha/netsync/Session.hx",lineNumber:88,className:"kha.netsync.Session",methodName:"addController"}),t._inputBufferIndex=0;var e=this.controllers,i=t._id();e.h[i]=t},sendControllerUpdate:function(t,e){if(this.controllers.h.hasOwnProperty(t)){if(this.controllers.h[t]._inputBuffer.length<this.controllers.h[t]._inputBufferIndex+4+e.length){var i=new E(new ArrayBuffer(this.controllers.h[t]._inputBufferIndex+4+e.length));i.blit(0,this.controllers.h[t]._inputBuffer,0,this.controllers.h[t]._inputBufferIndex),this.controllers.h[t]._inputBuffer=i}this.controllers.h[t]._inputBuffer.setInt32(this.controllers.h[t]._inputBufferIndex,e.length),this.controllers.h[t]._inputBuffer.blit(this.controllers.h[t]._inputBufferIndex+4,e,0,e.length),this.controllers.h[t]._inputBufferIndex+=4+e.length}},sendPing:function(){var t=new E(new ArrayBuffer(5));t.b[0]=4,t.setFloat(1,at.realTime()),this.sendToServer(t)},sendPlayerUpdate:function(){},receive:function(t,e){switch(t.b[0]){case 0:var i=t.b[1];this.localClient=new _i(i),at.resetTime(),this.startCallback();break;case 1:for(var n=t.getDouble(1),r=9,s=this.entities.iterator();s.hasNext();){var a=s.next();a._receive(r,t),r+=a._size()}at.warp(n);break;case 3:switch(t.b[1]){case 0:break;case 1:this.executeRPC(t)}break;case 4:var o=t.getFloat(1);this.ping=at.realTime()-o;break;case 5:this.refusedCallback();break;case 6:this.currentPlayers=t.getInt32(1)}},executeRPC:function(t){var e=[],i=t.getInt32(2),r=6,s=t.getUInt16(r);r+=2;for(var a="",o=0,l=s;o<l;){o++;var h=t.b[r];a+=String.fromCodePoint(h),++r}var u=t.getUInt16(r);r+=2;for(var d="",_=0,f=u;_<f;){_++;var p=t.b[r];d+=String.fromCodePoint(p),++r}for(;r<t.length;){var g=t.b[r];switch(++r,g){case 66:var m=1==t.b[r];++r,v.trace("Bool: "+(null==m?"null":""+m),{fileName:"kha/netsync/Session.hx",lineNumber:295,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(m);break;case 70:var w=t.getDouble(r);r+=8,v.trace("Float: "+w,{fileName:"kha/netsync/Session.hx",lineNumber:300,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(w);break;case 73:var b=t.getInt32(r);r+=4,v.trace("Int: "+b,{fileName:"kha/netsync/Session.hx",lineNumber:305,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(b);break;case 83:var S=t.getUInt16(r);r+=2;for(var y="",x=0,T=S;x<T;){x++;var E=t.b[r];y+=String.fromCodePoint(E),++r}v.trace("String: "+y,{fileName:"kha/netsync/Session.hx",lineNumber:315,className:"kha.netsync.Session",methodName:"executeRPC"}),e.push(y);break;default:v.trace("Unknown argument type.",{fileName:"kha/netsync/Session.hx",lineNumber:318,className:"kha.netsync.Session",methodName:"executeRPC"})}}-1==i?c.field(n[a],d+"_remotely").apply(null,e):c.field(gi.objects[i],d+"_remotely").apply(gi.objects[i],e)},waitForStart:function(t,e,i,n,r){var s=this;this.startCallback=t,this.refusedCallback=e,this.resetCallback=r,this.network=new kha.netsync.Network(this.address,this.port,i,function(){n(),s.reset()}),this.network.listen(function(t){s.receive(t)}),this.updateTaskId=at.addFrameTask(Ti(this,this.update),0),this.ping=1,this.pingTaskId=at.addTimeTask(Ti(this,this.sendPing),0,1)},reset:function(){at.removeFrameTask(this.updateTaskId),at.removeTimeTask(this.pingTaskId),this.currentPlayers=0,this.ping=1,this.controllers=new b,this.entities=new b,this.resetCallback()},update:function(){for(var t=this.controllers.iterator();t.hasNext();){var e=t.next();if(e._inputBufferIndex>0){var i=new E(new ArrayBuffer(22+e._inputBufferIndex));i.b[0]=2,i.setInt32(1,e._id()),i.setDouble(5,at.time()),i.setInt32(13,ct.windowWidth(0)),i.setInt32(17,ct.windowHeight(0)),i.b[21]=0,i.blit(22,e._inputBuffer,0,e._inputBufferIndex),this.sendToServer(i),e._inputBufferIndex=0}}},sendToServer:function(t){this.network.send(t,!1)},__class__:pi};var gi=function(){};n["kha.netsync.SyncBuilder"]=gi,gi.__name__=!0;var vi=function(t,e,i,n){this._0=t,this._1=e,this._2=i,this._3=n};n["kha.simd.Float32x4"]=vi,vi.__name__=!0,vi.create=function(){return new vi(0,0,0,0)},vi.loadAllFast=function(t){return new vi(t,t,t,t)},vi.load=function(t,e,i,n){return new vi(t,e,i,n)},vi.loadFast=function(t,e,i,n){return new vi(t,e,i,n)},vi.get=function(t,e){var i=0;switch(e){case 0:i=t._0;break;case 1:i=t._1;break;case 2:i=t._2;break;case 3:i=t._3}return i},vi.getFast=function(t,e){switch(e){case 0:return t._0;case 1:return t._1;case 2:return t._2;case 3:return t._3}return 0},vi.abs=function(t){return new vi(Math.abs(t._0),Math.abs(t._1),Math.abs(t._2),Math.abs(t._3))},vi.add=function(t,e){return new vi(t._0+e._0,t._1+e._1,t._2+e._2,t._3+e._3)},vi.div=function(t,e){return new vi(t._0/e._0,t._1/e._1,t._2/e._2,t._3/e._3)},vi.mul=function(t,e){return new vi(t._0*e._0,t._1*e._1,t._2*e._2,t._3*e._3)},vi.neg=function(t){return new vi(-t._0,-t._1,-t._2,-t._3)},vi.reciprocalApproximation=function(t){return new vi(0,0,0,0)},vi.reciprocalSqrtApproximation=function(t){return new vi(0,0,0,0)},vi.sub=function(t,e){return new vi(t._0-e._0,t._1-e._1,t._2-e._2,t._3-e._3)},vi.sqrt=function(t){return new vi(Math.sqrt(t._0),Math.sqrt(t._1),Math.sqrt(t._2),Math.sqrt(t._3))},vi.prototype={_0:null,_1:null,_2:null,_3:null,__class__:vi};var mi=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};n["zui.Handle"]=mi,mi.__name__=!0,mi.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrolling:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragging:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){null==this.children&&(this.children=new b);var i=this.children.h[t];if(null==i){var n=this.children;i=new mi(e),n.h[t]=i}return i},__class__:mi};var wi=function(){};n["zui.Canvas"]=wi,wi.__name__=!0,wi.draw=function(t,e,i){-1==wi.screenW&&(wi.screenW=ct.windowWidth(),wi.screenH=ct.windowHeight()),wi.events=[],wi._ui=t,i.end(),t.begin(i),i.begin(!1),t.g=i;for(var n=0,r=e.elements;n<r.length;){var s=r[n];++n,null==s.parent&&wi.drawElement(t,e,s)}return i.end(),t.end(),i.begin(!1),wi.events},wi.drawElement=function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=0),null!=i&&0!=i.visible){var s=e.width*wi._ui.SCALE|0,a=e.height*wi._ui.SCALE|0;switch(i.anchor){case 1:n-=(s-wi.screenW)/2;break;case 2:n-=s-wi.screenW;break;case 3:r-=(a-wi.screenH)/2;break;case 4:n-=(s-wi.screenW)/2,r-=(a-wi.screenH)/2;break;case 5:n-=s-wi.screenW,r-=(a-wi.screenH)/2;break;case 6:r-=a-wi.screenH;break;case 7:n-=(s-wi.screenW)/2,r-=a-wi.screenH;break;case 8:n-=s-wi.screenW,r-=a-wi.screenH}t._x=e.x+(i.x*wi._ui.SCALE|0)+(n*wi._ui.SCALE|0),t._y=e.y+(i.y*wi._ui.SCALE|0)+(r*wi._ui.SCALE|0),t._w=i.width*wi._ui.SCALE|0;var o=null!=i.rotation&&0!=i.rotation;switch(o&&t.g.pushRotation(i.rotation,t._x+(i.width*wi._ui.SCALE|0)/2,t._y+(i.height*wi._ui.SCALE|0)/2),i.type){case 0:var l=t.ops.font,h=t.fontSize,u=t.t.TEXT_COL;null!=i.asset&&_.endsWith(i.asset,".ttf")&&(t.ops.font=wi.getAsset(e,i.asset)),t.fontSize=i.height*wi._ui.SCALE|0,t.t.TEXT_COL=i.color,t.text(i.text),t.ops.font=l,t.fontSize=h,t.t.TEXT_COL=u;break;case 1:var c=wi.getAsset(e,i.asset),d=null!=i.asset&&_.endsWith(i.asset,".ttf");if(null!=c&&!d){t.imageScrollAlign=!1;var f=null!=i.color?i.color:-1;if(3==t.image(c,f,i.height*wi._ui.SCALE|0)){var p=i.event;null!=p&&""!=p&&wi.events.push(p)}t.imageScrollAlign=!0}break;case 2:var g=t.t.BUTTON_H;if(t.t.BUTTON_H=i.height*wi._ui.SCALE|0,t.button(i.text)){var v=i.event;null!=v&&""!=v&&wi.events.push(v)}t.t.BUTTON_H=g;break;case 3:break;case 6:t.check(wi.h.nest(i.id),i.text);break;case 7:t.inlineRadio(wi.h.nest(i.id),i.text.split(";"));break;case 8:t.combo(wi.h.nest(i.id),i.text.split(";"));break;case 9:var m=t.g.get_color();t.g.set_color(i.color),t.g.fillRect(t._x,t._y,t._w,i.height*wi._ui.SCALE|0),t.g.set_color(m);break;case 10:t.slider(wi.h.nest(i.id),i.text,0,1,!0);break;case 11:t.textInput(wi.h.nest(i.id),i.text)}if(null!=i.children)for(var w=0,b=i.children;w<b.length;){var S=b[w];++w,wi.drawElement(t,e,wi.elemById(e,S),i.x+n,i.y+r)}o&&t.g.popTransformation()}},wi.getText=function(t,e){return e.text},wi.getAsset=function(t,e){for(var i=0,n=t.assets;i<n.length;){var r=n[i];if(++i,r.name==e)return wi.assetMap.h[r.id]}return null},wi.getElementId=function(t){if(-1==wi.elemId)for(var e=0,i=t.elements;e<i.length;){var n=i[e];++e,wi.elemId<n.id&&(wi.elemId=n.id)}return++wi.elemId},wi.getAssetId=function(t){if(-1==wi.assetId)for(var e=0,i=t.assets;e<i.length;){var n=i[e];++e,wi.assetId<n.id&&(wi.assetId=n.id)}return++wi.assetId},wi.elemById=function(t,e){for(var i=0,n=t.elements;i<n.length;){var r=n[i];if(++i,r.id==e)return r}return null},wi.scaled=function(t){return t*wi._ui.SCALE|0};var bi=function(){};n["zui.Ext"]=bi,bi.__name__=!0,bi.floatInput=function(t,e,i,n){null==n&&(n=0),null==i&&(i=""),e.text=null==e.value?"null":""+e.value;var r=t.textInput(e,i,n);return e.value=parseFloat(r),e.value},bi.list=function(t,e,i,n){var r=0;null==n&&(n={});for(var s=null!=n.addCb?n.addCb:function(t){i.push(t)},a=null!=n.removeCb?n.removeCb:function(t){i.splice(t,1)},o=null!=n.getNameCb?n.getNameCb:function(t){return i[t]},l=null!=n.setNameCb?n.setNameCb:function(t,e){i[t]=e},h=null!=n.getLabelCb?n.getLabelCb:function(t){return""},u=n.itemDrawCb,c=null!=n.showRadio&&n.showRadio,d=null==n.editable||n.editable,_=null==n.showAdd||n.showAdd,f=null!=n.addLabel?n.addLabel:"Add",p=0;p<i.length;){c?(t.row([.12,.68,.2]),t.radio(e.nest(0),p,"")&&(r=p)):t.row([.8,.2]);var g=e.nest(p);g.text=o(p),d?l(p,t.textInput(g,h(p))):t.text(o(p)),t.button("X")?a(p):++p,null!=u&&u(g.nest(p),p-1)}return _&&t.button(f)&&s("untitled"),r},bi.panelList=function(t,e,i,n,r,s,a,o,l,h,u){null==u&&(u="Add"),null==h&&(h=!0),null==l&&(l=!0),null==n&&(n=function(t){i.push(t)}),null==r&&(r=function(t){i.splice(t,1)}),null==s&&(s=function(t){return i[t]}),null==a&&(a=function(t,e){i[t]=e});for(var c=0;c<i.length;){t.row([.12,.68,.2]);var d=t.panel(e.nest(c),"",0),_=e.nest(c);l?a(c,t.textInput(_,s(c))):t.text(s(c)),t.button("X")?r(c):++c,null!=o&&d&&o(_.nest(c),c-1)}h&&t.button(u)&&n("untitled")},bi.colorPicker=function(t,e,i){null==i&&(i=!1);var n=t.slider(e.nest(0,{value:.00392156862745098*((16711680&e.color)>>>16)}),"R",0,1,!0),r=t.slider(e.nest(1,{value:.00392156862745098*((65280&e.color)>>>8)}),"G",0,1,!0),s=t.slider(e.nest(2,{value:.00392156862745098*(255&e.color)}),"B",0,1,!0),a=.00392156862745098*(e.color>>>24);i&&(a=t.slider(e.nest(3,{value:a}),"A",0,1,!0));var o=X.fromFloats(n,r,s,a);return t.text("",2,o),o},bi.initPath=function(t,e){t.text="Windows"==e?"C:\\Users":"/"},bi.fileBrowser=function(t,e,i){null==i&&(i=!1);var n="/",r="ls ",s=ct.get_systemId();"Windows"==s&&(r="dir /b ",i&&(r+="/ad "),n="\\",e.text=_.replace(e.text,"\\\\","\\"),e.text=_.replace(e.text,"\r","")),""==e.text&&bi.initPath(e,s);var a=Krom.getFilesLocation()+n+bi.dataPath+"dir.txt";e.text!=bi.lastPath&&Krom.sysCommand(r+'"'+e.text+'" > "'+a+'"'),bi.lastPath=e.text;var o=E.ofData(Krom.loadBlob(a)).toString().split("\n"),l=e.text.indexOf("/"),h=e.text.indexOf("\\");(l>-1&&e.text.length-1>l||h>-1&&e.text.length-1>h)&&t.button("..",0)&&(e.text=e.text.substring(0,e.text.lastIndexOf(n)),2==e.text.length&&":"==e.text.charAt(1)&&(e.text+=n));for(var u=0;u<o.length;){var c=o[u];++u,""!=c&&"."!=c.charAt(0)&&(t.button(c,0)&&(e.text.charAt(e.text.length-1)!=n&&(e.text+=n),e.text+=c))}return e.text},bi.colorWheel=function(t,e,i,n,r){null==r&&(r=!1),null==i&&(i=!1),null==n&&(n=t._w),bi.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),bi.ar);var s=bi.ar[0],a=bi.ar[1],o=bi.ar[2],l=.00392156862745098*(e.color>>>24),h=t._x,u=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(n-=t.t.SCROLL_W*t.SCALE|0,h+=(t.t.SCROLL_W*t.SCALE|0)/2),t.image(t.ops.color_wheel,X.fromFloats(o,o,o));var c=h+n/2,d=u+(t._y-u)/2,_=.7*n,f=_/2,p=c,g=d+a*f,v=s*(2*Math.PI),m=Math.cos(v)*(p-c)-Math.sin(v)*(g-d)+c,w=Math.sin(v)*(p-c)+Math.cos(v)*(g-d)+d;p=m,g=w,t.g.set_color(-16777216),t.g.fillRect(p-3*t.SCALE,g-3*t.SCALE,6*t.SCALE,6*t.SCALE),t.g.set_color(-1),t.g.fillRect(p-2*t.SCALE,g-2*t.SCALE,4*t.SCALE,4*t.SCALE),r&&(i?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var b=e.nest(0);if(b.value=Math.round(100*o)/100,o=t.slider(b,"Value",0,1,!0),b.changed&&(e.changed=t.changed=!0),i){var S=e.nest(1,{value:Math.round(100*l)/100});l=t.slider(S,"Alpha",0,1,!0),S.changed&&(e.changed=t.changed=!0)}var y=c+t._windowX,x=d+t._windowY;if(t.inputStarted&&t.getInputInRect(y-f,x-f,_,_)&&(bi.wheelSelectedHande=e),t.inputReleased&&(bi.wheelSelectedHande=null),t.inputDown&&bi.wheelSelectedHande==e){var T=y-t.inputX,E=x-t.inputY;a=Math.min(Math.sqrt(T*T+E*E),f)/f;var k=Math.atan2(t.inputX-y,t.inputY-x);k<0&&(k=Math.PI+(Math.PI-Math.abs(k))),s=(k=2*Math.PI-k)/(2*Math.PI),e.changed=t.changed=!0}return bi.hsvToRgb(s,a,o,bi.ar),e.color=X.fromFloats(bi.ar[0],bi.ar[1],bi.ar[2],l),t.text("",2,e.color),e.color},bi.dist=function(t,e,i,n){var r=t-i,s=e-n;return Math.sqrt(r*r+s*s)},bi.fract=function(t){return t-(0|t)},bi.mix=function(t,e,i){return t*(1-i)+e*i},bi.clamp=function(t,e,i){return Math.min(Math.max(t,e),i)},bi.step=function(t,e){return e<t?0:1},bi.hsvToRgb=function(t,e,i,n){var r=t+1,s=Math.abs(6*(r-(0|r))-3),a=t+.6666666666666666,o=Math.abs(6*(a-(0|a))-3),l=t+.3333333333333333,h=Math.abs(6*(l-(0|l))-3);n[0]=i*(1-e+Math.min(Math.max(s-1,0),1)*e),n[1]=i*(1-e+Math.min(Math.max(o-1,0),1)*e),n[2]=i*(1-e+Math.min(Math.max(h-1,0),1)*e)},bi.rgbToHsv=function(t,e,i,n){var r=e<i?0:1,s=i*(1-r)+e*r,a=e<i?0:1,o=e*(1-a)+i*a,l=e<i?0:1,h=e<i?0:1,u=t<s?0:1,c=s*(1-u)+t*u,d=t<s?0:1,_=o*(1-d)+o*d,f=t<s?0:1,p=(.6666666666666666*(1-h)+-.3333333333333333*h)*(1-f)+(-1*(1-l)+0*l)*f,g=t<s?0:1,v=t*(1-g)+s*g,m=c-Math.min(v,_);n[0]=Math.abs(p+(v-_)/(6*m+1e-10)),n[1]=m/(c+1e-10),n[2]=c};var Si=function(){};n["zui.Id"]=Si,Si.__name__=!0;var yi=function(){};n["zui.Themes"]=yi,yi.__name__=!0;var xi=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipWait=!1,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImgMaxWidth=null,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this._windowY=0,this._windowX=0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isEscapeDown=!1,this.isDeleteDown=!1,this.isBackspaceDown=!1,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.alwaysRedraw=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.enabled=!0,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=yi.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.scaleTexture&&(t.scaleTexture=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),null==xi.copyReceiver&&(xi.copyReceiver=this,ct.notifyOnCutCopyPaste(Ti(this,this.onCut),Ti(this,this.onCopy),Ti(this,this.onPaste)),ct.notifyOnFrames(function(t){(xi.isCopy||xi.isPaste)&&++xi.copyFrame>1&&(xi.isCopy=xi.isCut=xi.isPaste=!1,xi.copyFrame=0)}));var e=Ae.createTextVertexStructure();this.rtTextPipeline=Ae.createTextPipeline(e),this.rtTextPipeline.alphaBlendSource=1,this.rtTextPipeline.compile()};function Ti(t,i){return null==i?null:(null==i.__id__&&(i.__id__=e.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[i.__id__],null==n&&(n=i.bind(t),t.hx__closures__[i.__id__]=n),n);var n}n["zui.Zui"]=xi,xi.__name__=!0,xi.prototype={isScrolling:null,isTyping:null,enabled:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,imageInvertY:null,scrollEnabled:null,alwaysRedraw:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputInitialX:null,inputInitialY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,isBackspaceDown:null,isDeleteDown:null,isEscapeDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,globalG:null,rtTextPipeline:null,t:null,SCALE:null,ops:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollingHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipImgMaxWidth:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipWait:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=this.t.FONT_SIZE*this.ops.scaleFactor|0;var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.t.ELEMENT_H*this.SCALE-e)/2,this.arrowOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.ARROW_SIZE*this.SCALE)/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.t.ARROW_SIZE*this.SCALE)/this.SCALE,this.buttonOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.BUTTON_H*this.SCALE)/2,this.checkOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=$.createRenderTarget(this.t.CHECK_SELECT_SIZE*this.SCALE|0,this.t.CHECK_SELECT_SIZE*this.SCALE|0,null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),t.end(),this.elementsBaked=!0},remove:function(){this.ops.autoNotifyInput&&this.unregisterInput()},registerInput:function(){Ke.get().notifyWindowed(this.ops.khaWindowId,Ti(this,this.onMouseDown),Ti(this,this.onMouseUp),Ti(this,this.onMouseMove),Ti(this,this.onMouseWheel)),Xe.get().notify(Ti(this,this.onKeyDown),Ti(this,this.onKeyUp),Ti(this,this.onKeyPress)),this.inputRegistered=!0},unregisterInput:function(){Ke.get().removeWindowed(this.ops.khaWindowId,Ti(this,this.onMouseDown),Ti(this,this.onMouseUp),Ti(this,this.onMouseMove),Ti(this,this.onMouseWheel)),Xe.get().remove(Ti(this,this.onKeyDown),Ti(this,this.onKeyUp),Ti(this,this.onKeyPress)),this.endInput(),this.inputX=this.inputY=0,this.inputRegistered=!1},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),""!=this.tooltipText||null!=this.tooltipImg?(this.inputChanged()&&(this.tooltipShown=!1,this.tooltipWait=0==this.inputDX&&0==this.inputDY),this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=at.time()),!this.tooltipWait&&at.time()-this.tooltipTime>1&&(""!=this.tooltipText?this.drawTooltip():this.drawTooltipImage())):this.tooltipShown=!1,t&&this.endInput(),null!=this.tabPressedHandle&&(this.tabPressedHandle=null)},endInput:function(){this.isKeyDown=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,xi.textToPaste=""},beginLayout:function(t,e,i,n){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=t,this._windowX=0,this._windowY=0,this._windowW=n,this._x=e,this._y=i,this._w=n},endLayout:function(t){null==t&&(t=!0),t&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyDown},windowDirty:function(t,e,i,n,r){var s=e+t.dragX,a=i+t.dragY,o=this.getInputInRect(s,a,n,r)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,i,n,r,s){return null==s&&(s=!1),null!=t.texture&&n==t.texture.get_width()&&r==t.texture.get_height()||this.resize(t,n,r,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=i+t.dragY,this._windowW=n,this._windowH=r,this.windowHeader=0,this.windowDirty(t,e,i,n,r)&&(t.redraws=2),!(t.redraws<=0)&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(n=this.t.ELEMENT_W*this.SCALE|0),this._w=t.scrollEnabled?n-(this.t.SCROLL_W*this.SCALE|0):n,this._h=r,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),t.dragEnabled=s,s&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?t.dragging=!0:this.inputReleased&&(t.dragging=!1),t.dragging&&(t.redraws=2,t.dragX+=0|this.inputDX,t.dragY+=0|this.inputDY),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(e.redraws>0||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var i=this._y-e.scrollOffset;if(i<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var n=i-this._windowH,r=-e.scrollOffset/n,s=this._windowH*Math.abs(this._windowH/i);s=Math.max(s,this.t.ELEMENT_H*this.SCALE);var a=this._windowH-s,o=n/a,l=a*r,h=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.SCALE|0),l+this._windowY,this.t.SCROLL_W*this.SCALE|0,s);this.inputStarted&&h&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.scrolling?this.scroll(this.inputDY*o,i):0!=this.inputWheelDelta&&null==this.comboSelectedHandle&&this.getInputInRect(this._windowX,this._windowY,this._windowW,this._windowH)&&this.scroll(this.inputWheelDelta*(this.t.ELEMENT_H*this.SCALE),i),e.scrollOffset>0?e.scrollOffset=0:i+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-i),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-(this.t.SCROLL_W*this.SCALE|0),this._windowY,this.t.SCROLL_W*this.SCALE|0,this._windowH),this.g.set_color(this.t.ACCENT_COL);var u=this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.SCALE|0),this._windowY,this.t.SCROLL_W*this.SCALE|0,this._windowH)||e.scrolling?this.t.SCROLL_W*this.SCALE|0:(this.t.SCROLL_W*this.SCALE|0)/3;this.g.fillRect(this._windowW-u-this.scrollAlign,l,u,s)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,(xi.alwaysRedrawWindow||e.redraws>-4)&&(t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(e.texture,this._windowX,this._windowY,e.texture.get_width()/this.ops.scaleTexture,e.texture.get_height()/this.ops.scaleTexture),t&&this.globalG.end(),e.redraws<=0&&e.redraws--)}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},restoreX:null,restoreY:null,tab:function(t,e){null==this.tabNames&&(this.tabNames=[],this.tabHandle=t,this.windowHeader+=this.buttonOffsetY+this.t.BUTTON_H*this.SCALE,this.restoreX=this.inputX,this.restoreY=this.inputY,this.getInputInRect(this._windowX,this._windowY,this._windowW,this.windowHeader)&&(this.inputX=this.inputY=-1)),this.tabNames.push(e);var i=t.position==this.tabNames.length-1;return i&&this.endElement(),i},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this.t.BUTTON_H*this.SCALE*1.1|0,i=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.tabHandle.changed=!1,this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+e+2),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+e+2,this._windowW-2*this.buttonOffsetY,this.t.LINE_STRENGTH*this.SCALE),this._y+=2;for(var n=0,r=this.tabNames.length;n<r;){var s=n++;this._x=t,this._w=this.ops.font.width(this.fontSize,this.tabNames[s])+2*this.buttonOffsetY+14*this.SCALE|0;var a=this.getReleased(),o=this.getPushed(),l=this.getHover();if(a){var h=this.tabHandle.nest(this.tabHandle.position);h.scrollOffset=this.currentWindow.scrollOffset,h=this.tabHandle.nest(s),this.tabScroll=h.scrollOffset,this.tabHandle.position=s,this.currentWindow.redraws=3,this.tabHandle.changed=!0}var u=this.tabHandle.position==s;this.g.set_color(u?this.t.WINDOW_BG_COL:o||l?this.t.BUTTON_HOVER_COL:this.t.SEPARATOR_COL),t+=this._w+1;var c=this.g,d=this._x+this.buttonOffsetY,_=this._y+this.buttonOffsetY,f=this._w,p=0;0==p&&(p=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),c.fillRect(d,_,f,e),this.g.set_color(u?this.t.BUTTON_TEXT_COL:this.t.LABEL_COL),this.drawString(this.g,this.tabNames[s],this.t.TEXT_OFFSET,0,0),u&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+e,this._w-1,this.t.LINE_STRENGTH*this.SCALE))}this._x=0,this._y=i,this._w=0|(this.currentWindow.scrollEnabled?this._windowW-(this.t.SCROLL_W*this.SCALE|0):this._windowW)}},panel:function(t,e,i,n){return null==n&&(n=!1),null==i&&(i=0),this.isVisible(this.t.ELEMENT_H*this.SCALE)?(this.getReleased()&&(t.selected=!t.selected),i>0&&(this.g.set_color(this.t.PANEL_BG_COL),this.g.fillRect(this._x,this._y,this._w,this.t.ELEMENT_H*this.SCALE)),n?this.drawTree(t.selected):this.drawArrow(t.selected),this.g.set_color(this.t.PANEL_TEXT_COL),this.g.set_opacity(1),this.drawString(this.g,e,this.titleOffsetX,0),this.endElement(),t.selected):(this.endElement(),t.selected)},image:function(t,e,i,n,r,s,a){null==a&&(a=0),null==s&&(s=0),null==r&&(r=0),null==n&&(n=0),null==e&&(e=-1);var o=(s>0?s:t.get_width())*this.SCALE,l=(a>0?a:t.get_height())*this.SCALE,h=Math.min(o,this._w),u=this._x;if(this.imageScrollAlign&&(h=Math.min(o,this._w-2*this.buttonOffsetY),u+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var c=-1==this.curRatio?1:this.ratios[this.curRatio];h-=(this.t.SCROLL_W*this.SCALE|0)*c,u+=(this.t.SCROLL_W*this.SCALE|0)*c/2}var d=null==i?h/o:i/l;if(null==i?i=l*d:h=o*d,!this.isVisible(i))return this.endElement(i),0;var _=this.getStarted(i),f=this.getPushed(i),p=this.getReleased(i);this.getHover(i);this.g.set_color(e),this.enabled||this.fadeColor();var g=i;return s>0?this.imageInvertY?this.g.drawScaledSubImage(t,n,r,s,a,u,this._y+g,h,-g):this.g.drawScaledSubImage(t,n,r,s,a,u,this._y,h,g):this.imageInvertY?this.g.drawScaledImage(t,u,this._y+g,h,-g):this.g.drawScaledImage(t,u,this._y,h,g),this.endElement(i),_?1:p?3:f?2:0},text:function(t,e,i){if(null==i&&(i=0),null==e&&(e=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),0;var n=this.getStarted(),r=this.getPushed(),s=this.getReleased();this.getHover();return 0!=i&&(this.g.set_color(i),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),this.endElement(),n?1:s?3:r?2:0},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed&&(this.tabPressed=!1,this.isKeyDown=!1),this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=Xe.get()&&Xe.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyDown&&(37==this.key?this.cursorX>0&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?this.cursorX>0&&this.highlightAnchor==this.cursorX?(e=l.substr(e,0,this.cursorX-1)+l.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=l.substr(e,0,this.highlightAnchor)+l.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=l.substr(e,0,this.cursorX)+l.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=l.substr(e,0,this.cursorX)+l.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=l.substr(e,0,this.highlightAnchor)+l.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=l.substr(e,0,this.cursorX)+l.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&38!=this.key&&40!=this.key&&null!=this.char&&""!=this.char&&l.cca(this.char,0)>=32&&(e=l.substr(e,0,this.highlightAnchor)+this.char+l.substr(e,this.cursorX,null),this.cursorX=this.cursorX+1>e.length?e.length:this.cursorX+1),this.isShiftDown&&(37==this.key||39==this.key||16==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=xi.textToPaste&&(e=l.substr(e,0,this.highlightAnchor)+xi.textToPaste+l.substr(e,this.cursorX,null),this.cursorX+=xi.textToPaste.length,this.highlightAnchor=this.cursorX,xi.textToPaste=""),this.highlightAnchor==this.cursorX?xi.textToCopy=e:this.highlightAnchor<this.cursorX?xi.textToCopy=e.substring(this.highlightAnchor,this.cursorX):xi.textToCopy=e.substring(this.cursorX,this.highlightAnchor),xi.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=l.substr(e,0,this.highlightAnchor)+l.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=l.substr(e,0,this.cursorX)+l.substr(e,this.highlightAnchor,e.length));var i=this.t.TEXT_OFFSET,n=this.t.ELEMENT_H*this.SCALE,r=n-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var s=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(s=this.highlightAnchor,a=this.cursorX);var o=l.substr(e,s,a-s),h=this.g.get_font().width(this.g.get_fontSize(),o),u=this.g.get_font().width(this.g.get_fontSize(),l.substr(e,0,s)),c=0==t?this._x+u+i:this._x+this._w-h-i;2==t&&(c-=this.g.get_font().width(this.g.get_fontSize(),l.substr(e,a,e.length))),this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(c,this._y+this.cursorY*n+1.5*this.buttonOffsetY,h*this.SCALE,r)}if(at.time()%1<.5){var d=0==t?l.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),_=this.g.get_font().width(this.g.get_fontSize(),d),f=0==t?this._x+_+i:this._x+this._w-_-i;this.g.set_color(this.t.TEXT_COL),this.g.fillRect(f,this._y+this.cursorY*n+1.5*this.buttonOffsetY,this.SCALE,r)}this.textSelectedCurrentText=e},textInput:function(t,e,i){if(null==i&&(i=0),null==e&&(e=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.text;var n=this.getHover();this.g.set_color(n?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this._x+this.buttonOffsetY,o=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,h=this.t.BUTTON_H*this.SCALE,u=0;0==u&&(u=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(a,o,l,h):r.drawRect(a,o,l,h,u);var c=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&c&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(i),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var d=2==i?0:2,_=0==d?7:0;this.drawString(this.g,e,_,0,d)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,i):this.drawString(this.g,this.textSelectedCurrentText,null,0,i),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=Xe.get()&&Xe.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e,i){if(null==i&&(i=""),null==e&&(e=1),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),!1;var n=this.getReleased(),r=this.getPushed(),s=this.getHover();n&&(this.changed=!0),this.g.set_color(r?this.t.BUTTON_PRESSED_COL:s?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL);var a=this.g,o=this.t.FILL_BUTTON_BG,l=this._x+this.buttonOffsetY,h=this._y+this.buttonOffsetY,u=this._w-2*this.buttonOffsetY,c=this.t.BUTTON_H*this.SCALE,d=0;return 0==d&&(d=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),o?a.fillRect(l,h,u,c):a.drawRect(l,h,u,c,d),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),""!=i&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,this.t.TEXT_OFFSET,0,2==e?0:2)),this.endElement(),n},check:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawCheck(t.selected,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,i){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawRadio(t.position==e,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,i,this.titleOffsetX,0),this.endElement(),t.position==e},inlineRadio:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position;this.getReleased()?(++t.position>=e.length&&(t.position=0),t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawInlineRadio(e[t.position],i),this.endElement(),t.position},combo:function(t,e,i,n,r){if(null==r&&(r=0),null==n&&(n=!1),null==i&&(i=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position;if(this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=r,this.comboSelectedTexts=e,this.comboSelectedLabel=i,this.comboSelectedX=this._x+this._windowX|0,this.comboSelectedY=this._y+this._windowY+this.t.ELEMENT_H*this.SCALE|0,this.comboSelectedW=0|this._w),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()){this.g.set_color(this.t.ACCENT_HOVER_COL);var s=this.g,a=this.t.FILL_ACCENT_BG,o=this._x+this.buttonOffsetY,l=this._y+this.buttonOffsetY,h=this._w-2*this.buttonOffsetY,u=this.t.BUTTON_H*this.SCALE,c=0;0==c&&(c=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),a?s.fillRect(o,l,h,u):s.drawRect(o,l,h,u,c)}else{this.g.set_color(this.t.ACCENT_COL);var d=this.g,_=this.t.FILL_ACCENT_BG,f=this._x+this.buttonOffsetY,p=this._y+this.buttonOffsetY,g=this._w-2*this.buttonOffsetY,v=this.t.BUTTON_H*this.SCALE,m=0;0==m&&(m=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),_?d.fillRect(f,p,g,v):d.drawRect(f,p,g,v,m)}var w=this._x+this._w-this.arrowOffsetX-8,b=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(w,b,w+this.t.ARROW_SIZE*this.SCALE,b,w+this.t.ARROW_SIZE*this.SCALE/2,b+this.t.ARROW_SIZE*this.SCALE/2),n&&""!=i&&(0==r&&(this._x-=15),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,i,null,0,0==r?2:0),0==r&&(this._x+=15)),2==r&&(this._x-=15),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e[t.position],null,0,r),2==r&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,i,n,r,s,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==s&&(s=100),null==r&&(r=!1),null==n&&(n=1),null==i&&(i=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.value;if(this.getStarted()&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.changed=!1,t.scrolling){var h=n-i,u=this._x+this._windowX+this.buttonOffsetY,c=h/(this._w-2*this.buttonOffsetY),d=i+(this.inputX-u)*c;t.value=Math.round(d*s)/s,t.value<i?t.value=i:t.value>n&&(t.value=n),t.changed=this.changed=!0}var _=this.getHover();this.drawSlider(t.value,i,n,r,_),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t));var f=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(f),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=parseFloat(t.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,f):this.drawString(this.g,this.textSelectedCurrentText,null,0,f)),this.endElement(),t.value},separator:function(t,e){null==e&&(e=!0),null==t&&(t=4),this.isVisible(this.t.ELEMENT_H*this.SCALE)?(e&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(this._x,this._y,this._w,t*this.SCALE)),this._y+=t*this.SCALE):this._y+=t*this.SCALE},tooltip:function(t){this.tooltipText=t,this.tooltipY=this._y+this._windowY},tooltipImage:function(t,e){this.tooltipImg=t,this.tooltipImgMaxWidth=e,this.tooltipInvertY=this.imageInvertY,this.tooltipY=this._y+this._windowY},drawArrow:function(t){var e=this._x+this.arrowOffsetX,i=this._y+this.arrowOffsetY;this.g.set_color(this.t.ARROW_COL),t?this.g.fillTriangle(e,i,e+this.t.ARROW_SIZE*this.SCALE,i,e+this.t.ARROW_SIZE*this.SCALE/2,i+this.t.ARROW_SIZE*this.SCALE):this.g.fillTriangle(e,i,e,i+this.t.ARROW_SIZE*this.SCALE,e+this.t.ARROW_SIZE*this.SCALE,i+this.t.ARROW_SIZE*this.SCALE/2)},drawTree:function(t){var e=7*this.SCALE,i=this._x+this.arrowOffsetX+1,n=this._y+this.arrowOffsetY+1;this.g.set_color(this.t.ARROW_COL),t?this.g.fillRect(i,n+e/2-1,e,e/8):(this.g.fillRect(i,n+e/2-1,e,e/8),this.g.fillRect(i+e/2-1,n,e/8,e))},drawCheck:function(t,e){var i=this._x+this.checkOffsetX,n=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.SCALE,o=this.t.CHECK_SIZE*this.SCALE,l=0;if(0==l&&(l=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(i,n,a,o):r.drawRect(i,n,a,o,l),t){this.g.set_color(-1),this.enabled||this.fadeColor();var h=this.t.CHECK_SELECT_SIZE*this.SCALE|0;this.g.drawScaledImage(this.checkSelectImage,i+this.checkSelectOffsetX,n+this.checkSelectOffsetY,h,h)}},drawRadio:function(t,e){var i=this._x+this.radioOffsetX,n=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var r=this.g,s=this.t.FILL_ACCENT_BG,a=this.t.CHECK_SIZE*this.SCALE,o=this.t.CHECK_SIZE*this.SCALE,l=0;0==l&&(l=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),s?r.fillRect(i,n,a,o):r.drawRect(i,n,a,o,l),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.enabled||this.fadeColor(),this.g.fillRect(i+this.radioSelectOffsetX,n+this.radioSelectOffsetY,this.t.CHECK_SELECT_SIZE*this.SCALE,this.t.CHECK_SELECT_SIZE*this.SCALE))},drawInlineRadio:function(t,e){e?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)):(this.g.set_color(this.t.ACCENT_COL),this.enabled||this.fadeColor(),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,1)},drawSlider:function(t,e,i,n,r){var s=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=this.g,h=this.t.FILL_ACCENT_BG,u=this.t.BUTTON_H*this.SCALE,c=0;0==c&&(c=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),h?l.fillRect(s,a,o,u):l.drawRect(s,a,o,u,c),this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var d=(t-e)/(i-e),_=8*this.SCALE,f=n?s:s+(o-_)*d,p=n?o*d:_;p=Math.max(Math.min(p,o),0);var g=this.g,v=this.t.BUTTON_H*this.SCALE,m=0;0==m&&(m=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),g.fillRect(f,a,p,v)},drawCombo:function(){var t=this.g;this.globalG.set_color(this.t.SEPARATOR_COL);var e=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE|0,i=(this.comboSelectedTexts.length+1)*e;this.globalG.begin(!1);var n=this.comboSelectedY+i>ct.windowHeight(),r=n?this.comboSelectedY-i-(this.t.ELEMENT_H*this.SCALE|0):this.comboSelectedY;this.globalG.fillRect(this.comboSelectedX,r,this.comboSelectedW,i),this.beginLayout(this.globalG,this.comboSelectedX,r,this.comboSelectedW),n&&(this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2),this._y+=e,this.fill(0,0,this._w,this.SCALE,this.t.ACCENT_SELECT_COL)),this.inputEnabled=!0;for(var s=this.t.BUTTON_COL,a=0,o=this.comboSelectedTexts.length;a<o;){var l=a++,h=n?this.comboSelectedTexts.length-1-l:l;if(this.t.BUTTON_COL=h==this.comboSelectedHandle.position?this.t.PANEL_BG_COL:this.t.SEPARATOR_COL,this.button(this.comboSelectedTexts[h],this.comboSelectedAlign)){this.comboToSubmit=h,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.t.BUTTON_COL=s,n||(this.fill(0,0,this._w,this.SCALE,this.t.ACCENT_SELECT_COL),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,this.comboSelectedLabel,null,0,2)),!this.inputReleased&&!this.isEscapeDown||xi.comboFirst?xi.comboFirst=!1:(this.comboSelectedHandle=null,xi.comboFirst=!0),this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=t},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,i=0;i<t.length;){var n=t[i];++i;var r=this.ops.font.width(this.fontSize,n);r>e&&(e=r)}this.tooltipX=Math.min(this.tooltipX,ct.windowWidth()-e-20),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.t.ELEMENT_H*this.SCALE*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var s=0,a=t.length;s<a;){var o=s++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}this.globalG.end()},drawTooltipImage:function(){var t=this.tooltipImg.get_width();null!=this.tooltipImgMaxWidth&&t>this.tooltipImgMaxWidth&&(t=this.tooltipImgMaxWidth);var e=this.tooltipImg.get_height()*(t/this.tooltipImg.get_width());this.tooltipX=Math.min(this.tooltipX,ct.windowWidth()-t-20),this.tooltipY=Math.min(this.tooltipY,ct.windowHeight()-e-20),this.globalG.set_color(-16777216),this.globalG.begin(!1),this.globalG.fillRect(this.tooltipX,this.tooltipY,t,e),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+e,t,-e):this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY,t,e),this.globalG.end()},drawString:function(t,e,i,n,r){null==r&&(r=0),null==n&&(n=0);var s=this._w/(this.fontSize/2|0)|0;e.length>s&&(e=e.substring(0,s)+".."),null==i&&(i=this.t.TEXT_OFFSET),i*=this.SCALE,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==r?i=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==r&&(i=this._w-this.ops.font.width(this.fontSize,e)-this.t.TEXT_OFFSET),this.enabled||this.fadeColor(),t.set_pipeline(this.rtTextPipeline),t.drawString(e,this._x+i,this._y+this.fontOffsetY+n),t.set_pipeline(null)},endElement:function(t){null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==t&&(t=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE),this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=this.wBeforeSplit*this.ratios[this.curRatio]|0):this._x+=this._w+this.t.ELEMENT_OFFSET*this.SCALE:this._y+=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=this._w*t[this.curRatio]|0},indent:function(){this._x+=this.t.TAB_W*this.SCALE|0,this._w-=this.t.TAB_W*this.SCALE|0},unindent:function(){this._x-=this.t.TAB_W*this.SCALE|0,this._w+=this.t.TAB_W*this.SCALE|0},fadeColor:function(){this.g.set_color(X.fromFloats(.00392156862745098*((16711680&this.g.get_color())>>>16),.00392156862745098*((65280&this.g.get_color())>>>8),.00392156862745098*(255&this.g.get_color()),.25))},fill:function(t,e,i,n,r){this.g.set_color(r),this.enabled||this.fadeColor(),this.g.fillRect(this._x+t*this.SCALE,this._y+e*this.SCALE,i*this.SCALE,n*this.SCALE),this.g.set_color(-1)},rect:function(t,e,i,n,r,s){null==s&&(s=1),this.g.set_color(r),this.enabled||this.fadeColor(),this.g.drawRect(this._x+t*this.SCALE,this._y+e*this.SCALE,i*this.SCALE,n*this.SCALE,s),this.g.set_color(-1)},drawRect:function(t,e,i,n,r,s,a){null==a&&(a=0),0==a&&(a=this.t.LINE_STRENGTH*this.SCALE),this.enabled||this.fadeColor(),e?t.fillRect(i,n,r,s):t.drawRect(i,n,r,s,a)},isVisible:function(t){return null==this.currentWindow||this._y+t>0&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.enabled&&this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.enabled&&this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.enabled&&this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.SCALE),!!(this.enabled&&this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.SCALE),this.isHovered=this.enabled&&this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,i,n,r){return null==r&&(r=1),!!(this.enabled&&this.inputEnabled&&this.inputX>=t*r&&this.inputX<(t+i)*r&&this.inputY>=e*r)&&this.inputY<(e+n)*r},onMouseDown:function(t,e,i){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0;var n=e*this.ops.scaleTexture|0,r=i*this.ops.scaleTexture|0;this.setInputPosition(n,r),this.inputInitialX=n,this.inputInitialY=r},onMouseUp:function(t,e,i){0==t?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),e==this.inputInitialX&&i==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(e*this.ops.scaleTexture|0,i*this.ops.scaleTexture|0),this.deselectText()},onMouseMove:function(t,e,i,n){this.setInputPosition(t*this.ops.scaleTexture|0,e*this.ops.scaleTexture|0)},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyDown=!0,t){case 8:this.isBackspaceDown=!0;break;case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 27:this.isEscapeDown=!0;break;case 32:this.char=" ";break;case 46:this.isDeleteDown=!0}},onKeyUp:function(t){switch(t){case 8:this.isBackspaceDown=!1;break;case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1;break;case 27:this.isEscapeDown=!1;break;case 46:this.isDeleteDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyDown=!0},onCut:function(){return xi.isCut=!0,this.onCopy()},onCopy:function(){return xi.isCopy=!0,xi.textToCopy},onPaste:function(t){xi.isPaste=!0,xi.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.SCALE},ELEMENT_H:function(){return this.t.ELEMENT_H*this.SCALE},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.SCALE},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.SCALE},BUTTON_H:function(){return this.t.BUTTON_H*this.SCALE},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.SCALE},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.SCALE},SCROLL_W:function(){return this.t.SCROLL_W*this.SCALE|0},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},TAB_W:function(){return this.t.TAB_W*this.SCALE|0},LINE_STRENGTH:function(){return this.t.LINE_STRENGTH*this.SCALE},FLASH_SPEED:function(){return.5},TOOLTIP_DELAY:function(){return 1},resize:function(t,e,i,n){null==n&&(n=0),t.redraws=2,null!=t.texture&&t.texture.unload(),e<1&&(e=1),i<1&&(i=1),t.texture=$.createRenderTarget(e,i,0,0,1,n),t.texture.get_g2().set_imageScaleQuality(re.High)},__class__:xi},void 0===e.$haxeUID&&(e.$haxeUID=0),n.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=n.String=String,String.__name__=!0,n.Array=Array,Array.__name__=!0,Date.prototype.__class__=n.Date=Date,Date.__name__="Date";var Ei={},ki={},Ci=Number,Ii=Boolean,Bi={},Li={};x.count=0;var Ai={};Object.defineProperty(M.prototype,"message",{get:function(){return String(this.val)}}),D.__toStr={}.toString,null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=F.sliceImpl),o.windowW=o.defaultWindowW=240,o.coffX=70,o.coffY=50,o.modalW=625,o.modalH=545,o.modalHeaderH=66,o.modalRectW=625,o.modalRectH=545,o.path="/",u.cwd="",w.DEFAULT_RESOLVER=new m,w.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",R.helper=new DataView(new ArrayBuffer(8)),z.images=new O,z.sounds=new W,z.blobs=new U,z.fonts=new H,z.videos=new G,X.Black=-16777216,X.White=-1,X.Red=-65536,X.Blue=-16776961,X.Green=-16711936,X.Magenta=-65281,X.Yellow=-256,X.Cyan=-16711681,X.Purple=-8388480,X.Pink=-16181,X.Orange=-23296,X.Transparent=0,X.invMaxChannelValue=.00392156862745098,K.displays=[],j.Default=new j(!1,!1,!1),at.timeWarpSaveTime=10,at.DIF_COUNT=3,at.maxframetime=.5,at.startTime=0,lt.painter_colored_fragData0="s260:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",lt.painter_colored_vertData0="s463:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",lt.painter_image_fragData0="s502:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7Cgp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CnZhcnlpbmcgdmVjNCBjb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgdGV4Y29sb3IgPSB0ZXh0dXJlMkQodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdGV4Y29sb3I7Cn0KCg",lt.painter_image_vertData0="s547:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",lt.painter_text_fragData0="s398:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKdmFyeWluZyB2ZWMyIHRleENvb3JkOwoKdm9pZCBtYWluKCkKewogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlMkQodGV4LCB0ZXhDb29yZCkueCAqIGZyYWdtZW50Q29sb3Iudyk7Cn0KCg",lt.painter_text_vertData0="s568:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",lt.painter_video_fragData0="s502:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7Cgp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CnZhcnlpbmcgdmVjNCBjb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgdGV4Y29sb3IgPSB0ZXh0dXJlMkQodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdGV4Y29sb3I7Cn0KCg",lt.painter_video_vertData0="s547:I3ZlcnNpb24gMTEwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",ct.renderListeners=[],ct.foregroundListeners=[],ct.resumeListeners=[],ct.pauseListeners=[],ct.backgroundListeners=[],ct.shutdownListeners=[],ct.dropFilesListeners=[],dt.maxGamepads=4,dt.mouseLockListeners=[],ft.windows=[],pt.None=0,pt.FeatureResizable=1,pt.FeatureMinimizable=2,pt.FeatureMaximizable=4,pt.FeatureBorderless=8,pt.FeatureOnTop=16,yt.disableGcInteractions=!1,yt.intBox=new St(0),xt.channelCount=32,xt.lastAllocationCount=0,It.POLY=79764919,Nt.INVALID_BITS=-1,Pt.EOP=-1,Pt.M__PI=3.141592653589793,Pt.DIVTAB_NUMER=32,Pt.DIVTAB_DENOM=64,Pt.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Mt.NO_CODE=255,Mt.delay=0,Ut.PACKET_ID=1,Ut.PACKET_COMMENT=3,Ut.PACKET_SETUP=5,Kt.CONTINUED_PACKET=1,Kt.FIRST_PAGE=2,Kt.LAST_PAGE=4,qt.MAX_CHANNELS=16,qt.PUSHDATA_CRC_COUNT=4,qt.FAST_HUFFMAN_LENGTH=10,qt.FAST_HUFFMAN_TABLE_SIZE=1024,qt.FAST_HUFFMAN_TABLE_MASK=1023,ie.fontGlyphs=function(t){for(var e=[],i=32;i<256;){var n=i++;e.push(n)}return e}(),Se.STBTT_vmove=1,Se.STBTT_vline=2,Se.STBTT_vcurve=3,Se.STBTT_MACSTYLE_DONTCARE=0,Se.STBTT_MACSTYLE_BOLD=1,Se.STBTT_MACSTYLE_ITALIC=2,Se.STBTT_MACSTYLE_UNDERSCORE=4,Se.STBTT_MACSTYLE_NONE=8,Se.STBTT_PLATFORM_ID_UNICODE=0,Se.STBTT_PLATFORM_ID_MAC=1,Se.STBTT_PLATFORM_ID_ISO=2,Se.STBTT_PLATFORM_ID_MICROSOFT=3,Se.STBTT_UNICODE_EID_UNICODE_1_0=0,Se.STBTT_UNICODE_EID_UNICODE_1_1=1,Se.STBTT_UNICODE_EID_ISO_10646=2,Se.STBTT_UNICODE_EID_UNICODE_2_0_BMP=3,Se.STBTT_UNICODE_EID_UNICODE_2_0_FULL=4,Se.STBTT_MS_EID_SYMBOL=0,Se.STBTT_MS_EID_UNICODE_BMP=1,Se.STBTT_MS_EID_SHIFTJIS=2,Se.STBTT_MS_EID_UNICODE_FULL=10,Se.STBTT_MAC_EID_ROMAN=0,Se.STBTT_MAC_EID_ARABIC=4,Se.STBTT_MAC_EID_JAPANESE=1,Se.STBTT_MAC_EID_HEBREW=5,Se.STBTT_MAC_EID_CHINESE_TRAD=2,Se.STBTT_MAC_EID_GREEK=6,Se.STBTT_MAC_EID_KOREAN=3,Se.STBTT_MAC_EID_RUSSIAN=7,Se.STBTT_MS_LANG_ENGLISH=1033,Se.STBTT_MS_LANG_ITALIAN=1040,Se.STBTT_MS_LANG_CHINESE=2052,Se.STBTT_MS_LANG_JAPANESE=1041,Se.STBTT_MS_LANG_DUTCH=1043,Se.STBTT_MS_LANG_KOREAN=1042,Se.STBTT_MS_LANG_FRENCH=1036,Se.STBTT_MS_LANG_RUSSIAN=1049,Se.STBTT_MS_LANG_GERMAN=1031,Se.STBTT_MS_LANG_SPANISH=1033,Se.STBTT_MS_LANG_HEBREW=1037,Se.STBTT_MS_LANG_SWEDISH=1053,Se.STBTT_MAC_LANG_ENGLISH=0,Se.STBTT_MAC_LANG_JAPANESE=11,Se.STBTT_MAC_LANG_ARABIC=12,Se.STBTT_MAC_LANG_KOREAN=23,Se.STBTT_MAC_LANG_DUTCH=4,Se.STBTT_MAC_LANG_RUSSIAN=32,Se.STBTT_MAC_LANG_FRENCH=1,Se.STBTT_MAC_LANG_SPANISH=6,Se.STBTT_MAC_LANG_GERMAN=2,Se.STBTT_MAC_LANG_SWEDISH=5,Se.STBTT_MAC_LANG_HEBREW=10,Se.STBTT_MAC_LANG_CHINESE_SIMPLIFIED=33,Se.STBTT_MAC_LANG_ITALIAN=3,Se.STBTT_MAC_LANG_CHINESE_TRAD=19,Se.STBTT_MAX_OVERSAMPLE=8,Se.STBTT_RASTERIZER_VERSION=2,Ie.bufferSize=1500,Ie.vertexSize=9,Be.bufferSize=1e3,Be.triangleBufferSize=1e3,Le.bufferSize=1e3,Ge.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Ge.instances=[],Ge.connectListeners=[],Ge.disconnectListeners=[],Xe.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},Xe.keyBehavior=ze.Default,Ke.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},Je.bufferSize=2e3,qe.mat=new Float32Array(16),ti.width=3,ti.height=3,ei.width=4,ei.height=4,si.width=3,si.height=3,ai.width=4,ai.height=4,ci.nextId=0,pi.START=0,pi.ENTITY_UPDATES=1,pi.CONTROLLER_UPDATES=2,pi.REMOTE_CALL=3,pi.PING=4,pi.SESSION_ERROR=5,pi.PLAYER_UPDATES=6,pi.RPC_SERVER=0,pi.RPC_ALL=1,gi.nextId=0,gi.objects=[],mi.global=new mi,wi.assetMap=new b,wi.events=[],wi.screenW=-1,wi.screenH=-1,wi.locale="en",wi.h=new mi,wi.elemId=-1,wi.assetId=-1,bi.dataPath="",bi.lastPath="",bi.kx=1,bi.ky=.6666666666666666,bi.kz=.3333333333333333,bi.kw=3,bi.ar=[0,0,0],bi.Kx=0,bi.Ky=-.3333333333333333,bi.Kz=.6666666666666666,bi.Kw=-1,bi.e=1e-10,Si.i=0,yi.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:4,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:6,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-13421773,WINDOW_TINT_COL:-1,ACCENT_COL:-12303292,ACCENT_HOVER_COL:-12040120,ACCENT_SELECT_COL:-10461088,PANEL_BG_COL:-13421773,PANEL_TEXT_COL:-1513499,BUTTON_COL:-12040120,BUTTON_TEXT_COL:-1513499,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-1513499,LABEL_COL:-3618616,ARROW_COL:-1513499,SEPARATOR_COL:-14211289,HIGHLIGHT_COL:-14656100},yi.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:12,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887,HIGHLIGHT_COL:-14656100},xi.alwaysRedrawWindow=!0,xi.textToPaste="",xi.textToCopy="",xi.isCut=!1,xi.isCopy=!1,xi.isPaste=!1,xi.copyFrame=0,xi.comboFirst=!0,u.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);